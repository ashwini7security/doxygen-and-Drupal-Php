<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Shopcart: includes/xmlrpc.inc Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Shopcart
   &#160;<span id="projectnumber">version2.0</span>
   </div>
   <div id="projectbrief">Shoppingcart</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_5b89693129504707d608c5412e7b88d4.html">includes</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">xmlrpc.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="xmlrpc_8inc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00025"></a><a class="code" href="xmlrpc_8inc_af88c4a9120094b9280ddc4d90bc51987.html#af88c4a9120094b9280ddc4d90bc51987">00025</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_af88c4a9120094b9280ddc4d90bc51987.html#af88c4a9120094b9280ddc4d90bc51987" title="Turns a data structure into objects with &#39;data&#39; and &#39;type&#39; attributes.">xmlrpc_value</a>($data, $type = FALSE) {
<a name="l00026"></a>00026   $xmlrpc_value = <span class="keyword">new</span> stdClass();
<a name="l00027"></a>00027   $xmlrpc_value-&gt;data = $data;
<a name="l00028"></a>00028   <span class="keywordflow">if</span> (!$type) {
<a name="l00029"></a>00029     $type = <a class="code" href="xmlrpc_8inc_a6322ce2ad550e7f873ab2b9cd6699e26.html#a6322ce2ad550e7f873ab2b9cd6699e26" title="Maps a PHP type to an XML-RPC type.">xmlrpc_value_calculate_type</a>($xmlrpc_value);
<a name="l00030"></a>00030   }
<a name="l00031"></a>00031   $xmlrpc_value-&gt;type = $type;
<a name="l00032"></a>00032   <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;struct&#39;</span>) {
<a name="l00033"></a>00033     <span class="comment">// Turn all the values in the array into new xmlrpc_values</span>
<a name="l00034"></a>00034     <span class="keywordflow">foreach</span> ($xmlrpc_value-&gt;data as $key =&gt; $value) {
<a name="l00035"></a>00035       $xmlrpc_value-&gt;data[$key] = <a class="code" href="xmlrpc_8inc_af88c4a9120094b9280ddc4d90bc51987.html#af88c4a9120094b9280ddc4d90bc51987" title="Turns a data structure into objects with &#39;data&#39; and &#39;type&#39; attributes.">xmlrpc_value</a>($value);
<a name="l00036"></a>00036     }
<a name="l00037"></a>00037   }
<a name="l00038"></a>00038   <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;array&#39;</span>) {
<a name="l00039"></a>00039     <span class="keywordflow">for</span> ($i = 0, $j = count($xmlrpc_value-&gt;data); $i &lt; $j; $i++) {
<a name="l00040"></a>00040       $xmlrpc_value-&gt;data[$i] = <a class="code" href="xmlrpc_8inc_af88c4a9120094b9280ddc4d90bc51987.html#af88c4a9120094b9280ddc4d90bc51987" title="Turns a data structure into objects with &#39;data&#39; and &#39;type&#39; attributes.">xmlrpc_value</a>($xmlrpc_value-&gt;data[$i]);
<a name="l00041"></a>00041     }
<a name="l00042"></a>00042   }
<a name="l00043"></a>00043   <span class="keywordflow">return</span> $xmlrpc_value;
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00057"></a><a class="code" href="xmlrpc_8inc_a6322ce2ad550e7f873ab2b9cd6699e26.html#a6322ce2ad550e7f873ab2b9cd6699e26">00057</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a6322ce2ad550e7f873ab2b9cd6699e26.html#a6322ce2ad550e7f873ab2b9cd6699e26" title="Maps a PHP type to an XML-RPC type.">xmlrpc_value_calculate_type</a>($xmlrpc_value) {
<a name="l00058"></a>00058   <span class="comment">// http://www.php.net/gettype: Never use gettype() to test for a certain type</span>
<a name="l00059"></a>00059   <span class="comment">// [...] Instead, use the is_* functions.</span>
<a name="l00060"></a>00060   <span class="keywordflow">if</span> (is_bool($xmlrpc_value-&gt;data)) {
<a name="l00061"></a>00061     <span class="keywordflow">return</span> <span class="stringliteral">&#39;boolean&#39;</span>;
<a name="l00062"></a>00062   }
<a name="l00063"></a>00063   <span class="keywordflow">if</span> (is_double($xmlrpc_value-&gt;data)) {
<a name="l00064"></a>00064     <span class="keywordflow">return</span> <span class="stringliteral">&#39;double&#39;</span>;
<a name="l00065"></a>00065   }
<a name="l00066"></a>00066   <span class="keywordflow">if</span> (is_int($xmlrpc_value-&gt;data)) {
<a name="l00067"></a>00067     <span class="keywordflow">return</span> <span class="stringliteral">&#39;int&#39;</span>;
<a name="l00068"></a>00068   }
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (is_array($xmlrpc_value-&gt;data)) {
<a name="l00070"></a>00070     <span class="comment">// empty or integer-indexed arrays are &#39;array&#39;, string-indexed arrays &#39;struct&#39;</span>
<a name="l00071"></a>00071     <span class="keywordflow">return</span> empty($xmlrpc_value-&gt;data) || range(0, count($xmlrpc_value-&gt;data) - 1) === array_keys($xmlrpc_value-&gt;data) ? <span class="stringliteral">&#39;array&#39;</span> : <span class="stringliteral">&#39;struct&#39;</span>;
<a name="l00072"></a>00072   }
<a name="l00073"></a>00073   <span class="keywordflow">if</span> (is_object($xmlrpc_value-&gt;data)) {
<a name="l00074"></a>00074     <span class="keywordflow">if</span> (isset($xmlrpc_value-&gt;data-&gt;is_date)) {
<a name="l00075"></a>00075       <span class="keywordflow">return</span> <span class="stringliteral">&#39;date&#39;</span>;
<a name="l00076"></a>00076     }
<a name="l00077"></a>00077     <span class="keywordflow">if</span> (isset($xmlrpc_value-&gt;data-&gt;is_base64)) {
<a name="l00078"></a>00078       <span class="keywordflow">return</span> <span class="stringliteral">&#39;base64&#39;</span>;
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080     $xmlrpc_value-&gt;data = get_object_vars($xmlrpc_value-&gt;data);
<a name="l00081"></a>00081     <span class="keywordflow">return</span> <span class="stringliteral">&#39;struct&#39;</span>;
<a name="l00082"></a>00082   }
<a name="l00083"></a>00083   <span class="comment">// default</span>
<a name="l00084"></a>00084   <span class="keywordflow">return</span> <span class="stringliteral">&#39;string&#39;</span>;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00096"></a><a class="code" href="xmlrpc_8inc_ad06538892136f5c1edb0580b2432e189.html#ad06538892136f5c1edb0580b2432e189">00096</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_ad06538892136f5c1edb0580b2432e189.html#ad06538892136f5c1edb0580b2432e189" title="Generates XML representing the given value.">xmlrpc_value_get_xml</a>($xmlrpc_value) {
<a name="l00097"></a>00097   <span class="keywordflow">switch</span> ($xmlrpc_value-&gt;type) {
<a name="l00098"></a>00098     <span class="keywordflow">case</span> <span class="stringliteral">&#39;boolean&#39;</span>:
<a name="l00099"></a>00099       <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;boolean&gt;&#39;</span> . (($xmlrpc_value-&gt;data) ? <span class="charliteral">&#39;1&#39;</span> : <span class="charliteral">&#39;0&#39;</span>) . <span class="stringliteral">&#39;&lt;/boolean&gt;&#39;</span>;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>:
<a name="l00102"></a>00102       <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;int&gt;&#39;</span> . $xmlrpc_value-&gt;data . <span class="stringliteral">&#39;&lt;/int&gt;&#39;</span>;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <span class="keywordflow">case</span> <span class="stringliteral">&#39;double&#39;</span>:
<a name="l00105"></a>00105       <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;double&gt;&#39;</span> . $xmlrpc_value-&gt;data . <span class="stringliteral">&#39;&lt;/double&gt;&#39;</span>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordflow">case</span> <span class="stringliteral">&#39;string&#39;</span>:
<a name="l00108"></a>00108       <span class="comment">// Note: we don&#39;t escape apostrophes because of the many blogging clients</span>
<a name="l00109"></a>00109       <span class="comment">// that don&#39;t support numerical entities (and XML in general) properly.</span>
<a name="l00110"></a>00110       <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;string&gt;&#39;</span> . htmlspecialchars($xmlrpc_value-&gt;data) . <span class="stringliteral">&#39;&lt;/string&gt;&#39;</span>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="keywordflow">case</span> <span class="stringliteral">&#39;array&#39;</span>:
<a name="l00113"></a>00113       $return = <span class="stringliteral">&#39;&lt;array&gt;&lt;data&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00114"></a>00114       <span class="keywordflow">foreach</span> ($xmlrpc_value-&gt;data as $item) {
<a name="l00115"></a>00115         $return .= <span class="stringliteral">&#39;  &lt;value&gt;&#39;</span> . <a class="code" href="xmlrpc_8inc_ad06538892136f5c1edb0580b2432e189.html#ad06538892136f5c1edb0580b2432e189" title="Generates XML representing the given value.">xmlrpc_value_get_xml</a>($item) . <span class="stringliteral">&quot;&lt;/value&gt;\n&quot;</span>;
<a name="l00116"></a>00116       }
<a name="l00117"></a>00117       $return .= <span class="stringliteral">&#39;&lt;/data&gt;&lt;/array&gt;&#39;</span>;
<a name="l00118"></a>00118       <span class="keywordflow">return</span> $return;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keywordflow">case</span> <span class="stringliteral">&#39;struct&#39;</span>:
<a name="l00121"></a>00121       $return = <span class="stringliteral">&#39;&lt;struct&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00122"></a>00122       <span class="keywordflow">foreach</span> ($xmlrpc_value-&gt;data as $name =&gt; $value) {
<a name="l00123"></a>00123         $return .= <span class="stringliteral">&quot;  &lt;member&gt;&lt;name&gt;&quot;</span> . <a class="code" href="group__sanitization_ga76fc67a30fd8d75ddd80565e6e65a13d.html#ga76fc67a30fd8d75ddd80565e6e65a13d" title="Encodes special characters in a plain-text string for display as HTML.">check_plain</a>($name) . <span class="stringliteral">&quot;&lt;/name&gt;&lt;value&gt;&quot;</span>;
<a name="l00124"></a>00124         $return .= <a class="code" href="xmlrpc_8inc_ad06538892136f5c1edb0580b2432e189.html#ad06538892136f5c1edb0580b2432e189" title="Generates XML representing the given value.">xmlrpc_value_get_xml</a>($value) . <span class="stringliteral">&quot;&lt;/value&gt;&lt;/member&gt;\n&quot;</span>;
<a name="l00125"></a>00125       }
<a name="l00126"></a>00126       $return .= <span class="stringliteral">&#39;&lt;/struct&gt;&#39;</span>;
<a name="l00127"></a>00127       <span class="keywordflow">return</span> $return;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="keywordflow">case</span> <span class="stringliteral">&#39;date&#39;</span>:
<a name="l00130"></a>00130       <span class="keywordflow">return</span> <a class="code" href="xmlrpc_8inc_aad3285fb3322b9452fc7b77acf4e608c.html#aad3285fb3322b9452fc7b77acf4e608c" title="Converts an XML-RPC date-time object into XML.">xmlrpc_date_get_xml</a>($xmlrpc_value-&gt;data);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keywordflow">case</span> <span class="stringliteral">&#39;base64&#39;</span>:
<a name="l00133"></a>00133       <span class="keywordflow">return</span> <a class="code" href="xmlrpc_8inc_ad45673fd18d893a23b7b77d0c67f7b4a.html#ad45673fd18d893a23b7b77d0c67f7b4a" title="Converts an XML-RPC base 64 object into XML.">xmlrpc_base64_get_xml</a>($xmlrpc_value-&gt;data);
<a name="l00134"></a>00134   }
<a name="l00135"></a>00135   <span class="keywordflow">return</span> FALSE;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00149"></a><a class="code" href="xmlrpc_8inc_a623f37020bfae3dec50facefc4cdcdac.html#a623f37020bfae3dec50facefc4cdcdac">00149</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a623f37020bfae3dec50facefc4cdcdac.html#a623f37020bfae3dec50facefc4cdcdac" title="Constructs an object representing an XML-RPC message.">xmlrpc_message</a>($message) {
<a name="l00150"></a>00150   $xmlrpc_message = <span class="keyword">new</span> stdClass();
<a name="l00151"></a>00151   <span class="comment">// The stack used to keep track of the current array/struct</span>
<a name="l00152"></a>00152   $xmlrpc_message-&gt;array_structs = array();
<a name="l00153"></a>00153   <span class="comment">// The stack used to keep track of if things are structs or array</span>
<a name="l00154"></a>00154   $xmlrpc_message-&gt;array_structs_types = array();
<a name="l00155"></a>00155   <span class="comment">// A stack as well</span>
<a name="l00156"></a>00156   $xmlrpc_message-&gt;current_struct_name = array();
<a name="l00157"></a>00157   $xmlrpc_message-&gt;message = $message;
<a name="l00158"></a>00158   <span class="keywordflow">return</span> $xmlrpc_message;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00173"></a><a class="code" href="xmlrpc_8inc_ad105844dad0a30254611d32284350dc4.html#ad105844dad0a30254611d32284350dc4">00173</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_ad105844dad0a30254611d32284350dc4.html#ad105844dad0a30254611d32284350dc4" title="Parses an XML-RPC message.">xmlrpc_message_parse</a>($xmlrpc_message) {
<a name="l00174"></a>00174   $xmlrpc_message-&gt;_parser = xml_parser_create();
<a name="l00175"></a>00175   <span class="comment">// Set XML parser to take the case of tags into account.</span>
<a name="l00176"></a>00176   xml_parser_set_option($xmlrpc_message-&gt;_parser, XML_OPTION_CASE_FOLDING, FALSE);
<a name="l00177"></a>00177   <span class="comment">// Set XML parser callback functions</span>
<a name="l00178"></a>00178   xml_set_element_handler($xmlrpc_message-&gt;_parser, <span class="stringliteral">&#39;xmlrpc_message_tag_open&#39;</span>, <span class="stringliteral">&#39;xmlrpc_message_tag_close&#39;</span>);
<a name="l00179"></a>00179   xml_set_character_data_handler($xmlrpc_message-&gt;_parser, <span class="stringliteral">&#39;xmlrpc_message_cdata&#39;</span>);
<a name="l00180"></a>00180   <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>($xmlrpc_message);
<a name="l00181"></a>00181   <span class="keywordflow">if</span> (!xml_parse($xmlrpc_message-&gt;_parser, $xmlrpc_message-&gt;message)) {
<a name="l00182"></a>00182     <span class="keywordflow">return</span> FALSE;
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184   xml_parser_free($xmlrpc_message-&gt;_parser);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="comment">// Grab the error messages, if any.</span>
<a name="l00187"></a>00187   $xmlrpc_message = <a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502" title="Returns the most recently stored XML-RPC message object.">xmlrpc_message_get</a>();
<a name="l00188"></a>00188   <span class="keywordflow">if</span> (!isset($xmlrpc_message-&gt;messagetype)) {
<a name="l00189"></a>00189     <span class="keywordflow">return</span> FALSE;
<a name="l00190"></a>00190   }
<a name="l00191"></a>00191   elseif ($xmlrpc_message-&gt;messagetype == <span class="stringliteral">&#39;fault&#39;</span>) {
<a name="l00192"></a>00192     $xmlrpc_message-&gt;fault_code = $xmlrpc_message-&gt;params[0][<span class="stringliteral">&#39;faultCode&#39;</span>];
<a name="l00193"></a>00193     $xmlrpc_message-&gt;fault_string = $xmlrpc_message-&gt;params[0][<span class="stringliteral">&#39;faultString&#39;</span>];
<a name="l00194"></a>00194   }
<a name="l00195"></a>00195   <span class="keywordflow">return</span> TRUE;
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00209"></a><a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc">00209</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>($value = NULL) {
<a name="l00210"></a>00210   <span class="keyword">static</span> $xmlrpc_message;
<a name="l00211"></a>00211   <span class="keywordflow">if</span> ($value) {
<a name="l00212"></a>00212     $xmlrpc_message = $value;
<a name="l00213"></a>00213   }
<a name="l00214"></a>00214   <span class="keywordflow">return</span> $xmlrpc_message;
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00225"></a><a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502">00225</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502" title="Returns the most recently stored XML-RPC message object.">xmlrpc_message_get</a>() {
<a name="l00226"></a>00226   <span class="keywordflow">return</span> <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>();
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 
<a name="l00232"></a><a class="code" href="xmlrpc_8inc_af6f1ebfc3ddbd60f36e1058b1cb257de.html#af6f1ebfc3ddbd60f36e1058b1cb257de">00232</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_af6f1ebfc3ddbd60f36e1058b1cb257de.html#af6f1ebfc3ddbd60f36e1058b1cb257de" title="Handles opening tags for XML parsing in xmlrpc_message_parse().">xmlrpc_message_tag_open</a>($parser, $tag, $attr) {
<a name="l00233"></a>00233   $xmlrpc_message = <a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502" title="Returns the most recently stored XML-RPC message object.">xmlrpc_message_get</a>();
<a name="l00234"></a>00234   $xmlrpc_message-&gt;current_tag_contents = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00235"></a>00235   $xmlrpc_message-&gt;last_open = $tag;
<a name="l00236"></a>00236   <span class="keywordflow">switch</span> ($tag) {
<a name="l00237"></a>00237     <span class="keywordflow">case</span> <span class="stringliteral">&#39;methodCall&#39;</span>:
<a name="l00238"></a>00238     <span class="keywordflow">case</span> <span class="stringliteral">&#39;methodResponse&#39;</span>:
<a name="l00239"></a>00239     <span class="keywordflow">case</span> <span class="stringliteral">&#39;fault&#39;</span>:
<a name="l00240"></a>00240       $xmlrpc_message-&gt;messagetype = $tag;
<a name="l00241"></a>00241       <span class="keywordflow">break</span>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="comment">// Deal with stacks of arrays and structs</span>
<a name="l00244"></a>00244     <span class="keywordflow">case</span> <span class="stringliteral">&#39;data&#39;</span>:
<a name="l00245"></a>00245       $xmlrpc_message-&gt;array_structs_types[] = <span class="stringliteral">&#39;array&#39;</span>;
<a name="l00246"></a>00246       $xmlrpc_message-&gt;array_structs[] = array();
<a name="l00247"></a>00247       <span class="keywordflow">break</span>;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="keywordflow">case</span> <span class="stringliteral">&#39;struct&#39;</span>:
<a name="l00250"></a>00250       $xmlrpc_message-&gt;array_structs_types[] = <span class="stringliteral">&#39;struct&#39;</span>;
<a name="l00251"></a>00251       $xmlrpc_message-&gt;array_structs[] = array();
<a name="l00252"></a>00252       <span class="keywordflow">break</span>;
<a name="l00253"></a>00253   }
<a name="l00254"></a>00254   <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>($xmlrpc_message);
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00260"></a><a class="code" href="xmlrpc_8inc_a74f16ef34915c5b73e28a69a02e773c8.html#a74f16ef34915c5b73e28a69a02e773c8">00260</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a74f16ef34915c5b73e28a69a02e773c8.html#a74f16ef34915c5b73e28a69a02e773c8" title="Handles character data for XML parsing in xmlrpc_message_parse().">xmlrpc_message_cdata</a>($parser, $cdata) {
<a name="l00261"></a>00261   $xmlrpc_message = <a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502" title="Returns the most recently stored XML-RPC message object.">xmlrpc_message_get</a>();
<a name="l00262"></a>00262   $xmlrpc_message-&gt;current_tag_contents .= $cdata;
<a name="l00263"></a>00263   <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>($xmlrpc_message);
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00269"></a><a class="code" href="xmlrpc_8inc_aee4cd82346eac26c40587fc89cddb02f.html#aee4cd82346eac26c40587fc89cddb02f">00269</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_aee4cd82346eac26c40587fc89cddb02f.html#aee4cd82346eac26c40587fc89cddb02f" title="Handles closing tags for XML parsing in xmlrpc_message_parse().">xmlrpc_message_tag_close</a>($parser, $tag) {
<a name="l00270"></a>00270   $xmlrpc_message = <a class="code" href="xmlrpc_8inc_a8ee9baa0e35c9f75da4705403ec1c502.html#a8ee9baa0e35c9f75da4705403ec1c502" title="Returns the most recently stored XML-RPC message object.">xmlrpc_message_get</a>();
<a name="l00271"></a>00271   $value_flag = FALSE;
<a name="l00272"></a>00272   <span class="keywordflow">switch</span> ($tag) {
<a name="l00273"></a>00273     <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>:
<a name="l00274"></a>00274     <span class="keywordflow">case</span> <span class="stringliteral">&#39;i4&#39;</span>:
<a name="l00275"></a>00275       $value = (int)trim($xmlrpc_message-&gt;current_tag_contents);
<a name="l00276"></a>00276       $value_flag = TRUE;
<a name="l00277"></a>00277       <span class="keywordflow">break</span>;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     <span class="keywordflow">case</span> <span class="stringliteral">&#39;double&#39;</span>:
<a name="l00280"></a>00280       $value = (double)trim($xmlrpc_message-&gt;current_tag_contents);
<a name="l00281"></a>00281       $value_flag = TRUE;
<a name="l00282"></a>00282       <span class="keywordflow">break</span>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     <span class="keywordflow">case</span> <span class="stringliteral">&#39;string&#39;</span>:
<a name="l00285"></a>00285       $value = $xmlrpc_message-&gt;current_tag_contents;
<a name="l00286"></a>00286       $value_flag = TRUE;
<a name="l00287"></a>00287       <span class="keywordflow">break</span>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <span class="keywordflow">case</span> <span class="stringliteral">&#39;dateTime.iso8601&#39;</span>:
<a name="l00290"></a>00290       $value = <a class="code" href="xmlrpc_8inc_a16688c083542abbf89dfd3fc63907c76.html#a16688c083542abbf89dfd3fc63907c76" title="Converts a PHP or ISO date/time to an XML-RPC object.">xmlrpc_date</a>(trim($xmlrpc_message-&gt;current_tag_contents));
<a name="l00291"></a>00291       <span class="comment">// $value = $iso-&gt;getTimestamp();</span>
<a name="l00292"></a>00292       $value_flag = TRUE;
<a name="l00293"></a>00293       <span class="keywordflow">break</span>;
<a name="l00294"></a>00294 
<a name="l00295"></a>00295     <span class="keywordflow">case</span> <span class="stringliteral">&#39;value&#39;</span>:
<a name="l00296"></a>00296       <span class="comment">// If no type is indicated, the type is string</span>
<a name="l00297"></a>00297       <span class="comment">// We take special care for empty values</span>
<a name="l00298"></a>00298       <span class="keywordflow">if</span> (trim($xmlrpc_message-&gt;current_tag_contents) != <span class="stringliteral">&#39;&#39;</span> || (isset($xmlrpc_message-&gt;last_open) &amp;&amp; ($xmlrpc_message-&gt;last_open == <span class="stringliteral">&#39;value&#39;</span>))) {
<a name="l00299"></a>00299         $value = (string) $xmlrpc_message-&gt;current_tag_contents;
<a name="l00300"></a>00300         $value_flag = TRUE;
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302       unset($xmlrpc_message-&gt;last_open);
<a name="l00303"></a>00303       <span class="keywordflow">break</span>;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="keywordflow">case</span> <span class="stringliteral">&#39;boolean&#39;</span>:
<a name="l00306"></a>00306       $value = (boolean)trim($xmlrpc_message-&gt;current_tag_contents);
<a name="l00307"></a>00307       $value_flag = TRUE;
<a name="l00308"></a>00308       <span class="keywordflow">break</span>;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">case</span> <span class="stringliteral">&#39;base64&#39;</span>:
<a name="l00311"></a>00311       $value = base64_decode(trim($xmlrpc_message-&gt;current_tag_contents));
<a name="l00312"></a>00312       $value_flag = TRUE;
<a name="l00313"></a>00313       <span class="keywordflow">break</span>;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315     <span class="comment">// Deal with stacks of arrays and structs</span>
<a name="l00316"></a>00316     <span class="keywordflow">case</span> <span class="stringliteral">&#39;data&#39;</span>:
<a name="l00317"></a>00317     <span class="keywordflow">case</span> <span class="stringliteral">&#39;struct&#39;</span>:
<a name="l00318"></a>00318       $value = array_pop($xmlrpc_message-&gt;array_structs);
<a name="l00319"></a>00319       array_pop($xmlrpc_message-&gt;array_structs_types);
<a name="l00320"></a>00320       $value_flag = TRUE;
<a name="l00321"></a>00321       <span class="keywordflow">break</span>;
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keywordflow">case</span> <span class="stringliteral">&#39;member&#39;</span>:
<a name="l00324"></a>00324       array_pop($xmlrpc_message-&gt;current_struct_name);
<a name="l00325"></a>00325       <span class="keywordflow">break</span>;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="keywordflow">case</span> <span class="stringliteral">&#39;name&#39;</span>:
<a name="l00328"></a>00328       $xmlrpc_message-&gt;current_struct_name[] = trim($xmlrpc_message-&gt;current_tag_contents);
<a name="l00329"></a>00329       <span class="keywordflow">break</span>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="keywordflow">case</span> <span class="stringliteral">&#39;methodName&#39;</span>:
<a name="l00332"></a>00332       $xmlrpc_message-&gt;methodname = trim($xmlrpc_message-&gt;current_tag_contents);
<a name="l00333"></a>00333       <span class="keywordflow">break</span>;
<a name="l00334"></a>00334   }
<a name="l00335"></a>00335   <span class="keywordflow">if</span> ($value_flag) {
<a name="l00336"></a>00336     <span class="keywordflow">if</span> (count($xmlrpc_message-&gt;array_structs) &gt; 0) {
<a name="l00337"></a>00337       <span class="comment">// Add value to struct or array</span>
<a name="l00338"></a>00338       <span class="keywordflow">if</span> ($xmlrpc_message-&gt;array_structs_types[count($xmlrpc_message-&gt;array_structs_types) - 1] == <span class="stringliteral">&#39;struct&#39;</span>) {
<a name="l00339"></a>00339         <span class="comment">// Add to struct</span>
<a name="l00340"></a>00340         $xmlrpc_message-&gt;array_structs[count($xmlrpc_message-&gt;array_structs) - 1][$xmlrpc_message-&gt;current_struct_name[count($xmlrpc_message-&gt;current_struct_name) - 1]] = $value;
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342       <span class="keywordflow">else</span> {
<a name="l00343"></a>00343         <span class="comment">// Add to array</span>
<a name="l00344"></a>00344         $xmlrpc_message-&gt;array_structs[count($xmlrpc_message-&gt;array_structs) - 1][] = $value;
<a name="l00345"></a>00345       }
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     <span class="keywordflow">else</span> {
<a name="l00348"></a>00348       <span class="comment">// Just add as a parameter</span>
<a name="l00349"></a>00349       $xmlrpc_message-&gt;params[] = $value;
<a name="l00350"></a>00350     }
<a name="l00351"></a>00351   }
<a name="l00352"></a>00352   <span class="keywordflow">if</span> (!in_array($tag, array(<span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;struct&quot;</span>, <span class="stringliteral">&quot;member&quot;</span>))) {
<a name="l00353"></a>00353     $xmlrpc_message-&gt;current_tag_contents = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355   <a class="code" href="xmlrpc_8inc_a82e3428ca6ed8e4d1ddc377fbc77d8dc.html#a82e3428ca6ed8e4d1ddc377fbc77d8dc" title="Stores a copy of the most recent XML-RPC message object temporarily.">xmlrpc_message_set</a>($xmlrpc_message);
<a name="l00356"></a>00356 }
<a name="l00357"></a>00357 
<a name="l00369"></a><a class="code" href="xmlrpc_8inc_a21b3f792f935fd99fc444c82493aaca9.html#a21b3f792f935fd99fc444c82493aaca9">00369</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a21b3f792f935fd99fc444c82493aaca9.html#a21b3f792f935fd99fc444c82493aaca9" title="Constructs an object representing an XML-RPC request.">xmlrpc_request</a>($method, $args) {
<a name="l00370"></a>00370   $xmlrpc_request = <span class="keyword">new</span> stdClass();
<a name="l00371"></a>00371   $xmlrpc_request-&gt;method = $method;
<a name="l00372"></a>00372   $xmlrpc_request-&gt;args = $args;
<a name="l00373"></a>00373   $xmlrpc_request-&gt;xml = &lt;&lt;&lt;EOD
<a name="l00374"></a>00374 &lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span>?&gt;
<a name="l00375"></a>00375 &lt;methodCall&gt;
<a name="l00376"></a>00376 &lt;methodName&gt;{$xmlrpc_request-&gt;method}&lt;/methodName&gt;
<a name="l00377"></a>00377 &lt;params&gt;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 EOD;
<a name="l00380"></a>00380   <span class="keywordflow">foreach</span> ($xmlrpc_request-&gt;args as $arg) {
<a name="l00381"></a>00381     $xmlrpc_request-&gt;xml .= <span class="stringliteral">&#39;&lt;param&gt;&lt;value&gt;&#39;</span>;
<a name="l00382"></a>00382     $v = <a class="code" href="xmlrpc_8inc_af88c4a9120094b9280ddc4d90bc51987.html#af88c4a9120094b9280ddc4d90bc51987" title="Turns a data structure into objects with &#39;data&#39; and &#39;type&#39; attributes.">xmlrpc_value</a>($arg);
<a name="l00383"></a>00383     $xmlrpc_request-&gt;xml .= <a class="code" href="xmlrpc_8inc_ad06538892136f5c1edb0580b2432e189.html#ad06538892136f5c1edb0580b2432e189" title="Generates XML representing the given value.">xmlrpc_value_get_xml</a>($v);
<a name="l00384"></a>00384     $xmlrpc_request-&gt;xml .= <span class="stringliteral">&quot;&lt;/value&gt;&lt;/param&gt;\n&quot;</span>;
<a name="l00385"></a>00385   }
<a name="l00386"></a>00386   $xmlrpc_request-&gt;xml .= <span class="stringliteral">&#39;&lt;/params&gt;&lt;/methodCall&gt;&#39;</span>;
<a name="l00387"></a>00387   <span class="keywordflow">return</span> $xmlrpc_request;
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00404"></a><a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd">00404</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>($code = NULL, $message = NULL, $reset = FALSE) {
<a name="l00405"></a>00405   <span class="keyword">static</span> $xmlrpc_error;
<a name="l00406"></a>00406   <span class="keywordflow">if</span> (isset($code)) {
<a name="l00407"></a>00407     $xmlrpc_error = <span class="keyword">new</span> stdClass();
<a name="l00408"></a>00408     $xmlrpc_error-&gt;is_error = TRUE;
<a name="l00409"></a>00409     $xmlrpc_error-&gt;code = $code;
<a name="l00410"></a>00410     $xmlrpc_error-&gt;message = $message;
<a name="l00411"></a>00411   }
<a name="l00412"></a>00412   elseif ($reset) {
<a name="l00413"></a>00413     $xmlrpc_error = NULL;
<a name="l00414"></a>00414   }
<a name="l00415"></a>00415   <span class="keywordflow">return</span> $xmlrpc_error;
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00427"></a><a class="code" href="xmlrpc_8inc_aaca4578f8a9f0c150c056f61aa62e806.html#aaca4578f8a9f0c150c056f61aa62e806">00427</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_aaca4578f8a9f0c150c056f61aa62e806.html#aaca4578f8a9f0c150c056f61aa62e806" title="Converts an XML-RPC error object into XML.">xmlrpc_error_get_xml</a>($xmlrpc_error) {
<a name="l00428"></a>00428   <span class="keywordflow">return</span> &lt;&lt;&lt;EOD
<a name="l00429"></a>00429 &lt;methodResponse&gt;
<a name="l00430"></a>00430   &lt;fault&gt;
<a name="l00431"></a>00431   &lt;value&gt;
<a name="l00432"></a>00432     &lt;<span class="keyword">struct</span>&gt;
<a name="l00433"></a>00433     &lt;member&gt;
<a name="l00434"></a>00434       &lt;name&gt;faultCode&lt;/name&gt;
<a name="l00435"></a>00435       &lt;value&gt;&lt;<span class="keywordtype">int</span>&gt;{$xmlrpc_error-&gt;code}&lt;/<span class="keywordtype">int</span>&gt;&lt;/value&gt;
<a name="l00436"></a>00436     &lt;/member&gt;
<a name="l00437"></a>00437     &lt;member&gt;
<a name="l00438"></a>00438       &lt;name&gt;faultString&lt;/name&gt;
<a name="l00439"></a>00439       &lt;value&gt;&lt;<span class="keywordtype">string</span>&gt;{$xmlrpc_error-&gt;message}&lt;/<span class="keywordtype">string</span>&gt;&lt;/value&gt;
<a name="l00440"></a>00440     &lt;/member&gt;
<a name="l00441"></a>00441     &lt;/<span class="keyword">struct</span>&gt;
<a name="l00442"></a>00442   &lt;/value&gt;
<a name="l00443"></a>00443   &lt;/fault&gt;
<a name="l00444"></a>00444 &lt;/methodResponse&gt;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 EOD;
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00458"></a><a class="code" href="xmlrpc_8inc_a16688c083542abbf89dfd3fc63907c76.html#a16688c083542abbf89dfd3fc63907c76">00458</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a16688c083542abbf89dfd3fc63907c76.html#a16688c083542abbf89dfd3fc63907c76" title="Converts a PHP or ISO date/time to an XML-RPC object.">xmlrpc_date</a>($time) {
<a name="l00459"></a>00459   $xmlrpc_date = <span class="keyword">new</span> stdClass();
<a name="l00460"></a>00460   $xmlrpc_date-&gt;is_date = TRUE;
<a name="l00461"></a>00461   <span class="comment">// $time can be a PHP timestamp or an ISO one</span>
<a name="l00462"></a>00462   <span class="keywordflow">if</span> (is_numeric($time)) {
<a name="l00463"></a>00463     $xmlrpc_date-&gt;year = gmdate(<span class="charliteral">&#39;Y&#39;</span>, $time);
<a name="l00464"></a>00464     $xmlrpc_date-&gt;month = gmdate(<span class="charliteral">&#39;m&#39;</span>, $time);
<a name="l00465"></a>00465     $xmlrpc_date-&gt;day = gmdate(<span class="charliteral">&#39;d&#39;</span>, $time);
<a name="l00466"></a>00466     $xmlrpc_date-&gt;hour = gmdate(<span class="charliteral">&#39;H&#39;</span>, $time);
<a name="l00467"></a>00467     $xmlrpc_date-&gt;minute = gmdate(<span class="charliteral">&#39;i&#39;</span>, $time);
<a name="l00468"></a>00468     $xmlrpc_date-&gt;second = gmdate(<span class="charliteral">&#39;s&#39;</span>, $time);
<a name="l00469"></a>00469     $xmlrpc_date-&gt;iso8601 = gmdate(<span class="stringliteral">&#39;Ymd\TH:i:s&#39;</span>, $time);
<a name="l00470"></a>00470   }
<a name="l00471"></a>00471   <span class="keywordflow">else</span> {
<a name="l00472"></a>00472     $xmlrpc_date-&gt;iso8601 = $time;
<a name="l00473"></a>00473     $time = str_replace(array(<span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;:&#39;</span>), <span class="stringliteral">&#39;&#39;</span>, $time);
<a name="l00474"></a>00474     $xmlrpc_date-&gt;year = substr($time, 0, 4);
<a name="l00475"></a>00475     $xmlrpc_date-&gt;month = substr($time, 4, 2);
<a name="l00476"></a>00476     $xmlrpc_date-&gt;day = substr($time, 6, 2);
<a name="l00477"></a>00477     $xmlrpc_date-&gt;hour = substr($time, 9, 2);
<a name="l00478"></a>00478     $xmlrpc_date-&gt;minute = substr($time, 11, 2);
<a name="l00479"></a>00479     $xmlrpc_date-&gt;second = substr($time, 13, 2);
<a name="l00480"></a>00480   }
<a name="l00481"></a>00481   <span class="keywordflow">return</span> $xmlrpc_date;
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00493"></a><a class="code" href="xmlrpc_8inc_aad3285fb3322b9452fc7b77acf4e608c.html#aad3285fb3322b9452fc7b77acf4e608c">00493</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_aad3285fb3322b9452fc7b77acf4e608c.html#aad3285fb3322b9452fc7b77acf4e608c" title="Converts an XML-RPC date-time object into XML.">xmlrpc_date_get_xml</a>($xmlrpc_date) {
<a name="l00494"></a>00494   <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;dateTime.iso8601&gt;&#39;</span> . $xmlrpc_date-&gt;year . $xmlrpc_date-&gt;month . $xmlrpc_date-&gt;day . <span class="charliteral">&#39;T&#39;</span> . $xmlrpc_date-&gt;hour . <span class="charliteral">&#39;:&#39;</span> . $xmlrpc_date-&gt;minute . <span class="charliteral">&#39;:&#39;</span> . $xmlrpc_date-&gt;second . <span class="stringliteral">&#39;&lt;/dateTime.iso8601&gt;&#39;</span>;
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00506"></a><a class="code" href="xmlrpc_8inc_a0a49b5ffbb4c8e76bc96c2bc7b8d22dc.html#a0a49b5ffbb4c8e76bc96c2bc7b8d22dc">00506</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a0a49b5ffbb4c8e76bc96c2bc7b8d22dc.html#a0a49b5ffbb4c8e76bc96c2bc7b8d22dc" title="Returns an XML-RPC base 64 object.">xmlrpc_base64</a>($data) {
<a name="l00507"></a>00507   $xmlrpc_base64 = <span class="keyword">new</span> stdClass();
<a name="l00508"></a>00508   $xmlrpc_base64-&gt;is_base64 = TRUE;
<a name="l00509"></a>00509   $xmlrpc_base64-&gt;data = $data;
<a name="l00510"></a>00510   <span class="keywordflow">return</span> $xmlrpc_base64;
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00522"></a><a class="code" href="xmlrpc_8inc_ad45673fd18d893a23b7b77d0c67f7b4a.html#ad45673fd18d893a23b7b77d0c67f7b4a">00522</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_ad45673fd18d893a23b7b77d0c67f7b4a.html#ad45673fd18d893a23b7b77d0c67f7b4a" title="Converts an XML-RPC base 64 object into XML.">xmlrpc_base64_get_xml</a>($xmlrpc_base64) {
<a name="l00523"></a>00523   <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;base64&gt;&#39;</span> . base64_encode($xmlrpc_base64-&gt;data) . <span class="stringliteral">&#39;&lt;/base64&gt;&#39;</span>;
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00546"></a><a class="code" href="xmlrpc_8inc_a75ed600c83fb9a27ae92f949b6812749.html#a75ed600c83fb9a27ae92f949b6812749">00546</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_a75ed600c83fb9a27ae92f949b6812749.html#a75ed600c83fb9a27ae92f949b6812749" title="Performs one or more XML-RPC requests.">_xmlrpc</a>($url, $args, $options = array()) {
<a name="l00547"></a>00547   <a class="code" href="xmlrpc_8inc_afa5cac64bc9057f6ac904b870d9c1311.html#afa5cac64bc9057f6ac904b870d9c1311" title="Clears any previously-saved errors.">xmlrpc_clear_error</a>();
<a name="l00548"></a>00548   <span class="keywordflow">if</span> (count($args) &gt; 1) {
<a name="l00549"></a>00549     $multicall_args = array();
<a name="l00550"></a>00550     <span class="keywordflow">foreach</span> ($args as $method =&gt; $call) {
<a name="l00551"></a>00551       $multicall_args[] = array(<span class="stringliteral">&#39;methodName&#39;</span> =&gt; $method, <span class="stringliteral">&#39;params&#39;</span> =&gt; $call);
<a name="l00552"></a>00552     }
<a name="l00553"></a>00553     $method = <span class="stringliteral">&#39;system.multicall&#39;</span>;
<a name="l00554"></a>00554     $args = array($multicall_args);
<a name="l00555"></a>00555   }
<a name="l00556"></a>00556   <span class="keywordflow">else</span> {
<a name="l00557"></a>00557     $method = key($args);
<a name="l00558"></a>00558     $args = $args[$method];
<a name="l00559"></a>00559   }
<a name="l00560"></a>00560   $xmlrpc_request = <a class="code" href="xmlrpc_8inc_a21b3f792f935fd99fc444c82493aaca9.html#a21b3f792f935fd99fc444c82493aaca9" title="Constructs an object representing an XML-RPC request.">xmlrpc_request</a>($method, $args);
<a name="l00561"></a>00561   <span class="comment">// Required options which will replace any that are passed in.</span>
<a name="l00562"></a>00562   $options[<span class="stringliteral">&#39;method&#39;</span>] = <span class="stringliteral">&#39;POST&#39;</span>;
<a name="l00563"></a>00563   $options[<span class="stringliteral">&#39;headers&#39;</span>][<span class="stringliteral">&#39;Content-Type&#39;</span>] = <span class="stringliteral">&#39;text/xml&#39;</span>;
<a name="l00564"></a>00564   $options[<span class="stringliteral">&#39;data&#39;</span>] = $xmlrpc_request-&gt;xml;
<a name="l00565"></a>00565   $result = <a class="code" href="group__http__handling_gaad3affacd718b960300dcdddefa518aa.html#gaad3affacd718b960300dcdddefa518aa" title="Performs an HTTP request.">drupal_http_request</a>($url, $options);
<a name="l00566"></a>00566   <span class="keywordflow">if</span> ($result-&gt;code != 200) {
<a name="l00567"></a>00567     <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>($result-&gt;code, $result-&gt;error);
<a name="l00568"></a>00568     <span class="keywordflow">return</span> FALSE;
<a name="l00569"></a>00569   }
<a name="l00570"></a>00570   $message = <a class="code" href="xmlrpc_8inc_a623f37020bfae3dec50facefc4cdcdac.html#a623f37020bfae3dec50facefc4cdcdac" title="Constructs an object representing an XML-RPC message.">xmlrpc_message</a>($result-&gt;data);
<a name="l00571"></a>00571   <span class="comment">// Now parse what we&#39;ve got back</span>
<a name="l00572"></a>00572   <span class="keywordflow">if</span> (!<a class="code" href="xmlrpc_8inc_ad105844dad0a30254611d32284350dc4.html#ad105844dad0a30254611d32284350dc4" title="Parses an XML-RPC message.">xmlrpc_message_parse</a>($message)) {
<a name="l00573"></a>00573     <span class="comment">// XML error</span>
<a name="l00574"></a>00574     <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>(-32700, <a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Parse error. Not well formed&#39;</span>));
<a name="l00575"></a>00575     <span class="keywordflow">return</span> FALSE;
<a name="l00576"></a>00576   }
<a name="l00577"></a>00577   <span class="comment">// Is the message a fault?</span>
<a name="l00578"></a>00578   <span class="keywordflow">if</span> ($message-&gt;messagetype == <span class="stringliteral">&#39;fault&#39;</span>) {
<a name="l00579"></a>00579     <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>($message-&gt;fault_code, $message-&gt;fault_string);
<a name="l00580"></a>00580     <span class="keywordflow">return</span> FALSE;
<a name="l00581"></a>00581   }
<a name="l00582"></a>00582   <span class="comment">// We now know that the message is well-formed and a non-fault result.</span>
<a name="l00583"></a>00583   <span class="keywordflow">if</span> ($method == <span class="stringliteral">&#39;system.multicall&#39;</span>) {
<a name="l00584"></a>00584     <span class="comment">// Return per-method results or error objects.</span>
<a name="l00585"></a>00585     $return = array();
<a name="l00586"></a>00586     <span class="keywordflow">foreach</span> ($message-&gt;params[0] as $result) {
<a name="l00587"></a>00587       <span class="keywordflow">if</span> (array_keys($result) == array(0)) {
<a name="l00588"></a>00588         $return[] = $result[0];
<a name="l00589"></a>00589       }
<a name="l00590"></a>00590       <span class="keywordflow">else</span> {
<a name="l00591"></a>00591         $return[] = <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>($result[<span class="stringliteral">&#39;faultCode&#39;</span>], $result[<span class="stringliteral">&#39;faultString&#39;</span>]);
<a name="l00592"></a>00592       }
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594   }
<a name="l00595"></a>00595   <span class="keywordflow">else</span> {
<a name="l00596"></a>00596     $return = $message-&gt;params[0];
<a name="l00597"></a>00597   }
<a name="l00598"></a>00598   <span class="keywordflow">return</span> $return;
<a name="l00599"></a>00599 }
<a name="l00600"></a>00600 
<a name="l00604"></a><a class="code" href="xmlrpc_8inc_af9d29505279c00e66545f3859550ff88.html#af9d29505279c00e66545f3859550ff88">00604</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_af9d29505279c00e66545f3859550ff88.html#af9d29505279c00e66545f3859550ff88" title="Returns the last XML-RPC client error number.">xmlrpc_errno</a>() {
<a name="l00605"></a>00605   $error = <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>();
<a name="l00606"></a>00606   <span class="keywordflow">return</span> ($error != NULL ? $error-&gt;code : NULL);
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00612"></a><a class="code" href="xmlrpc_8inc_abaf990108687e6e764164984306dbd55.html#abaf990108687e6e764164984306dbd55">00612</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_abaf990108687e6e764164984306dbd55.html#abaf990108687e6e764164984306dbd55" title="Returns the last XML-RPC client error message.">xmlrpc_error_msg</a>() {
<a name="l00613"></a>00613   $error = <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>();
<a name="l00614"></a>00614   <span class="keywordflow">return</span> ($error != NULL ? $error-&gt;message : NULL);
<a name="l00615"></a>00615 }
<a name="l00616"></a>00616 
<a name="l00622"></a><a class="code" href="xmlrpc_8inc_afa5cac64bc9057f6ac904b870d9c1311.html#afa5cac64bc9057f6ac904b870d9c1311">00622</a> <span class="keyword">function</span> <a class="code" href="xmlrpc_8inc_afa5cac64bc9057f6ac904b870d9c1311.html#afa5cac64bc9057f6ac904b870d9c1311" title="Clears any previously-saved errors.">xmlrpc_clear_error</a>() {
<a name="l00623"></a>00623   <a class="code" href="xmlrpc_8inc_aabf20dbe18bd511ce0aceedc087a15fd.html#aabf20dbe18bd511ce0aceedc087a15fd" title="Generates, temporarily saves, and returns an XML-RPC error object.">xmlrpc_error</a>(NULL, NULL, TRUE);
<a name="l00624"></a>00624 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 22 2012 16:46:14 for Shopcart by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
