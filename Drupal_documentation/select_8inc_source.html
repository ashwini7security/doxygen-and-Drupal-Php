<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Shopcart: includes/database/select.inc Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Shopcart
   &#160;<span id="projectnumber">version2.0</span>
   </div>
   <div id="projectbrief">Shoppingcart</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_5b89693129504707d608c5412e7b88d4.html">includes</a>      </li>
      <li class="navelem"><a class="el" href="dir_ef0f8d4c5d0deb89b62e2aae86c9d2d2.html">database</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">select.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="select_8inc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00008"></a>00008 require_once dirname(__FILE__) . <span class="stringliteral">&#39;/query.inc&#39;</span>;
<a name="l00009"></a>00009 
<a name="l00020"></a><a class="code" href="interfaceQueryExtendableInterface.html">00020</a> <span class="keyword">interface </span><a class="code" href="interfaceQueryExtendableInterface.html" title="Interface for extendable query objects.">QueryExtendableInterface</a> {
<a name="l00021"></a>00021 
<a name="l00033"></a>00033   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceQueryExtendableInterface_a247fadddaaecd7806d493ba85c388e65.html#a247fadddaaecd7806d493ba85c388e65" title="Enhance this object by wrapping it in an extender object.">extend</a>($extender_name);
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00039"></a><a class="code" href="interfaceSelectQueryInterface.html">00039</a> <span class="keyword">interface </span><a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> <span class="keyword">extends</span> <a class="code" href="interfaceQueryConditionInterface.html" title="Interface for a conditional clause in a query.">QueryConditionInterface</a>, <a class="code" href="interfaceQueryAlterableInterface.html" title="Interface for a query that can be manipulated via an alter hook.">QueryAlterableInterface</a>, <a class="code" href="interfaceQueryExtendableInterface.html" title="Interface for extendable query objects.">QueryExtendableInterface</a>, <a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> {
<a name="l00040"></a>00040 
<a name="l00041"></a>00041   <span class="comment">/* Alter accessors to expose the query data to alter hooks. */</span>
<a name="l00042"></a>00042 
<a name="l00059"></a>00059   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_abcddf4751e4bd1a166752ea7e645135c.html#abcddf4751e4bd1a166752ea7e645135c" title="Returns a reference to the fields array for this query.">getFields</a>();
<a name="l00060"></a>00060 
<a name="l00077"></a>00077   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_a80eae8260f7ae7d3d782573f7030d96d.html#a80eae8260f7ae7d3d782573f7030d96d" title="Returns a reference to the expressions array for this query.">getExpressions</a>();
<a name="l00078"></a>00078 
<a name="l00095"></a>00095   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_a1974a1b815f3aab066792056ed38ea70.html#a1974a1b815f3aab066792056ed38ea70" title="Returns a reference to the order by array for this query.">getOrderBy</a>();
<a name="l00096"></a>00096 
<a name="l00113"></a>00113   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_a3b14e2f648470ff5f2969bc431ab7ae1.html#a3b14e2f648470ff5f2969bc431ab7ae1" title="Returns a reference to the group-by array for this query.">getGroupBy</a>();
<a name="l00114"></a>00114 
<a name="l00131"></a>00131   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_a094adc173e6f2226f09304dab9fbe4a1.html#a094adc173e6f2226f09304dab9fbe4a1" title="Returns a reference to the tables array for this query.">getTables</a>();
<a name="l00132"></a>00132 
<a name="l00150"></a>00150   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="interfaceSelectQueryInterface_a6b3e1fad3a484863d3b77971649d4a56.html#a6b3e1fad3a484863d3b77971649d4a56" title="Returns a reference to the union queries for this query.">getUnion</a>();
<a name="l00151"></a>00151 
<a name="l00162"></a>00162   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_ae033466efee1ce7d14b64f1d6b23e4a2.html#ae033466efee1ce7d14b64f1d6b23e4a2" title="Compiles and returns an associative array of the arguments for this prepared statement.">getArguments</a>(<a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> $queryPlaceholder = NULL);
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">/* Query building operations */</span>
<a name="l00165"></a>00165 
<a name="l00174"></a>00174   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_aae70694b2ee2b596a7b7d3e2c25814ee.html#aae70694b2ee2b596a7b7d3e2c25814ee" title="Sets this query to be DISTINCT.">distinct</a>($distinct = TRUE);
<a name="l00175"></a>00175 
<a name="l00193"></a>00193   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a1c8331825723867ceba20436a6ea5ed1.html#a1c8331825723867ceba20436a6ea5ed1" title="Adds a field to the list to be SELECTed.">addField</a>($table_alias, $field, $alias = NULL);
<a name="l00194"></a>00194 
<a name="l00216"></a>00216   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a7e5fcf83e82fe4f5b97d60bfccf2bb7f.html#a7e5fcf83e82fe4f5b97d60bfccf2bb7f" title="Add multiple fields from the same table to be SELECTed.">fields</a>($table_alias, array $fields = array());
<a name="l00217"></a>00217 
<a name="l00237"></a>00237   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a85b30bde2daad80cb614d7d1f5b8dae3.html#a85b30bde2daad80cb614d7d1f5b8dae3" title="Adds an expression to the list of &quot;fields&quot; to be SELECTed.">addExpression</a>($expression, $alias = NULL, $arguments = array());
<a name="l00238"></a>00238 
<a name="l00262"></a>00262   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a596614bc76873c1487f87d30f892a651.html#a596614bc76873c1487f87d30f892a651" title="Default Join against another table in the database.">join</a>($table, $alias = NULL, $condition = NULL, $arguments = array());
<a name="l00263"></a>00263 
<a name="l00285"></a>00285   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_ab359fd116625504a297d7fd4222f2564.html#ab359fd116625504a297d7fd4222f2564" title="Inner Join against another table in the database.">innerJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array());
<a name="l00286"></a>00286 
<a name="l00308"></a>00308   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_ab3dcfdd428727d5a2f4890296807b27a.html#ab3dcfdd428727d5a2f4890296807b27a" title="Left Outer Join against another table in the database.">leftJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array());
<a name="l00309"></a>00309 
<a name="l00331"></a>00331   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a563903061a31b87f34189a56d6f8a591.html#a563903061a31b87f34189a56d6f8a591" title="Right Outer Join against another table in the database.">rightJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array());
<a name="l00332"></a>00332 
<a name="l00362"></a>00362   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a974ba99af27e9b77d7f5fc69ec81bd45.html#a974ba99af27e9b77d7f5fc69ec81bd45" title="Join against another table in the database.">addJoin</a>($type, $table, $alias = NULL, $condition = NULL, $arguments = array());
<a name="l00363"></a>00363 
<a name="l00384"></a>00384   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a80eca1c7bc37fca0468b6526a3f303e7.html#a80eca1c7bc37fca0468b6526a3f303e7" title="Orders the result set by a given field.">orderBy</a>($field, $direction = <span class="stringliteral">&#39;ASC&#39;</span>);
<a name="l00385"></a>00385 
<a name="l00406"></a>00406   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a647a3152b4cee89205bb9d7274ffd019.html#a647a3152b4cee89205bb9d7274ffd019" title="Orders the result set by a random value.">orderRandom</a>();
<a name="l00407"></a>00407 
<a name="l00422"></a>00422   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a028f87f97fb72e0e43050740fd323181.html#a028f87f97fb72e0e43050740fd323181" title="Restricts a query to a given range in the result set.">range</a>($start = NULL, $length = NULL);
<a name="l00423"></a>00423 
<a name="l00447"></a>00447   <span class="keyword">public</span> <span class="keyword">function</span> <span class="keyword">union</span>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $query, $type = <span class="stringliteral">&#39;&#39;</span>);
<a name="l00448"></a>00448 
<a name="l00457"></a>00457   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a6074bd3c289da304962ae5250d0b20f9.html#a6074bd3c289da304962ae5250d0b20f9" title="Groups the result set by the specified field.">groupBy</a>($field);
<a name="l00458"></a>00458 
<a name="l00465"></a>00465   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a48fd44b77e75771af6d3f289502f050e.html#a48fd44b77e75771af6d3f289502f050e" title="Get the equivalent COUNT query of this query as a new query object.">countQuery</a>();
<a name="l00466"></a>00466 
<a name="l00473"></a>00473   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a04f6707fd382218aef1443a9facbc9f2.html#a04f6707fd382218aef1443a9facbc9f2" title="Indicates if preExecute() has already been called on that object.">isPrepared</a>();
<a name="l00474"></a>00474 
<a name="l00481"></a>00481   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a6e495fdb26a9b6a8752f381552140fa7.html#a6e495fdb26a9b6a8752f381552140fa7" title="Generic preparation and validation for a SELECT query.">preExecute</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $query = NULL);
<a name="l00482"></a>00482 
<a name="l00504"></a>00504   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a5b33d0a9d60cb31a705d590ae1cf8bef.html#a5b33d0a9d60cb31a705d590ae1cf8bef" title="Helper function to build most common HAVING conditional clauses.">havingCondition</a>($field, $value = NULL, $operator = NULL);
<a name="l00505"></a>00505 
<a name="l00513"></a>00513   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a5ed9c2932a32b2649a252e5594e1df83.html#a5ed9c2932a32b2649a252e5594e1df83" title="Clone magic method.">__clone</a>();
<a name="l00514"></a>00514 
<a name="l00529"></a>00529   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceSelectQueryInterface_a723663b3105f06f28c75bd9d16b7a3c7.html#a723663b3105f06f28c75bd9d16b7a3c7" title="Add FOR UPDATE to the query.">forUpdate</a>($set = TRUE);
<a name="l00530"></a>00530 }
<a name="l00531"></a>00531 
<a name="l00535"></a><a class="code" href="classSelectQueryExtender.html">00535</a> <span class="keyword">class </span><a class="code" href="classSelectQueryExtender.html" title="The base extender class for Select queries.">SelectQueryExtender</a> <span class="keyword">implements</span> <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> {
<a name="l00536"></a>00536 
<a name="l00542"></a><a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">00542</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>;
<a name="l00543"></a>00543 
<a name="l00549"></a><a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">00549</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">$connection</a>;
<a name="l00550"></a>00550 
<a name="l00554"></a><a class="code" href="classSelectQueryExtender_a3be2ced1063e8a4f60e85700755fb5b5.html#a3be2ced1063e8a4f60e85700755fb5b5">00554</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQueryExtender_a3be2ced1063e8a4f60e85700755fb5b5.html#a3be2ced1063e8a4f60e85700755fb5b5" title="A unique identifier for this query object.">$uniqueIdentifier</a>;
<a name="l00555"></a>00555 
<a name="l00559"></a><a class="code" href="classSelectQueryExtender_af063c51deb020592cb27a2412649afbe.html#af063c51deb020592cb27a2412649afbe">00559</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQueryExtender_af063c51deb020592cb27a2412649afbe.html#af063c51deb020592cb27a2412649afbe" title="The placeholder counter.">$placeholder</a> = 0;
<a name="l00560"></a>00560 
<a name="l00561"></a><a class="code" href="classSelectQueryExtender_a0720075d5bc494a13e8c8561cb152ea9.html#a0720075d5bc494a13e8c8561cb152ea9">00561</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a0720075d5bc494a13e8c8561cb152ea9.html#a0720075d5bc494a13e8c8561cb152ea9">__construct</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>, <a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> <a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">$connection</a>) {
<a name="l00562"></a>00562     $this-&gt;<a class="code" href="classSelectQueryExtender_a4bb30825327565c94e01b4f5a785a5ed.html#a4bb30825327565c94e01b4f5a785a5ed" title="Implements QueryPlaceholderInterface::uniqueIdentifier().">uniqueIdentifier</a> = uniqid(<span class="stringliteral">&#39;&#39;</span>, TRUE);
<a name="l00563"></a>00563     $this-&gt;query = <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>;
<a name="l00564"></a>00564     $this-&gt;connection = <a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">$connection</a>;
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566 
<a name="l00570"></a><a class="code" href="classSelectQueryExtender_a4bb30825327565c94e01b4f5a785a5ed.html#a4bb30825327565c94e01b4f5a785a5ed">00570</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a4bb30825327565c94e01b4f5a785a5ed.html#a4bb30825327565c94e01b4f5a785a5ed" title="Implements QueryPlaceholderInterface::uniqueIdentifier().">uniqueIdentifier</a>() {
<a name="l00571"></a>00571     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQueryExtender_a4bb30825327565c94e01b4f5a785a5ed.html#a4bb30825327565c94e01b4f5a785a5ed" title="Implements QueryPlaceholderInterface::uniqueIdentifier().">uniqueIdentifier</a>;
<a name="l00572"></a>00572   }
<a name="l00573"></a>00573 
<a name="l00577"></a><a class="code" href="classSelectQueryExtender_a202a005bca32569d69f1cc20acdb8ccb.html#a202a005bca32569d69f1cc20acdb8ccb">00577</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a202a005bca32569d69f1cc20acdb8ccb.html#a202a005bca32569d69f1cc20acdb8ccb" title="Implements QueryPlaceholderInterface::nextPlaceholder().">nextPlaceholder</a>() {
<a name="l00578"></a>00578     <span class="keywordflow">return</span> $this-&gt;placeholder++;
<a name="l00579"></a>00579   }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581   <span class="comment">/* Implementations of QueryAlterableInterface. */</span>
<a name="l00582"></a>00582 
<a name="l00583"></a><a class="code" href="classSelectQueryExtender_a3b2d7ff719982bd817dbe29d98c732db.html#a3b2d7ff719982bd817dbe29d98c732db">00583</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a3b2d7ff719982bd817dbe29d98c732db.html#a3b2d7ff719982bd817dbe29d98c732db" title="Adds a tag to a query.">addTag</a>($tag) {
<a name="l00584"></a>00584     $this-&gt;query-&gt;addTag($tag);
<a name="l00585"></a>00585     <span class="keywordflow">return</span> $this;
<a name="l00586"></a>00586   }
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="classSelectQueryExtender_ab9dd51674086089c405126e6508e232d.html#ab9dd51674086089c405126e6508e232d">00588</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_ab9dd51674086089c405126e6508e232d.html#ab9dd51674086089c405126e6508e232d" title="Determines if a given query has a given tag.">hasTag</a>($tag) {
<a name="l00589"></a>00589     <span class="keywordflow">return</span> $this-&gt;query-&gt;hasTag($tag);
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="classSelectQueryExtender_a8dd095d197f27e0670fc2cc423ac99d6.html#a8dd095d197f27e0670fc2cc423ac99d6">00592</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a8dd095d197f27e0670fc2cc423ac99d6.html#a8dd095d197f27e0670fc2cc423ac99d6" title="Determines if a given query has all specified tags.">hasAllTags</a>() {
<a name="l00593"></a>00593     $args = func_get_args();
<a name="l00594"></a>00594     <span class="keywordflow">return</span> call_user_func_array(array($this-&gt;query, <span class="stringliteral">&#39;hasAllTags&#39;</span>), $args);
<a name="l00595"></a>00595   }
<a name="l00596"></a>00596 
<a name="l00597"></a><a class="code" href="classSelectQueryExtender_a6b6aec8ae5f5c3a98637db9d6e156008.html#a6b6aec8ae5f5c3a98637db9d6e156008">00597</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a6b6aec8ae5f5c3a98637db9d6e156008.html#a6b6aec8ae5f5c3a98637db9d6e156008" title="Determines if a given query has any specified tag.">hasAnyTag</a>() {
<a name="l00598"></a>00598     $args = func_get_args();
<a name="l00599"></a>00599     <span class="keywordflow">return</span> call_user_func_array(array($this-&gt;query, <span class="stringliteral">&#39;hasAnyTags&#39;</span>), $args);
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601 
<a name="l00602"></a><a class="code" href="classSelectQueryExtender_a4ca41f7412e9f35bfd61c0c0e387c7f9.html#a4ca41f7412e9f35bfd61c0c0e387c7f9">00602</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a4ca41f7412e9f35bfd61c0c0e387c7f9.html#a4ca41f7412e9f35bfd61c0c0e387c7f9" title="Adds additional metadata to the query.">addMetaData</a>($key, $object) {
<a name="l00603"></a>00603     $this-&gt;query-&gt;addMetaData($key, $object);
<a name="l00604"></a>00604     <span class="keywordflow">return</span> $this;
<a name="l00605"></a>00605   }
<a name="l00606"></a>00606 
<a name="l00607"></a><a class="code" href="classSelectQueryExtender_a55a9736afef5f69e0e247d16d894b908.html#a55a9736afef5f69e0e247d16d894b908">00607</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a55a9736afef5f69e0e247d16d894b908.html#a55a9736afef5f69e0e247d16d894b908" title="Retrieves a given piece of metadata.">getMetaData</a>($key) {
<a name="l00608"></a>00608     <span class="keywordflow">return</span> $this-&gt;query-&gt;getMetaData($key);
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   <span class="comment">/* Implementations of QueryConditionInterface for the WHERE clause. */</span>
<a name="l00612"></a>00612 
<a name="l00613"></a><a class="code" href="classSelectQueryExtender_a65446d6584a53f1c2be79dd1fd3bffdd.html#a65446d6584a53f1c2be79dd1fd3bffdd">00613</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a65446d6584a53f1c2be79dd1fd3bffdd.html#a65446d6584a53f1c2be79dd1fd3bffdd" title="Helper function: builds the most common conditional clauses.">condition</a>($field, $value = NULL, $operator = NULL) {
<a name="l00614"></a>00614     $this-&gt;query-&gt;condition($field, $value, $operator);
<a name="l00615"></a>00615     <span class="keywordflow">return</span> $this;
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617 
<a name="l00618"></a><a class="code" href="classSelectQueryExtender_a3d3779c339d6bb794e9c98dc361c07e4.html#a3d3779c339d6bb794e9c98dc361c07e4">00618</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_a3d3779c339d6bb794e9c98dc361c07e4.html#a3d3779c339d6bb794e9c98dc361c07e4" title="Gets a complete list of all conditions in this conditional clause.">conditions</a>() {
<a name="l00619"></a>00619     <span class="keywordflow">return</span> $this-&gt;query-&gt;conditions();
<a name="l00620"></a>00620   }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="classSelectQueryExtender_a7095c455524c42ec48e49719ecc53d0c.html#a7095c455524c42ec48e49719ecc53d0c">00622</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a7095c455524c42ec48e49719ecc53d0c.html#a7095c455524c42ec48e49719ecc53d0c" title="Gets a complete list of all values to insert into the prepared statement.">arguments</a>() {
<a name="l00623"></a>00623     <span class="keywordflow">return</span> $this-&gt;query-&gt;arguments();
<a name="l00624"></a>00624   }
<a name="l00625"></a>00625 
<a name="l00626"></a><a class="code" href="classSelectQueryExtender_a7ac93a5b39a4b816e95b9c2d588ba45a.html#a7ac93a5b39a4b816e95b9c2d588ba45a">00626</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a7ac93a5b39a4b816e95b9c2d588ba45a.html#a7ac93a5b39a4b816e95b9c2d588ba45a" title="Adds an arbitrary WHERE clause to the query.">where</a>($snippet, $args = array()) {
<a name="l00627"></a>00627     $this-&gt;query-&gt;where($snippet, $args);
<a name="l00628"></a>00628     <span class="keywordflow">return</span> $this;
<a name="l00629"></a>00629   }
<a name="l00630"></a>00630 
<a name="l00631"></a><a class="code" href="classSelectQueryExtender_af0ccde59737751f63dfb1743798a45ab.html#af0ccde59737751f63dfb1743798a45ab">00631</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_af0ccde59737751f63dfb1743798a45ab.html#af0ccde59737751f63dfb1743798a45ab" title="Compiles the saved conditions for later retrieval.">compile</a>(<a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> <a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">$connection</a>, <a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> $queryPlaceholder) {
<a name="l00632"></a>00632     <span class="keywordflow">return</span> $this-&gt;query-&gt;compile($connection, $queryPlaceholder);
<a name="l00633"></a>00633   }
<a name="l00634"></a>00634 
<a name="l00635"></a><a class="code" href="classSelectQueryExtender_ae8449b348179f2717a6f07e14f3c806c.html#ae8449b348179f2717a6f07e14f3c806c">00635</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_ae8449b348179f2717a6f07e14f3c806c.html#ae8449b348179f2717a6f07e14f3c806c" title="Check whether a condition has been previously compiled.">compiled</a>() {
<a name="l00636"></a>00636     <span class="keywordflow">return</span> $this-&gt;query-&gt;compiled();
<a name="l00637"></a>00637   }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   <span class="comment">/* Implementations of QueryConditionInterface for the HAVING clause. */</span>
<a name="l00640"></a>00640 
<a name="l00641"></a><a class="code" href="classSelectQueryExtender_a33ac4aade6da091ee121cd442f32c5a2.html#a33ac4aade6da091ee121cd442f32c5a2">00641</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a33ac4aade6da091ee121cd442f32c5a2.html#a33ac4aade6da091ee121cd442f32c5a2" title="Helper function to build most common HAVING conditional clauses.">havingCondition</a>($field, $value = NULL, $operator = <span class="charliteral">&#39;=&#39;</span>) {
<a name="l00642"></a>00642     $this-&gt;query-&gt;havingCondition($field, $value, $operator);
<a name="l00643"></a>00643     <span class="keywordflow">return</span> $this;
<a name="l00644"></a>00644   }
<a name="l00645"></a>00645 
<a name="l00646"></a><a class="code" href="classSelectQueryExtender_a5c9de4d9f5fe5992aac54cf441541f44.html#a5c9de4d9f5fe5992aac54cf441541f44">00646</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_a5c9de4d9f5fe5992aac54cf441541f44.html#a5c9de4d9f5fe5992aac54cf441541f44">havingConditions</a>() {
<a name="l00647"></a>00647     <span class="keywordflow">return</span> $this-&gt;query-&gt;havingConditions();
<a name="l00648"></a>00648   }
<a name="l00649"></a>00649 
<a name="l00650"></a><a class="code" href="classSelectQueryExtender_a2a7fe02858599c1456ad490fe68ee56e.html#a2a7fe02858599c1456ad490fe68ee56e">00650</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a2a7fe02858599c1456ad490fe68ee56e.html#a2a7fe02858599c1456ad490fe68ee56e">havingArguments</a>() {
<a name="l00651"></a>00651     <span class="keywordflow">return</span> $this-&gt;query-&gt;havingArguments();
<a name="l00652"></a>00652   }
<a name="l00653"></a>00653 
<a name="l00654"></a><a class="code" href="classSelectQueryExtender_a942d9c0574add71b3b755872d6fbc080.html#a942d9c0574add71b3b755872d6fbc080">00654</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a942d9c0574add71b3b755872d6fbc080.html#a942d9c0574add71b3b755872d6fbc080">having</a>($snippet, $args = array()) {
<a name="l00655"></a>00655     $this-&gt;query-&gt;having($snippet, $args);
<a name="l00656"></a>00656     <span class="keywordflow">return</span> $this;
<a name="l00657"></a>00657   }
<a name="l00658"></a>00658 
<a name="l00659"></a><a class="code" href="classSelectQueryExtender_a76d969735fe41e9a318a0542200d833a.html#a76d969735fe41e9a318a0542200d833a">00659</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a76d969735fe41e9a318a0542200d833a.html#a76d969735fe41e9a318a0542200d833a">havingCompile</a>(<a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> <a class="code" href="classSelectQueryExtender_ac2f144db843865830840e87ba7fea271.html#ac2f144db843865830840e87ba7fea271">$connection</a>) {
<a name="l00660"></a>00660     <span class="keywordflow">return</span> $this-&gt;query-&gt;havingCompile($connection);
<a name="l00661"></a>00661   }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <span class="comment">/* Implementations of QueryExtendableInterface. */</span>
<a name="l00664"></a>00664 
<a name="l00665"></a><a class="code" href="classSelectQueryExtender_aff046880c8c40a7037f1cade3f765666.html#aff046880c8c40a7037f1cade3f765666">00665</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_aff046880c8c40a7037f1cade3f765666.html#aff046880c8c40a7037f1cade3f765666" title="Enhance this object by wrapping it in an extender object.">extend</a>($extender_name) {
<a name="l00666"></a>00666     <span class="comment">// The extender can be anywhere so this needs to go to the registry, which</span>
<a name="l00667"></a>00667     <span class="comment">// is surely loaded by now.</span>
<a name="l00668"></a>00668     $class = $this-&gt;connection-&gt;getDriverClass($extender_name, array(), TRUE);
<a name="l00669"></a>00669     <span class="keywordflow">return</span> <span class="keyword">new</span> $class($this, $this-&gt;connection);
<a name="l00670"></a>00670   }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672   <span class="comment">/* Alter accessors to expose the query data to alter hooks. */</span>
<a name="l00673"></a>00673 
<a name="l00674"></a><a class="code" href="classSelectQueryExtender_a112da9c917a0e87bba6a8452e29fb8f9.html#a112da9c917a0e87bba6a8452e29fb8f9">00674</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_a112da9c917a0e87bba6a8452e29fb8f9.html#a112da9c917a0e87bba6a8452e29fb8f9" title="Returns a reference to the fields array for this query.">getFields</a>() {
<a name="l00675"></a>00675     <span class="keywordflow">return</span> $this-&gt;query-&gt;getFields();
<a name="l00676"></a>00676   }
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="classSelectQueryExtender_af3a9304421ec40196ce0d3df91accdb4.html#af3a9304421ec40196ce0d3df91accdb4">00678</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_af3a9304421ec40196ce0d3df91accdb4.html#af3a9304421ec40196ce0d3df91accdb4" title="Returns a reference to the expressions array for this query.">getExpressions</a>() {
<a name="l00679"></a>00679     <span class="keywordflow">return</span> $this-&gt;query-&gt;getExpressions();
<a name="l00680"></a>00680   }
<a name="l00681"></a>00681 
<a name="l00682"></a><a class="code" href="classSelectQueryExtender_abc59bf9176493b4f5498eb895e1dcb80.html#abc59bf9176493b4f5498eb895e1dcb80">00682</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_abc59bf9176493b4f5498eb895e1dcb80.html#abc59bf9176493b4f5498eb895e1dcb80" title="Returns a reference to the order by array for this query.">getOrderBy</a>() {
<a name="l00683"></a>00683     <span class="keywordflow">return</span> $this-&gt;query-&gt;getOrderBy();
<a name="l00684"></a>00684   }
<a name="l00685"></a>00685 
<a name="l00686"></a><a class="code" href="classSelectQueryExtender_a1faa2d1d53456685caf7259cd2a06fc4.html#a1faa2d1d53456685caf7259cd2a06fc4">00686</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_a1faa2d1d53456685caf7259cd2a06fc4.html#a1faa2d1d53456685caf7259cd2a06fc4" title="Returns a reference to the group-by array for this query.">getGroupBy</a>() {
<a name="l00687"></a>00687     <span class="keywordflow">return</span> $this-&gt;query-&gt;getGroupBy();
<a name="l00688"></a>00688   }
<a name="l00689"></a>00689 
<a name="l00690"></a><a class="code" href="classSelectQueryExtender_a187dcea9ee5e466af44e5b7edfdf1428.html#a187dcea9ee5e466af44e5b7edfdf1428">00690</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_a187dcea9ee5e466af44e5b7edfdf1428.html#a187dcea9ee5e466af44e5b7edfdf1428" title="Returns a reference to the tables array for this query.">getTables</a>() {
<a name="l00691"></a>00691     <span class="keywordflow">return</span> $this-&gt;query-&gt;getTables();
<a name="l00692"></a>00692   }
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="classSelectQueryExtender_af979cffd090d4e6bac24d2f0712ffb2a.html#af979cffd090d4e6bac24d2f0712ffb2a">00694</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQueryExtender_af979cffd090d4e6bac24d2f0712ffb2a.html#af979cffd090d4e6bac24d2f0712ffb2a" title="Returns a reference to the union queries for this query.">getUnion</a>() {
<a name="l00695"></a>00695     <span class="keywordflow">return</span> $this-&gt;query-&gt;getUnion();
<a name="l00696"></a>00696   }
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="classSelectQueryExtender_a698c3d294496989368d02e5084c27f7e.html#a698c3d294496989368d02e5084c27f7e">00698</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a698c3d294496989368d02e5084c27f7e.html#a698c3d294496989368d02e5084c27f7e" title="Compiles and returns an associative array of the arguments for this prepared statement.">getArguments</a>(<a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> $queryPlaceholder = NULL) {
<a name="l00699"></a>00699     <span class="keywordflow">return</span> $this-&gt;query-&gt;getArguments($queryPlaceholder);
<a name="l00700"></a>00700   }
<a name="l00701"></a>00701 
<a name="l00702"></a><a class="code" href="classSelectQueryExtender_a693e855f00c67fe6281c64cf0339c8ee.html#a693e855f00c67fe6281c64cf0339c8ee">00702</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a693e855f00c67fe6281c64cf0339c8ee.html#a693e855f00c67fe6281c64cf0339c8ee" title="Indicates if preExecute() has already been called on that object.">isPrepared</a>() {
<a name="l00703"></a>00703     <span class="keywordflow">return</span> $this-&gt;query-&gt;isPrepared();
<a name="l00704"></a>00704   }
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="classSelectQueryExtender_a787e071535566e44f7d4f329b5d6911c.html#a787e071535566e44f7d4f329b5d6911c">00706</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a787e071535566e44f7d4f329b5d6911c.html#a787e071535566e44f7d4f329b5d6911c" title="Generic preparation and validation for a SELECT query.">preExecute</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a> = NULL) {
<a name="l00707"></a>00707     <span class="comment">// If no query object is passed in, use $this.</span>
<a name="l00708"></a>00708     <span class="keywordflow">if</span> (!isset(<a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>)) {
<a name="l00709"></a>00709       <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a> = $this;
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712     <span class="keywordflow">return</span> $this-&gt;query-&gt;preExecute(<a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>);
<a name="l00713"></a>00713   }
<a name="l00714"></a>00714 
<a name="l00715"></a><a class="code" href="classSelectQueryExtender_aba0c08de1ff98b87ab8748527dc9f138.html#aba0c08de1ff98b87ab8748527dc9f138">00715</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_aba0c08de1ff98b87ab8748527dc9f138.html#aba0c08de1ff98b87ab8748527dc9f138">execute</a>() {
<a name="l00716"></a>00716     <span class="comment">// By calling preExecute() here, we force it to preprocess the extender</span>
<a name="l00717"></a>00717     <span class="comment">// object rather than just the base query object.  That means</span>
<a name="l00718"></a>00718     <span class="comment">// hook_query_alter() gets access to the extended object.</span>
<a name="l00719"></a>00719     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classSelectQueryExtender_a787e071535566e44f7d4f329b5d6911c.html#a787e071535566e44f7d4f329b5d6911c" title="Generic preparation and validation for a SELECT query.">preExecute</a>($this)) {
<a name="l00720"></a>00720       <span class="keywordflow">return</span> NULL;
<a name="l00721"></a>00721     }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723     <span class="keywordflow">return</span> $this-&gt;query-&gt;execute();
<a name="l00724"></a>00724   }
<a name="l00725"></a>00725 
<a name="l00726"></a><a class="code" href="classSelectQueryExtender_a8e0cb58f3c0b4e6d535bf75703aad7bc.html#a8e0cb58f3c0b4e6d535bf75703aad7bc">00726</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a8e0cb58f3c0b4e6d535bf75703aad7bc.html#a8e0cb58f3c0b4e6d535bf75703aad7bc" title="Sets this query to be DISTINCT.">distinct</a>($distinct = TRUE) {
<a name="l00727"></a>00727     $this-&gt;query-&gt;distinct($distinct);
<a name="l00728"></a>00728     <span class="keywordflow">return</span> $this;
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730 
<a name="l00731"></a><a class="code" href="classSelectQueryExtender_ab5d7e784fcc0f74caa07a53ddc423f05.html#ab5d7e784fcc0f74caa07a53ddc423f05">00731</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_ab5d7e784fcc0f74caa07a53ddc423f05.html#ab5d7e784fcc0f74caa07a53ddc423f05" title="Adds a field to the list to be SELECTed.">addField</a>($table_alias, $field, $alias = NULL) {
<a name="l00732"></a>00732     <span class="keywordflow">return</span> $this-&gt;query-&gt;addField($table_alias, $field, $alias);
<a name="l00733"></a>00733   }
<a name="l00734"></a>00734 
<a name="l00735"></a><a class="code" href="classSelectQueryExtender_a5b4e0bd5f5e383054a8580dd4fbac077.html#a5b4e0bd5f5e383054a8580dd4fbac077">00735</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a5b4e0bd5f5e383054a8580dd4fbac077.html#a5b4e0bd5f5e383054a8580dd4fbac077" title="Add multiple fields from the same table to be SELECTed.">fields</a>($table_alias, array $fields = array()) {
<a name="l00736"></a>00736     $this-&gt;query-&gt;fields($table_alias, $fields);
<a name="l00737"></a>00737     <span class="keywordflow">return</span> $this;
<a name="l00738"></a>00738   }
<a name="l00739"></a>00739 
<a name="l00740"></a><a class="code" href="classSelectQueryExtender_a6e05e811e495e6f36fb0ec1ef21abbc1.html#a6e05e811e495e6f36fb0ec1ef21abbc1">00740</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a6e05e811e495e6f36fb0ec1ef21abbc1.html#a6e05e811e495e6f36fb0ec1ef21abbc1" title="Adds an expression to the list of &quot;fields&quot; to be SELECTed.">addExpression</a>($expression, $alias = NULL, $arguments = array()) {
<a name="l00741"></a>00741     <span class="keywordflow">return</span> $this-&gt;query-&gt;addExpression($expression, $alias, $arguments);
<a name="l00742"></a>00742   }
<a name="l00743"></a>00743 
<a name="l00744"></a><a class="code" href="classSelectQueryExtender_a6b9998d4e438ab3edc2867e32a5c120c.html#a6b9998d4e438ab3edc2867e32a5c120c">00744</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a6b9998d4e438ab3edc2867e32a5c120c.html#a6b9998d4e438ab3edc2867e32a5c120c" title="Default Join against another table in the database.">join</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l00745"></a>00745     <span class="keywordflow">return</span> $this-&gt;query-&gt;join($table, $alias, $condition, $arguments);
<a name="l00746"></a>00746   }
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="classSelectQueryExtender_a4c37ec31ec8dce6287cb5d211886b23e.html#a4c37ec31ec8dce6287cb5d211886b23e">00748</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a4c37ec31ec8dce6287cb5d211886b23e.html#a4c37ec31ec8dce6287cb5d211886b23e" title="Inner Join against another table in the database.">innerJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l00749"></a>00749     <span class="keywordflow">return</span> $this-&gt;query-&gt;innerJoin($table, $alias, $condition, $arguments);
<a name="l00750"></a>00750   }
<a name="l00751"></a>00751 
<a name="l00752"></a><a class="code" href="classSelectQueryExtender_aad9dd7062882479b2eb466fbe8dbd950.html#aad9dd7062882479b2eb466fbe8dbd950">00752</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_aad9dd7062882479b2eb466fbe8dbd950.html#aad9dd7062882479b2eb466fbe8dbd950" title="Left Outer Join against another table in the database.">leftJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l00753"></a>00753     <span class="keywordflow">return</span> $this-&gt;query-&gt;leftJoin($table, $alias, $condition, $arguments);
<a name="l00754"></a>00754   }
<a name="l00755"></a>00755 
<a name="l00756"></a><a class="code" href="classSelectQueryExtender_af2012b63276cf32b2422d342d257c835.html#af2012b63276cf32b2422d342d257c835">00756</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_af2012b63276cf32b2422d342d257c835.html#af2012b63276cf32b2422d342d257c835" title="Right Outer Join against another table in the database.">rightJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l00757"></a>00757     <span class="keywordflow">return</span> $this-&gt;query-&gt;rightJoin($table, $alias, $condition, $arguments);
<a name="l00758"></a>00758   }
<a name="l00759"></a>00759 
<a name="l00760"></a><a class="code" href="classSelectQueryExtender_ad6b6dd29f9c4de6129030be8d110d6ee.html#ad6b6dd29f9c4de6129030be8d110d6ee">00760</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_ad6b6dd29f9c4de6129030be8d110d6ee.html#ad6b6dd29f9c4de6129030be8d110d6ee" title="Join against another table in the database.">addJoin</a>($type, $table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l00761"></a>00761     <span class="keywordflow">return</span> $this-&gt;query-&gt;addJoin($type, $table, $alias, $condition, $arguments);
<a name="l00762"></a>00762   }
<a name="l00763"></a>00763 
<a name="l00764"></a><a class="code" href="classSelectQueryExtender_a7ed1e21116ca34f68a9d1c14e6c31096.html#a7ed1e21116ca34f68a9d1c14e6c31096">00764</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a7ed1e21116ca34f68a9d1c14e6c31096.html#a7ed1e21116ca34f68a9d1c14e6c31096" title="Orders the result set by a given field.">orderBy</a>($field, $direction = <span class="stringliteral">&#39;ASC&#39;</span>) {
<a name="l00765"></a>00765     $this-&gt;query-&gt;orderBy($field, $direction);
<a name="l00766"></a>00766     <span class="keywordflow">return</span> $this;
<a name="l00767"></a>00767   }
<a name="l00768"></a>00768 
<a name="l00769"></a><a class="code" href="classSelectQueryExtender_afd183cab845d100b7890ff8cdfb380d4.html#afd183cab845d100b7890ff8cdfb380d4">00769</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_afd183cab845d100b7890ff8cdfb380d4.html#afd183cab845d100b7890ff8cdfb380d4" title="Orders the result set by a random value.">orderRandom</a>() {
<a name="l00770"></a>00770     $this-&gt;query-&gt;orderRandom();
<a name="l00771"></a>00771     <span class="keywordflow">return</span> $this;
<a name="l00772"></a>00772   }
<a name="l00773"></a>00773 
<a name="l00774"></a><a class="code" href="classSelectQueryExtender_a83b472a48decf872faf61ded0c576697.html#a83b472a48decf872faf61ded0c576697">00774</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a83b472a48decf872faf61ded0c576697.html#a83b472a48decf872faf61ded0c576697" title="Restricts a query to a given range in the result set.">range</a>($start = NULL, $length = NULL) {
<a name="l00775"></a>00775     $this-&gt;query-&gt;range($start, $length);
<a name="l00776"></a>00776     <span class="keywordflow">return</span> $this;
<a name="l00777"></a>00777   }
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="classSelectQueryExtender_a76bc43cb0499bc568da2b243d033ef6e.html#a76bc43cb0499bc568da2b243d033ef6e">00779</a>   <span class="keyword">public</span> <span class="keyword">function</span> <span class="keyword">union</span>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> <a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>, $type = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00780"></a>00780     $this-&gt;query-&gt;union(<a class="code" href="classSelectQueryExtender_a1fc09fee1a46d42b556c2b9811b3f000.html#a1fc09fee1a46d42b556c2b9811b3f000">$query</a>, $type);
<a name="l00781"></a>00781     <span class="keywordflow">return</span> $this;
<a name="l00782"></a>00782   }
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="classSelectQueryExtender_aa51fb0b6bc8b2484b52328f1109d1a48.html#aa51fb0b6bc8b2484b52328f1109d1a48">00784</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_aa51fb0b6bc8b2484b52328f1109d1a48.html#aa51fb0b6bc8b2484b52328f1109d1a48" title="Groups the result set by the specified field.">groupBy</a>($field) {
<a name="l00785"></a>00785     $this-&gt;query-&gt;groupBy($field);
<a name="l00786"></a>00786     <span class="keywordflow">return</span> $this;
<a name="l00787"></a>00787   }
<a name="l00788"></a>00788 
<a name="l00789"></a><a class="code" href="classSelectQueryExtender_a90e930c3ee67a055b81f7f31b18ba84e.html#a90e930c3ee67a055b81f7f31b18ba84e">00789</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a90e930c3ee67a055b81f7f31b18ba84e.html#a90e930c3ee67a055b81f7f31b18ba84e" title="Add FOR UPDATE to the query.">forUpdate</a>($set = TRUE) {
<a name="l00790"></a>00790     $this-&gt;query-&gt;forUpdate($set);
<a name="l00791"></a>00791     <span class="keywordflow">return</span> $this;
<a name="l00792"></a>00792   }
<a name="l00793"></a>00793 
<a name="l00794"></a><a class="code" href="classSelectQueryExtender_a4c222f9407cc787f41b49be4b8ee26a5.html#a4c222f9407cc787f41b49be4b8ee26a5">00794</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a4c222f9407cc787f41b49be4b8ee26a5.html#a4c222f9407cc787f41b49be4b8ee26a5" title="Get the equivalent COUNT query of this query as a new query object.">countQuery</a>() {
<a name="l00795"></a>00795     <span class="keywordflow">return</span> $this-&gt;query-&gt;countQuery();
<a name="l00796"></a>00796   }
<a name="l00797"></a>00797 
<a name="l00798"></a><a class="code" href="classSelectQueryExtender_ad30e0f469cabfcc18f148468cc507cd8.html#ad30e0f469cabfcc18f148468cc507cd8">00798</a>   <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_ad30e0f469cabfcc18f148468cc507cd8.html#ad30e0f469cabfcc18f148468cc507cd8" title="Sets a condition that the specified field be NULL.">isNull</a>($field) {
<a name="l00799"></a>00799     $this-&gt;query-&gt;isNull($field);
<a name="l00800"></a>00800     <span class="keywordflow">return</span> $this;
<a name="l00801"></a>00801   }
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="classSelectQueryExtender_a24432e3ab40f7c1ce1404d6773e539f4.html#a24432e3ab40f7c1ce1404d6773e539f4">00803</a>   <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a24432e3ab40f7c1ce1404d6773e539f4.html#a24432e3ab40f7c1ce1404d6773e539f4" title="Sets a condition that the specified field be NOT NULL.">isNotNull</a>($field) {
<a name="l00804"></a>00804     $this-&gt;query-&gt;isNotNull($field);
<a name="l00805"></a>00805     <span class="keywordflow">return</span> $this;
<a name="l00806"></a>00806   }
<a name="l00807"></a>00807 
<a name="l00808"></a><a class="code" href="classSelectQueryExtender_aa250c6c085e53ac64607649f75b5f468.html#aa250c6c085e53ac64607649f75b5f468">00808</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_aa250c6c085e53ac64607649f75b5f468.html#aa250c6c085e53ac64607649f75b5f468" title="Sets a condition that the specified subquery returns values.">exists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l00809"></a>00809     $this-&gt;query-&gt;exists($select);
<a name="l00810"></a>00810     <span class="keywordflow">return</span> $this;
<a name="l00811"></a>00811   }
<a name="l00812"></a>00812 
<a name="l00813"></a><a class="code" href="classSelectQueryExtender_a0cd2b1d2e813fc6b8280221f6ca40777.html#a0cd2b1d2e813fc6b8280221f6ca40777">00813</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a0cd2b1d2e813fc6b8280221f6ca40777.html#a0cd2b1d2e813fc6b8280221f6ca40777" title="Sets a condition that the specified subquery returns no values.">notExists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l00814"></a>00814     $this-&gt;query-&gt;notExists($select);
<a name="l00815"></a>00815     <span class="keywordflow">return</span> $this;
<a name="l00816"></a>00816   }
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="classSelectQueryExtender_a0043e08d63d174a25378966bcc0d9282.html#a0043e08d63d174a25378966bcc0d9282">00818</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a0043e08d63d174a25378966bcc0d9282.html#a0043e08d63d174a25378966bcc0d9282">__toString</a>() {
<a name="l00819"></a>00819     <span class="keywordflow">return</span> (<span class="keywordtype">string</span>) $this-&gt;query;
<a name="l00820"></a>00820   }
<a name="l00821"></a>00821 
<a name="l00822"></a><a class="code" href="classSelectQueryExtender_a3d9ade6266951fdc8e5757c8e61b352c.html#a3d9ade6266951fdc8e5757c8e61b352c">00822</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a3d9ade6266951fdc8e5757c8e61b352c.html#a3d9ade6266951fdc8e5757c8e61b352c" title="Clone magic method.">__clone</a>() {
<a name="l00823"></a>00823     $this-&gt;<a class="code" href="classSelectQueryExtender_a4bb30825327565c94e01b4f5a785a5ed.html#a4bb30825327565c94e01b4f5a785a5ed" title="Implements QueryPlaceholderInterface::uniqueIdentifier().">uniqueIdentifier</a> = uniqid(<span class="stringliteral">&#39;&#39;</span>, TRUE);
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <span class="comment">// We need to deep-clone the query we&#39;re wrapping, which in turn may</span>
<a name="l00826"></a>00826     <span class="comment">// deep-clone other objects.  Exciting!</span>
<a name="l00827"></a>00827     $this-&gt;query = clone($this-&gt;query);
<a name="l00828"></a>00828   }
<a name="l00829"></a>00829 
<a name="l00839"></a><a class="code" href="classSelectQueryExtender_a8cbcdc84cab9b35505c10b51d13efa89.html#a8cbcdc84cab9b35505c10b51d13efa89">00839</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQueryExtender_a8cbcdc84cab9b35505c10b51d13efa89.html#a8cbcdc84cab9b35505c10b51d13efa89" title="Magic override for undefined methods.">__call</a>($method, $args) {
<a name="l00840"></a>00840     $return = call_user_func_array(array($this-&gt;query, $method), $args);
<a name="l00841"></a>00841 
<a name="l00842"></a>00842     <span class="comment">// Some methods will return the called object as part of a fluent interface.</span>
<a name="l00843"></a>00843     <span class="comment">// Others will return some useful value.  If it&#39;s a value, then the caller</span>
<a name="l00844"></a>00844     <span class="comment">// probably wants that value.  If it&#39;s the called object, then we instead</span>
<a name="l00845"></a>00845     <span class="comment">// return this object.  That way we don&#39;t &quot;lose&quot; an extender layer when</span>
<a name="l00846"></a>00846     <span class="comment">// chaining methods together.</span>
<a name="l00847"></a>00847     <span class="keywordflow">if</span> ($return instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l00848"></a>00848       <span class="keywordflow">return</span> $this;
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850     <span class="keywordflow">else</span> {
<a name="l00851"></a>00851       <span class="keywordflow">return</span> $return;
<a name="l00852"></a>00852     }
<a name="l00853"></a>00853   }
<a name="l00854"></a>00854 }
<a name="l00855"></a>00855 
<a name="l00859"></a><a class="code" href="classSelectQuery.html">00859</a> <span class="keyword">class </span><a class="code" href="classSelectQuery.html" title="Query builder for SELECT statements.">SelectQuery</a> <span class="keyword">extends</span> <a class="code" href="classQuery.html" title="Base class for query builders.">Query</a> implements <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> {
<a name="l00860"></a>00860 
<a name="l00866"></a><a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">00866</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> = array();
<a name="l00867"></a>00867 
<a name="l00873"></a><a class="code" href="classSelectQuery_ab763e3db3e95a5d2fbea64544b630eac.html#ab763e3db3e95a5d2fbea64544b630eac">00873</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_ab763e3db3e95a5d2fbea64544b630eac.html#ab763e3db3e95a5d2fbea64544b630eac">$expressions</a> = array();
<a name="l00874"></a>00874 
<a name="l00895"></a><a class="code" href="classSelectQuery_a30d0c883c76269fce6d1ad61394affd4.html#a30d0c883c76269fce6d1ad61394affd4">00895</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a30d0c883c76269fce6d1ad61394affd4.html#a30d0c883c76269fce6d1ad61394affd4">$tables</a> = array();
<a name="l00896"></a>00896 
<a name="l00905"></a><a class="code" href="classSelectQuery_a8f8427b3590fe12219b3266e2d729257.html#a8f8427b3590fe12219b3266e2d729257">00905</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a8f8427b3590fe12219b3266e2d729257.html#a8f8427b3590fe12219b3266e2d729257">$order</a> = array();
<a name="l00906"></a>00906 
<a name="l00912"></a><a class="code" href="classSelectQuery_aa99dbf66f73eff5b8b98843edbe3de50.html#aa99dbf66f73eff5b8b98843edbe3de50">00912</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_aa99dbf66f73eff5b8b98843edbe3de50.html#aa99dbf66f73eff5b8b98843edbe3de50">$group</a> = array();
<a name="l00913"></a>00913 
<a name="l00919"></a><a class="code" href="classSelectQuery_a7396f64940a810bfa013e3bed7b97891.html#a7396f64940a810bfa013e3bed7b97891">00919</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a7396f64940a810bfa013e3bed7b97891.html#a7396f64940a810bfa013e3bed7b97891">$where</a>;
<a name="l00920"></a>00920 
<a name="l00926"></a><a class="code" href="classSelectQuery_afbc6814498bc1a7de2837f904ccf1685.html#afbc6814498bc1a7de2837f904ccf1685">00926</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_afbc6814498bc1a7de2837f904ccf1685.html#afbc6814498bc1a7de2837f904ccf1685">$having</a>;
<a name="l00927"></a>00927 
<a name="l00933"></a><a class="code" href="classSelectQuery_a06f4f274e48265a9cd4cb4746ca570df.html#a06f4f274e48265a9cd4cb4746ca570df">00933</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a06f4f274e48265a9cd4cb4746ca570df.html#a06f4f274e48265a9cd4cb4746ca570df">$distinct</a> = FALSE;
<a name="l00934"></a>00934 
<a name="l00940"></a><a class="code" href="classSelectQuery_a75ed5f6ced378323afc0ee3f302ccad6.html#a75ed5f6ced378323afc0ee3f302ccad6">00940</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a75ed5f6ced378323afc0ee3f302ccad6.html#a75ed5f6ced378323afc0ee3f302ccad6">$range</a>;
<a name="l00941"></a>00941 
<a name="l00953"></a><a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">00953</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a> = array();
<a name="l00954"></a>00954 
<a name="l00959"></a><a class="code" href="classSelectQuery_a765c1857e9cc6d50930acafa1cb6cccc.html#a765c1857e9cc6d50930acafa1cb6cccc">00959</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a765c1857e9cc6d50930acafa1cb6cccc.html#a765c1857e9cc6d50930acafa1cb6cccc">$prepared</a> = FALSE;
<a name="l00960"></a>00960 
<a name="l00964"></a><a class="code" href="classSelectQuery_a72a385abf2fbe4143df62f616af655af.html#a72a385abf2fbe4143df62f616af655af">00964</a>   <span class="keyword">protected</span> <a class="code" href="classSelectQuery_a72a385abf2fbe4143df62f616af655af.html#a72a385abf2fbe4143df62f616af655af" title="The FOR UPDATE status.">$forUpdate</a> = FALSE;
<a name="l00965"></a>00965 
<a name="l00966"></a><a class="code" href="classSelectQuery_af5d37c25a363250a7cd41f53a1365abc.html#af5d37c25a363250a7cd41f53a1365abc">00966</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_af5d37c25a363250a7cd41f53a1365abc.html#af5d37c25a363250a7cd41f53a1365abc">__construct</a>($table, $alias = NULL, <a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> <a class="code" href="classQuery_ad2260119848060bb535ca58390b10668.html#ad2260119848060bb535ca58390b10668">$connection</a>, $options = array()) {
<a name="l00967"></a>00967     $options[<span class="stringliteral">&#39;return&#39;</span>] = <a class="code" href="classDatabase_a7b7c6f8f81159b97752412e439d957dc.html#a7b7c6f8f81159b97752412e439d957dc" title="Flag to indicate a query call should return the prepared statement.">Database::RETURN_STATEMENT</a>;
<a name="l00968"></a>00968     <a class="code" href="classSelectQuery_af5d37c25a363250a7cd41f53a1365abc.html#af5d37c25a363250a7cd41f53a1365abc">parent::__construct</a>($connection, $options);
<a name="l00969"></a>00969     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a> = <span class="keyword">new</span> <a class="code" href="classDatabaseCondition.html" title="Generic class for a series of conditions in a query.">DatabaseCondition</a>(<span class="stringliteral">&#39;AND&#39;</span>);
<a name="l00970"></a>00970     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a> = <span class="keyword">new</span> <a class="code" href="classDatabaseCondition.html" title="Generic class for a series of conditions in a query.">DatabaseCondition</a>(<span class="stringliteral">&#39;AND&#39;</span>);
<a name="l00971"></a>00971     $this-&gt;<a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>(NULL, $table, $alias);
<a name="l00972"></a>00972   }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974   <span class="comment">/* Implementations of QueryAlterableInterface. */</span>
<a name="l00975"></a>00975 
<a name="l00976"></a><a class="code" href="classSelectQuery_a2efa69685cefbe98f824f5c5e97e092f.html#a2efa69685cefbe98f824f5c5e97e092f">00976</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a2efa69685cefbe98f824f5c5e97e092f.html#a2efa69685cefbe98f824f5c5e97e092f" title="Adds a tag to a query.">addTag</a>($tag) {
<a name="l00977"></a>00977     $this-&gt;alterTags[$tag] = 1;
<a name="l00978"></a>00978     <span class="keywordflow">return</span> $this;
<a name="l00979"></a>00979   }
<a name="l00980"></a>00980 
<a name="l00981"></a><a class="code" href="classSelectQuery_a1d85219dc7e79cbff77c0b86a5861ddc.html#a1d85219dc7e79cbff77c0b86a5861ddc">00981</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a1d85219dc7e79cbff77c0b86a5861ddc.html#a1d85219dc7e79cbff77c0b86a5861ddc" title="Determines if a given query has a given tag.">hasTag</a>($tag) {
<a name="l00982"></a>00982     <span class="keywordflow">return</span> isset($this-&gt;alterTags[$tag]);
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984 
<a name="l00985"></a><a class="code" href="classSelectQuery_a4e1f417bc10a31d158260b6534057205.html#a4e1f417bc10a31d158260b6534057205">00985</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a4e1f417bc10a31d158260b6534057205.html#a4e1f417bc10a31d158260b6534057205" title="Determines if a given query has all specified tags.">hasAllTags</a>() {
<a name="l00986"></a>00986     $args = func_get_args();
<a name="l00987"></a>00987     <span class="keywordflow">return</span> !(boolean)array_diff($args, array_keys($this-&gt;alterTags));
<a name="l00988"></a>00988   }
<a name="l00989"></a>00989 
<a name="l00990"></a><a class="code" href="classSelectQuery_af5d6a2ad80e61e01d211ed769a60e312.html#af5d6a2ad80e61e01d211ed769a60e312">00990</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_af5d6a2ad80e61e01d211ed769a60e312.html#af5d6a2ad80e61e01d211ed769a60e312" title="Determines if a given query has any specified tag.">hasAnyTag</a>() {
<a name="l00991"></a>00991     $args = func_get_args();
<a name="l00992"></a>00992     <span class="keywordflow">return</span> (<span class="keywordtype">boolean</span>)array_intersect($args, array_keys($this-&gt;alterTags));
<a name="l00993"></a>00993   }
<a name="l00994"></a>00994 
<a name="l00995"></a><a class="code" href="classSelectQuery_a6e453f491388dfd67e568baa8b807b01.html#a6e453f491388dfd67e568baa8b807b01">00995</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a6e453f491388dfd67e568baa8b807b01.html#a6e453f491388dfd67e568baa8b807b01" title="Adds additional metadata to the query.">addMetaData</a>($key, $object) {
<a name="l00996"></a>00996     $this-&gt;alterMetaData[$key] = $object;
<a name="l00997"></a>00997     <span class="keywordflow">return</span> $this;
<a name="l00998"></a>00998   }
<a name="l00999"></a>00999 
<a name="l01000"></a><a class="code" href="classSelectQuery_aa153d7f1e6960d96e1c794747de1141d.html#aa153d7f1e6960d96e1c794747de1141d">01000</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_aa153d7f1e6960d96e1c794747de1141d.html#aa153d7f1e6960d96e1c794747de1141d" title="Retrieves a given piece of metadata.">getMetaData</a>($key) {
<a name="l01001"></a>01001     <span class="keywordflow">return</span> isset($this-&gt;alterMetaData[$key]) ? $this-&gt;alterMetaData[$key] : NULL;
<a name="l01002"></a>01002   }
<a name="l01003"></a>01003 
<a name="l01004"></a>01004   <span class="comment">/* Implementations of QueryConditionInterface for the WHERE clause. */</span>
<a name="l01005"></a>01005 
<a name="l01006"></a><a class="code" href="classSelectQuery_a742732edee2dc50e19be1d2cdb09537b.html#a742732edee2dc50e19be1d2cdb09537b">01006</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a742732edee2dc50e19be1d2cdb09537b.html#a742732edee2dc50e19be1d2cdb09537b" title="Helper function: builds the most common conditional clauses.">condition</a>($field, $value = NULL, $operator = NULL) {
<a name="l01007"></a>01007     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;condition($field, $value, $operator);
<a name="l01008"></a>01008     <span class="keywordflow">return</span> $this;
<a name="l01009"></a>01009   }
<a name="l01010"></a>01010 
<a name="l01011"></a><a class="code" href="classSelectQuery_a5cdf8e2be2dfd407bdc34bfaa2c216ad.html#a5cdf8e2be2dfd407bdc34bfaa2c216ad">01011</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_a5cdf8e2be2dfd407bdc34bfaa2c216ad.html#a5cdf8e2be2dfd407bdc34bfaa2c216ad" title="Gets a complete list of all conditions in this conditional clause.">conditions</a>() {
<a name="l01012"></a>01012     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;conditions();
<a name="l01013"></a>01013   }
<a name="l01014"></a>01014 
<a name="l01015"></a><a class="code" href="classSelectQuery_ada38099d692203d261f6a6b708a9635c.html#ada38099d692203d261f6a6b708a9635c">01015</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ada38099d692203d261f6a6b708a9635c.html#ada38099d692203d261f6a6b708a9635c" title="Gets a complete list of all values to insert into the prepared statement.">arguments</a>() {
<a name="l01016"></a>01016     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935" title="Check whether a condition has been previously compiled.">compiled</a>()) {
<a name="l01017"></a>01017       <span class="keywordflow">return</span> NULL;
<a name="l01018"></a>01018     }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020     $args = $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;arguments() + $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;arguments();
<a name="l01021"></a>01021 
<a name="l01022"></a>01022     <span class="keywordflow">foreach</span> ($this-&gt;tables as $table) {
<a name="l01023"></a>01023       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;arguments&#39;</span>]) {
<a name="l01024"></a>01024         $args += $table[<span class="stringliteral">&#39;arguments&#39;</span>];
<a name="l01025"></a>01025       }
<a name="l01026"></a>01026       <span class="comment">// If this table is a subquery, grab its arguments recursively.</span>
<a name="l01027"></a>01027       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;table&#39;</span>] instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01028"></a>01028         $args += $table[<span class="stringliteral">&#39;table&#39;</span>]-&gt;arguments();
<a name="l01029"></a>01029       }
<a name="l01030"></a>01030     }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032     <span class="keywordflow">foreach</span> ($this-&gt;expressions as $expression) {
<a name="l01033"></a>01033       <span class="keywordflow">if</span> ($expression[<span class="stringliteral">&#39;arguments&#39;</span>]) {
<a name="l01034"></a>01034         $args += $expression[<span class="stringliteral">&#39;arguments&#39;</span>];
<a name="l01035"></a>01035       }
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038     <span class="comment">// If there are any dependent queries to UNION,</span>
<a name="l01039"></a>01039     <span class="comment">// incorporate their arguments recursively.</span>
<a name="l01040"></a>01040     <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a>) {
<a name="l01041"></a>01041       $args += $union[<span class="stringliteral">&#39;query&#39;</span>]-&gt;arguments();
<a name="l01042"></a>01042     }
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     <span class="keywordflow">return</span> $args;
<a name="l01045"></a>01045   }
<a name="l01046"></a>01046 
<a name="l01047"></a><a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18">01047</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>($snippet, $args = array()) {
<a name="l01048"></a>01048     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;where($snippet, $args);
<a name="l01049"></a>01049     <span class="keywordflow">return</span> $this;
<a name="l01050"></a>01050   }
<a name="l01051"></a>01051 
<a name="l01052"></a><a class="code" href="classSelectQuery_ab278e789f0e46f588f6d2c5cf030d3d8.html#ab278e789f0e46f588f6d2c5cf030d3d8">01052</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ab278e789f0e46f588f6d2c5cf030d3d8.html#ab278e789f0e46f588f6d2c5cf030d3d8" title="Sets a condition that the specified field be NULL.">isNull</a>($field) {
<a name="l01053"></a>01053     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;isNull($field);
<a name="l01054"></a>01054     <span class="keywordflow">return</span> $this;
<a name="l01055"></a>01055   }
<a name="l01056"></a>01056 
<a name="l01057"></a><a class="code" href="classSelectQuery_a52334c418025609d024d2a21c6e487ea.html#a52334c418025609d024d2a21c6e487ea">01057</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a52334c418025609d024d2a21c6e487ea.html#a52334c418025609d024d2a21c6e487ea" title="Sets a condition that the specified field be NOT NULL.">isNotNull</a>($field) {
<a name="l01058"></a>01058     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;isNotNull($field);
<a name="l01059"></a>01059     <span class="keywordflow">return</span> $this;
<a name="l01060"></a>01060   }
<a name="l01061"></a>01061 
<a name="l01062"></a><a class="code" href="classSelectQuery_a0b3d1a7b33abeef2af08601330a80844.html#a0b3d1a7b33abeef2af08601330a80844">01062</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a0b3d1a7b33abeef2af08601330a80844.html#a0b3d1a7b33abeef2af08601330a80844" title="Sets a condition that the specified subquery returns values.">exists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l01063"></a>01063     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;exists($select);
<a name="l01064"></a>01064     <span class="keywordflow">return</span> $this;
<a name="l01065"></a>01065   }
<a name="l01066"></a>01066 
<a name="l01067"></a><a class="code" href="classSelectQuery_a800e7ee63d0d648483953bb6961738ca.html#a800e7ee63d0d648483953bb6961738ca">01067</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a800e7ee63d0d648483953bb6961738ca.html#a800e7ee63d0d648483953bb6961738ca" title="Sets a condition that the specified subquery returns no values.">notExists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l01068"></a>01068     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;notExists($select);
<a name="l01069"></a>01069     <span class="keywordflow">return</span> $this;
<a name="l01070"></a>01070   }
<a name="l01071"></a>01071 
<a name="l01072"></a><a class="code" href="classSelectQuery_ad858d64a89ca6b8d60f135470d40319f.html#ad858d64a89ca6b8d60f135470d40319f">01072</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ad858d64a89ca6b8d60f135470d40319f.html#ad858d64a89ca6b8d60f135470d40319f" title="Compiles the saved conditions for later retrieval.">compile</a>(<a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> $connection, <a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> $queryPlaceholder) {
<a name="l01073"></a>01073     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;compile($connection, $queryPlaceholder);
<a name="l01074"></a>01074     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;compile($connection, $queryPlaceholder);
<a name="l01075"></a>01075 
<a name="l01076"></a>01076     <span class="keywordflow">foreach</span> ($this-&gt;tables as $table) {
<a name="l01077"></a>01077       <span class="comment">// If this table is a subquery, compile it recursively.</span>
<a name="l01078"></a>01078       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;table&#39;</span>] instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01079"></a>01079         $table[<span class="stringliteral">&#39;table&#39;</span>]-&gt;compile($connection, $queryPlaceholder);
<a name="l01080"></a>01080       }
<a name="l01081"></a>01081     }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083     <span class="comment">// If there are any dependent queries to UNION, compile it recursively.</span>
<a name="l01084"></a>01084     <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a>) {
<a name="l01085"></a>01085       $union[<span class="stringliteral">&#39;query&#39;</span>]-&gt;compile($connection, $queryPlaceholder);
<a name="l01086"></a>01086     }
<a name="l01087"></a>01087   }
<a name="l01088"></a>01088 
<a name="l01089"></a><a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935">01089</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935" title="Check whether a condition has been previously compiled.">compiled</a>() {
<a name="l01090"></a>01090     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>-&gt;compiled() || !$this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;compiled()) {
<a name="l01091"></a>01091       <span class="keywordflow">return</span> FALSE;
<a name="l01092"></a>01092     }
<a name="l01093"></a>01093 
<a name="l01094"></a>01094     <span class="keywordflow">foreach</span> ($this-&gt;tables as $table) {
<a name="l01095"></a>01095       <span class="comment">// If this table is a subquery, check its status recursively.</span>
<a name="l01096"></a>01096       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;table&#39;</span>] instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01097"></a>01097         <span class="keywordflow">if</span> (!$table[<span class="stringliteral">&#39;table&#39;</span>]-&gt;<a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935" title="Check whether a condition has been previously compiled.">compiled</a>()) {
<a name="l01098"></a>01098           <span class="keywordflow">return</span> FALSE;
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100       }
<a name="l01101"></a>01101     }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a>) {
<a name="l01104"></a>01104       <span class="keywordflow">if</span> (!$union[<span class="stringliteral">&#39;query&#39;</span>]-&gt;<a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935" title="Check whether a condition has been previously compiled.">compiled</a>()) {
<a name="l01105"></a>01105         <span class="keywordflow">return</span> FALSE;
<a name="l01106"></a>01106       }
<a name="l01107"></a>01107     }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109     <span class="keywordflow">return</span> TRUE;
<a name="l01110"></a>01110   }
<a name="l01111"></a>01111 
<a name="l01112"></a>01112   <span class="comment">/* Implementations of QueryConditionInterface for the HAVING clause. */</span>
<a name="l01113"></a>01113 
<a name="l01114"></a><a class="code" href="classSelectQuery_a99fb631e9ddd64677d84c9e60855a6f7.html#a99fb631e9ddd64677d84c9e60855a6f7">01114</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a99fb631e9ddd64677d84c9e60855a6f7.html#a99fb631e9ddd64677d84c9e60855a6f7" title="Helper function to build most common HAVING conditional clauses.">havingCondition</a>($field, $value = NULL, $operator = NULL) {
<a name="l01115"></a>01115     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;condition($field, $value, $operator);
<a name="l01116"></a>01116     <span class="keywordflow">return</span> $this;
<a name="l01117"></a>01117   }
<a name="l01118"></a>01118 
<a name="l01119"></a><a class="code" href="classSelectQuery_ae36c18ede223864df43dfcf5afbbc74b.html#ae36c18ede223864df43dfcf5afbbc74b">01119</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_ae36c18ede223864df43dfcf5afbbc74b.html#ae36c18ede223864df43dfcf5afbbc74b">havingConditions</a>() {
<a name="l01120"></a>01120     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;conditions();
<a name="l01121"></a>01121   }
<a name="l01122"></a>01122 
<a name="l01123"></a><a class="code" href="classSelectQuery_a0f6057130103068335792005cc3d5673.html#a0f6057130103068335792005cc3d5673">01123</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a0f6057130103068335792005cc3d5673.html#a0f6057130103068335792005cc3d5673">havingArguments</a>() {
<a name="l01124"></a>01124     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;arguments();
<a name="l01125"></a>01125   }
<a name="l01126"></a>01126 
<a name="l01127"></a><a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">01127</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>($snippet, $args = array()) {
<a name="l01128"></a>01128     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;where($snippet, $args);
<a name="l01129"></a>01129     <span class="keywordflow">return</span> $this;
<a name="l01130"></a>01130   }
<a name="l01131"></a>01131 
<a name="l01132"></a><a class="code" href="classSelectQuery_a89f27c396bacc44ae6dbd7ba78ac52bc.html#a89f27c396bacc44ae6dbd7ba78ac52bc">01132</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a89f27c396bacc44ae6dbd7ba78ac52bc.html#a89f27c396bacc44ae6dbd7ba78ac52bc">havingCompile</a>(<a class="code" href="classDatabaseConnection.html" title="Base Database API class.">DatabaseConnection</a> $connection) {
<a name="l01133"></a>01133     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;compile($connection, $this);
<a name="l01134"></a>01134   }
<a name="l01135"></a>01135 
<a name="l01136"></a>01136   <span class="comment">/* Implementations of QueryExtendableInterface. */</span>
<a name="l01137"></a>01137 
<a name="l01138"></a><a class="code" href="classSelectQuery_ab401a1ee7ce9ea726cf3856297a46532.html#ab401a1ee7ce9ea726cf3856297a46532">01138</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ab401a1ee7ce9ea726cf3856297a46532.html#ab401a1ee7ce9ea726cf3856297a46532" title="Enhance this object by wrapping it in an extender object.">extend</a>($extender_name) {
<a name="l01139"></a>01139     $override_class = $extender_name . <span class="charliteral">&#39;_&#39;</span> . $this-&gt;connection-&gt;driver();
<a name="l01140"></a>01140     <span class="keywordflow">if</span> (class_exists($override_class)) {
<a name="l01141"></a>01141       $extender_name = $override_class;
<a name="l01142"></a>01142     }
<a name="l01143"></a>01143     <span class="keywordflow">return</span> <span class="keyword">new</span> $extender_name($this, $this-&gt;connection);
<a name="l01144"></a>01144   }
<a name="l01145"></a>01145 
<a name="l01146"></a><a class="code" href="classSelectQuery_a6eef8e0334a321516ba2b9ab16a5f5a9.html#a6eef8e0334a321516ba2b9ab16a5f5a9">01146</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a6eef8e0334a321516ba2b9ab16a5f5a9.html#a6eef8e0334a321516ba2b9ab16a5f5a9">havingIsNull</a>($field) {
<a name="l01147"></a>01147     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;isNull($field);
<a name="l01148"></a>01148     <span class="keywordflow">return</span> $this;
<a name="l01149"></a>01149   }
<a name="l01150"></a>01150 
<a name="l01151"></a><a class="code" href="classSelectQuery_a16172ad8aa9f0349137366e4f4f4a542.html#a16172ad8aa9f0349137366e4f4f4a542">01151</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a16172ad8aa9f0349137366e4f4f4a542.html#a16172ad8aa9f0349137366e4f4f4a542">havingIsNotNull</a>($field) {
<a name="l01152"></a>01152     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;isNotNull($field);
<a name="l01153"></a>01153     <span class="keywordflow">return</span> $this;
<a name="l01154"></a>01154   }
<a name="l01155"></a>01155 
<a name="l01156"></a><a class="code" href="classSelectQuery_aa85f5a83e1a047b663657299d51a86ec.html#aa85f5a83e1a047b663657299d51a86ec">01156</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_aa85f5a83e1a047b663657299d51a86ec.html#aa85f5a83e1a047b663657299d51a86ec">havingExists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l01157"></a>01157     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;exists($select);
<a name="l01158"></a>01158     <span class="keywordflow">return</span> $this;
<a name="l01159"></a>01159   }
<a name="l01160"></a>01160 
<a name="l01161"></a><a class="code" href="classSelectQuery_a5753ab708f923d4e02f808c604e89e9f.html#a5753ab708f923d4e02f808c604e89e9f">01161</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a5753ab708f923d4e02f808c604e89e9f.html#a5753ab708f923d4e02f808c604e89e9f">havingNotExists</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $select) {
<a name="l01162"></a>01162     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>-&gt;notExists($select);
<a name="l01163"></a>01163     <span class="keywordflow">return</span> $this;
<a name="l01164"></a>01164   }
<a name="l01165"></a>01165 
<a name="l01166"></a><a class="code" href="classSelectQuery_a44a1776379e738445712e196957e02b4.html#a44a1776379e738445712e196957e02b4">01166</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a44a1776379e738445712e196957e02b4.html#a44a1776379e738445712e196957e02b4" title="Add FOR UPDATE to the query.">forUpdate</a>($set = TRUE) {
<a name="l01167"></a>01167     <span class="keywordflow">if</span> (isset($set)) {
<a name="l01168"></a>01168       $this-&gt;<a class="code" href="classSelectQuery_a44a1776379e738445712e196957e02b4.html#a44a1776379e738445712e196957e02b4" title="Add FOR UPDATE to the query.">forUpdate</a> = $set;
<a name="l01169"></a>01169     }
<a name="l01170"></a>01170     <span class="keywordflow">return</span> $this;
<a name="l01171"></a>01171   }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173   <span class="comment">/* Alter accessors to expose the query data to alter hooks. */</span>
<a name="l01174"></a>01174 
<a name="l01175"></a><a class="code" href="classSelectQuery_aa9b27e2c4eb533ba25af4ca37ca3554f.html#aa9b27e2c4eb533ba25af4ca37ca3554f">01175</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_aa9b27e2c4eb533ba25af4ca37ca3554f.html#aa9b27e2c4eb533ba25af4ca37ca3554f" title="Returns a reference to the fields array for this query.">getFields</a>() {
<a name="l01176"></a>01176     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a>;
<a name="l01177"></a>01177   }
<a name="l01178"></a>01178 
<a name="l01179"></a><a class="code" href="classSelectQuery_a179b46ba9871979ab9aeb1c5f1735e89.html#a179b46ba9871979ab9aeb1c5f1735e89">01179</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_a179b46ba9871979ab9aeb1c5f1735e89.html#a179b46ba9871979ab9aeb1c5f1735e89" title="Returns a reference to the expressions array for this query.">getExpressions</a>() {
<a name="l01180"></a>01180     <span class="keywordflow">return</span> $this-&gt;expressions;
<a name="l01181"></a>01181   }
<a name="l01182"></a>01182 
<a name="l01183"></a><a class="code" href="classSelectQuery_ae8b6b2087ed35d84111bd38e5309ccf6.html#ae8b6b2087ed35d84111bd38e5309ccf6">01183</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_ae8b6b2087ed35d84111bd38e5309ccf6.html#ae8b6b2087ed35d84111bd38e5309ccf6" title="Returns a reference to the order by array for this query.">getOrderBy</a>() {
<a name="l01184"></a>01184     <span class="keywordflow">return</span> $this-&gt;order;
<a name="l01185"></a>01185   }
<a name="l01186"></a>01186 
<a name="l01187"></a><a class="code" href="classSelectQuery_ace0f2e44a175344b8d8c760d70b48596.html#ace0f2e44a175344b8d8c760d70b48596">01187</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_ace0f2e44a175344b8d8c760d70b48596.html#ace0f2e44a175344b8d8c760d70b48596" title="Returns a reference to the group-by array for this query.">getGroupBy</a>() {
<a name="l01188"></a>01188     <span class="keywordflow">return</span> $this-&gt;group;
<a name="l01189"></a>01189   }
<a name="l01190"></a>01190 
<a name="l01191"></a><a class="code" href="classSelectQuery_a42ce5a7a4a01a341231b005f32811ee6.html#a42ce5a7a4a01a341231b005f32811ee6">01191</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_a42ce5a7a4a01a341231b005f32811ee6.html#a42ce5a7a4a01a341231b005f32811ee6" title="Returns a reference to the tables array for this query.">getTables</a>() {
<a name="l01192"></a>01192     <span class="keywordflow">return</span> $this-&gt;tables;
<a name="l01193"></a>01193   }
<a name="l01194"></a>01194 
<a name="l01195"></a><a class="code" href="classSelectQuery_a340167ba07c99ab15c39c632f73d1d3b.html#a340167ba07c99ab15c39c632f73d1d3b">01195</a>   <span class="keyword">public</span> <span class="keyword">function</span> &amp;<a class="code" href="classSelectQuery_a340167ba07c99ab15c39c632f73d1d3b.html#a340167ba07c99ab15c39c632f73d1d3b" title="Returns a reference to the union queries for this query.">getUnion</a>() {
<a name="l01196"></a>01196     <span class="keywordflow">return</span> $this-&gt;<span class="keyword">union</span>;
<a name="l01197"></a>01197   }
<a name="l01198"></a>01198 
<a name="l01199"></a><a class="code" href="classSelectQuery_a178ae347a7c736ac39fb5a25fb8b3783.html#a178ae347a7c736ac39fb5a25fb8b3783">01199</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a178ae347a7c736ac39fb5a25fb8b3783.html#a178ae347a7c736ac39fb5a25fb8b3783" title="Compiles and returns an associative array of the arguments for this prepared statement.">getArguments</a>(<a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> $queryPlaceholder = NULL) {
<a name="l01200"></a>01200     <span class="keywordflow">if</span> (!isset($queryPlaceholder)) {
<a name="l01201"></a>01201       $queryPlaceholder = $this;
<a name="l01202"></a>01202     }
<a name="l01203"></a>01203     $this-&gt;<a class="code" href="classSelectQuery_ad858d64a89ca6b8d60f135470d40319f.html#ad858d64a89ca6b8d60f135470d40319f" title="Compiles the saved conditions for later retrieval.">compile</a>($this-&gt;connection, $queryPlaceholder);
<a name="l01204"></a>01204     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ada38099d692203d261f6a6b708a9635c.html#ada38099d692203d261f6a6b708a9635c" title="Gets a complete list of all values to insert into the prepared statement.">arguments</a>();
<a name="l01205"></a>01205   }
<a name="l01206"></a>01206 
<a name="l01210"></a><a class="code" href="classSelectQuery_a12d7cb534e4178f404286468f4ad3321.html#a12d7cb534e4178f404286468f4ad3321">01210</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a12d7cb534e4178f404286468f4ad3321.html#a12d7cb534e4178f404286468f4ad3321" title="Indicates if preExecute() has already been called on that object.">isPrepared</a>() {
<a name="l01211"></a>01211     <span class="keywordflow">return</span> $this-&gt;prepared;
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213 
<a name="l01220"></a><a class="code" href="classSelectQuery_a2b848ae6bd4c4e2059247a03b7ab6375.html#a2b848ae6bd4c4e2059247a03b7ab6375">01220</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a2b848ae6bd4c4e2059247a03b7ab6375.html#a2b848ae6bd4c4e2059247a03b7ab6375" title="Generic preparation and validation for a SELECT query.">preExecute</a>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $query = NULL) {
<a name="l01221"></a>01221     <span class="comment">// If no query object is passed in, use $this.</span>
<a name="l01222"></a>01222     <span class="keywordflow">if</span> (!isset($query)) {
<a name="l01223"></a>01223       $query = $this;
<a name="l01224"></a>01224     }
<a name="l01225"></a>01225 
<a name="l01226"></a>01226     <span class="comment">// Only execute this once.</span>
<a name="l01227"></a>01227     <span class="keywordflow">if</span> ($query-&gt;isPrepared()) {
<a name="l01228"></a>01228       <span class="keywordflow">return</span> TRUE;
<a name="l01229"></a>01229     }
<a name="l01230"></a>01230 
<a name="l01231"></a>01231     <span class="comment">// Modules may alter all queries or only those having a particular tag.</span>
<a name="l01232"></a>01232     <span class="keywordflow">if</span> (isset($this-&gt;alterTags)) {
<a name="l01233"></a>01233       $hooks = array(<span class="stringliteral">&#39;query&#39;</span>);
<a name="l01234"></a>01234       <span class="keywordflow">foreach</span> ($this-&gt;alterTags as $tag =&gt; $value) {
<a name="l01235"></a>01235         $hooks[] = <span class="stringliteral">&#39;query_&#39;</span> . $tag;
<a name="l01236"></a>01236       }
<a name="l01237"></a>01237       <a class="code" href="module_8inc_a9badfa1d68b90764aa160aee0e58b4ef.html#a9badfa1d68b90764aa160aee0e58b4ef" title="Hands off alterable variables to type-specific *_alter implementations.">drupal_alter</a>($hooks, $query);
<a name="l01238"></a>01238     }
<a name="l01239"></a>01239 
<a name="l01240"></a>01240     $this-&gt;prepared = TRUE;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242     <span class="comment">// Now also prepare any sub-queries.</span>
<a name="l01243"></a>01243     <span class="keywordflow">foreach</span> ($this-&gt;tables as $table) {
<a name="l01244"></a>01244       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;table&#39;</span>] instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01245"></a>01245         $table[<span class="stringliteral">&#39;table&#39;</span>]-&gt;preExecute();
<a name="l01246"></a>01246       }
<a name="l01247"></a>01247     }
<a name="l01248"></a>01248 
<a name="l01249"></a>01249     <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a>) {
<a name="l01250"></a>01250       $union[<span class="stringliteral">&#39;query&#39;</span>]-&gt;preExecute();
<a name="l01251"></a>01251     }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253     <span class="keywordflow">return</span> $this-&gt;prepared;
<a name="l01254"></a>01254   }
<a name="l01255"></a>01255 
<a name="l01256"></a><a class="code" href="classSelectQuery_a06e4212057c140773970e3c34b0b696d.html#a06e4212057c140773970e3c34b0b696d">01256</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a06e4212057c140773970e3c34b0b696d.html#a06e4212057c140773970e3c34b0b696d" title="Runs the query against the database.">execute</a>() {
<a name="l01257"></a>01257     <span class="comment">// If validation fails, simply return NULL.</span>
<a name="l01258"></a>01258     <span class="comment">// Note that validation routines in preExecute() may throw exceptions instead.</span>
<a name="l01259"></a>01259     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classSelectQuery_a2b848ae6bd4c4e2059247a03b7ab6375.html#a2b848ae6bd4c4e2059247a03b7ab6375" title="Generic preparation and validation for a SELECT query.">preExecute</a>()) {
<a name="l01260"></a>01260       <span class="keywordflow">return</span> NULL;
<a name="l01261"></a>01261     }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263     $args = $this-&gt;<a class="code" href="classSelectQuery_a178ae347a7c736ac39fb5a25fb8b3783.html#a178ae347a7c736ac39fb5a25fb8b3783" title="Compiles and returns an associative array of the arguments for this prepared statement.">getArguments</a>();
<a name="l01264"></a>01264     <span class="keywordflow">return</span> $this-&gt;connection-&gt;query((<span class="keywordtype">string</span>) $this, $args, $this-&gt;queryOptions);
<a name="l01265"></a>01265   }
<a name="l01266"></a>01266 
<a name="l01267"></a><a class="code" href="classSelectQuery_a9d76d503d9769768f5d20cf1793c670b.html#a9d76d503d9769768f5d20cf1793c670b">01267</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a9d76d503d9769768f5d20cf1793c670b.html#a9d76d503d9769768f5d20cf1793c670b" title="Sets this query to be DISTINCT.">distinct</a>(<a class="code" href="classSelectQuery_a06f4f274e48265a9cd4cb4746ca570df.html#a06f4f274e48265a9cd4cb4746ca570df">$distinct</a> = TRUE) {
<a name="l01268"></a>01268     $this-&gt;<a class="code" href="classSelectQuery_a9d76d503d9769768f5d20cf1793c670b.html#a9d76d503d9769768f5d20cf1793c670b" title="Sets this query to be DISTINCT.">distinct</a> = <a class="code" href="classSelectQuery_a06f4f274e48265a9cd4cb4746ca570df.html#a06f4f274e48265a9cd4cb4746ca570df">$distinct</a>;
<a name="l01269"></a>01269     <span class="keywordflow">return</span> $this;
<a name="l01270"></a>01270   }
<a name="l01271"></a>01271 
<a name="l01272"></a><a class="code" href="classSelectQuery_a8f5cef012b0f3111a5e6b8bcc47bacea.html#a8f5cef012b0f3111a5e6b8bcc47bacea">01272</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a8f5cef012b0f3111a5e6b8bcc47bacea.html#a8f5cef012b0f3111a5e6b8bcc47bacea" title="Adds a field to the list to be SELECTed.">addField</a>($table_alias, $field, $alias = NULL) {
<a name="l01273"></a>01273     <span class="comment">// If no alias is specified, first try the field name itself.</span>
<a name="l01274"></a>01274     <span class="keywordflow">if</span> (empty($alias)) {
<a name="l01275"></a>01275       $alias = $field;
<a name="l01276"></a>01276     }
<a name="l01277"></a>01277 
<a name="l01278"></a>01278     <span class="comment">// If that&#39;s already in use, try the table name and field name.</span>
<a name="l01279"></a>01279     <span class="keywordflow">if</span> (!empty($this-&gt;<a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a>[$alias])) {
<a name="l01280"></a>01280       $alias = $table_alias . <span class="charliteral">&#39;_&#39;</span> . $field;
<a name="l01281"></a>01281     }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283     <span class="comment">// If that is already used, just add a counter until we find an unused alias.</span>
<a name="l01284"></a>01284     $alias_candidate = $alias;
<a name="l01285"></a>01285     $count = 2;
<a name="l01286"></a>01286     <span class="keywordflow">while</span> (!empty($this-&gt;<a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a>[$alias_candidate])) {
<a name="l01287"></a>01287       $alias_candidate = $alias . <span class="charliteral">&#39;_&#39;</span> . $count++;
<a name="l01288"></a>01288     }
<a name="l01289"></a>01289     $alias = $alias_candidate;
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     $this-&gt;<a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a>[$alias] = array(
<a name="l01292"></a>01292       <span class="stringliteral">&#39;field&#39;</span> =&gt; $field,
<a name="l01293"></a>01293       <span class="stringliteral">&#39;table&#39;</span> =&gt; $table_alias,
<a name="l01294"></a>01294       <span class="stringliteral">&#39;alias&#39;</span> =&gt; $alias,
<a name="l01295"></a>01295     );
<a name="l01296"></a>01296 
<a name="l01297"></a>01297     <span class="keywordflow">return</span> $alias;
<a name="l01298"></a>01298   }
<a name="l01299"></a>01299 
<a name="l01300"></a><a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699">01300</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a>($table_alias, array <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> = array()) {
<a name="l01301"></a>01301 
<a name="l01302"></a>01302     <span class="keywordflow">if</span> (<a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>) {
<a name="l01303"></a>01303       <span class="keywordflow">foreach</span> (<a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> as $field) {
<a name="l01304"></a>01304         <span class="comment">// We don&#39;t care what alias was assigned.</span>
<a name="l01305"></a>01305         $this-&gt;<a class="code" href="classSelectQuery_a8f5cef012b0f3111a5e6b8bcc47bacea.html#a8f5cef012b0f3111a5e6b8bcc47bacea" title="Adds a field to the list to be SELECTed.">addField</a>($table_alias, $field);
<a name="l01306"></a>01306       }
<a name="l01307"></a>01307     }
<a name="l01308"></a>01308     <span class="keywordflow">else</span> {
<a name="l01309"></a>01309       <span class="comment">// We want all fields from this table.</span>
<a name="l01310"></a>01310       $this-&gt;tables[$table_alias][<span class="stringliteral">&#39;all_fields&#39;</span>] = TRUE;
<a name="l01311"></a>01311     }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313     <span class="keywordflow">return</span> $this;
<a name="l01314"></a>01314   }
<a name="l01315"></a>01315 
<a name="l01316"></a><a class="code" href="classSelectQuery_a8d99c03f6dea06e698640cf77c0a1d21.html#a8d99c03f6dea06e698640cf77c0a1d21">01316</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a8d99c03f6dea06e698640cf77c0a1d21.html#a8d99c03f6dea06e698640cf77c0a1d21" title="Adds an expression to the list of &quot;fields&quot; to be SELECTed.">addExpression</a>($expression, $alias = NULL, $arguments = array()) {
<a name="l01317"></a>01317     <span class="keywordflow">if</span> (empty($alias)) {
<a name="l01318"></a>01318       $alias = <span class="stringliteral">&#39;expression&#39;</span>;
<a name="l01319"></a>01319     }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321     $alias_candidate = $alias;
<a name="l01322"></a>01322     $count = 2;
<a name="l01323"></a>01323     <span class="keywordflow">while</span> (!empty($this-&gt;expressions[$alias_candidate])) {
<a name="l01324"></a>01324       $alias_candidate = $alias . <span class="charliteral">&#39;_&#39;</span> . $count++;
<a name="l01325"></a>01325     }
<a name="l01326"></a>01326     $alias = $alias_candidate;
<a name="l01327"></a>01327 
<a name="l01328"></a>01328     $this-&gt;expressions[$alias] = array(
<a name="l01329"></a>01329       <span class="stringliteral">&#39;expression&#39;</span> =&gt; $expression,
<a name="l01330"></a>01330       <span class="stringliteral">&#39;alias&#39;</span> =&gt; $alias,
<a name="l01331"></a>01331       <span class="stringliteral">&#39;arguments&#39;</span> =&gt; $arguments,
<a name="l01332"></a>01332     );
<a name="l01333"></a>01333 
<a name="l01334"></a>01334     <span class="keywordflow">return</span> $alias;
<a name="l01335"></a>01335   }
<a name="l01336"></a>01336 
<a name="l01337"></a><a class="code" href="classSelectQuery_aceff7fc4040a74f693f2fc2548a99c17.html#aceff7fc4040a74f693f2fc2548a99c17">01337</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_aceff7fc4040a74f693f2fc2548a99c17.html#aceff7fc4040a74f693f2fc2548a99c17" title="Default Join against another table in the database.">join</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l01338"></a>01338     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>(<span class="stringliteral">&#39;INNER&#39;</span>, $table, $alias, $condition, $arguments);
<a name="l01339"></a>01339   }
<a name="l01340"></a>01340 
<a name="l01341"></a><a class="code" href="classSelectQuery_a2e3bad44c2eca1e74130622a93fdc394.html#a2e3bad44c2eca1e74130622a93fdc394">01341</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a2e3bad44c2eca1e74130622a93fdc394.html#a2e3bad44c2eca1e74130622a93fdc394" title="Inner Join against another table in the database.">innerJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l01342"></a>01342     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>(<span class="stringliteral">&#39;INNER&#39;</span>, $table, $alias, $condition, $arguments);
<a name="l01343"></a>01343   }
<a name="l01344"></a>01344 
<a name="l01345"></a><a class="code" href="classSelectQuery_ab542a3bf62cfab85c8a4e0c3ac093d11.html#ab542a3bf62cfab85c8a4e0c3ac093d11">01345</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ab542a3bf62cfab85c8a4e0c3ac093d11.html#ab542a3bf62cfab85c8a4e0c3ac093d11" title="Left Outer Join against another table in the database.">leftJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l01346"></a>01346     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>(<span class="stringliteral">&#39;LEFT OUTER&#39;</span>, $table, $alias, $condition, $arguments);
<a name="l01347"></a>01347   }
<a name="l01348"></a>01348 
<a name="l01349"></a><a class="code" href="classSelectQuery_a0b3a40164be944401296be9e9ab1c23c.html#a0b3a40164be944401296be9e9ab1c23c">01349</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a0b3a40164be944401296be9e9ab1c23c.html#a0b3a40164be944401296be9e9ab1c23c" title="Right Outer Join against another table in the database.">rightJoin</a>($table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l01350"></a>01350     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>(<span class="stringliteral">&#39;RIGHT OUTER&#39;</span>, $table, $alias, $condition, $arguments);
<a name="l01351"></a>01351   }
<a name="l01352"></a>01352 
<a name="l01353"></a><a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2">01353</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ad4a44826400c0a880129e009cbdea2d2.html#ad4a44826400c0a880129e009cbdea2d2" title="Join against another table in the database.">addJoin</a>($type, $table, $alias = NULL, $condition = NULL, $arguments = array()) {
<a name="l01354"></a>01354 
<a name="l01355"></a>01355     <span class="keywordflow">if</span> (empty($alias)) {
<a name="l01356"></a>01356       <span class="keywordflow">if</span> ($table instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01357"></a>01357         $alias = <span class="stringliteral">&#39;subquery&#39;</span>;
<a name="l01358"></a>01358       }
<a name="l01359"></a>01359       <span class="keywordflow">else</span> {
<a name="l01360"></a>01360         $alias = $table;
<a name="l01361"></a>01361       }
<a name="l01362"></a>01362     }
<a name="l01363"></a>01363 
<a name="l01364"></a>01364     $alias_candidate = $alias;
<a name="l01365"></a>01365     $count = 2;
<a name="l01366"></a>01366     <span class="keywordflow">while</span> (!empty($this-&gt;tables[$alias_candidate])) {
<a name="l01367"></a>01367       $alias_candidate = $alias . <span class="charliteral">&#39;_&#39;</span> . $count++;
<a name="l01368"></a>01368     }
<a name="l01369"></a>01369     $alias = $alias_candidate;
<a name="l01370"></a>01370 
<a name="l01371"></a>01371     <span class="keywordflow">if</span> (is_string($condition)) {
<a name="l01372"></a>01372       $condition = str_replace(<span class="stringliteral">&#39;%alias&#39;</span>, $alias, $condition);
<a name="l01373"></a>01373     }
<a name="l01374"></a>01374 
<a name="l01375"></a>01375     $this-&gt;tables[$alias] = array(
<a name="l01376"></a>01376       <span class="stringliteral">&#39;join type&#39;</span> =&gt; $type,
<a name="l01377"></a>01377       <span class="stringliteral">&#39;table&#39;</span> =&gt; $table,
<a name="l01378"></a>01378       <span class="stringliteral">&#39;alias&#39;</span> =&gt; $alias,
<a name="l01379"></a>01379       <span class="stringliteral">&#39;condition&#39;</span> =&gt; $condition,
<a name="l01380"></a>01380       <span class="stringliteral">&#39;arguments&#39;</span> =&gt; $arguments,
<a name="l01381"></a>01381     );
<a name="l01382"></a>01382 
<a name="l01383"></a>01383     <span class="keywordflow">return</span> $alias;
<a name="l01384"></a>01384   }
<a name="l01385"></a>01385 
<a name="l01386"></a><a class="code" href="classSelectQuery_a32ede93f2abfd7f8bc388d0c00512fae.html#a32ede93f2abfd7f8bc388d0c00512fae">01386</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a32ede93f2abfd7f8bc388d0c00512fae.html#a32ede93f2abfd7f8bc388d0c00512fae" title="Orders the result set by a given field.">orderBy</a>($field, $direction = <span class="stringliteral">&#39;ASC&#39;</span>) {
<a name="l01387"></a>01387     $this-&gt;order[$field] = $direction;
<a name="l01388"></a>01388     <span class="keywordflow">return</span> $this;
<a name="l01389"></a>01389   }
<a name="l01390"></a>01390 
<a name="l01391"></a><a class="code" href="classSelectQuery_af284bacf9e56ccf177d17f4b4bc84b03.html#af284bacf9e56ccf177d17f4b4bc84b03">01391</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_af284bacf9e56ccf177d17f4b4bc84b03.html#af284bacf9e56ccf177d17f4b4bc84b03" title="Orders the result set by a random value.">orderRandom</a>() {
<a name="l01392"></a>01392     $alias = $this-&gt;<a class="code" href="classSelectQuery_a8d99c03f6dea06e698640cf77c0a1d21.html#a8d99c03f6dea06e698640cf77c0a1d21" title="Adds an expression to the list of &quot;fields&quot; to be SELECTed.">addExpression</a>(<span class="stringliteral">&#39;RAND()&#39;</span>, <span class="stringliteral">&#39;random_field&#39;</span>);
<a name="l01393"></a>01393     $this-&gt;<a class="code" href="classSelectQuery_a32ede93f2abfd7f8bc388d0c00512fae.html#a32ede93f2abfd7f8bc388d0c00512fae" title="Orders the result set by a given field.">orderBy</a>($alias);
<a name="l01394"></a>01394     <span class="keywordflow">return</span> $this;
<a name="l01395"></a>01395   }
<a name="l01396"></a>01396 
<a name="l01397"></a><a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236">01397</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236" title="Restricts a query to a given range in the result set.">range</a>($start = NULL, $length = NULL) {
<a name="l01398"></a>01398     $this-&gt;<a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236" title="Restricts a query to a given range in the result set.">range</a> = func_num_args() ? array(<span class="stringliteral">&#39;start&#39;</span> =&gt; $start, <span class="stringliteral">&#39;length&#39;</span> =&gt; $length) : array();
<a name="l01399"></a>01399     <span class="keywordflow">return</span> $this;
<a name="l01400"></a>01400   }
<a name="l01401"></a>01401 
<a name="l01402"></a><a class="code" href="classSelectQuery_a50ad7154a213894e740adcbafe333d08.html#a50ad7154a213894e740adcbafe333d08">01402</a>   <span class="keyword">public</span> <span class="keyword">function</span> <span class="keyword">union</span>(<a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a> $query, $type = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01403"></a>01403     <span class="comment">// Handle UNION aliasing.</span>
<a name="l01404"></a>01404     <span class="keywordflow">switch</span> ($type) {
<a name="l01405"></a>01405       <span class="comment">// Fold UNION DISTINCT to UNION for better cross database support.</span>
<a name="l01406"></a>01406       <span class="keywordflow">case</span> <span class="stringliteral">&#39;DISTINCT&#39;</span>:
<a name="l01407"></a>01407       <span class="keywordflow">case</span> <span class="stringliteral">&#39;&#39;</span>:
<a name="l01408"></a>01408         $type = <span class="stringliteral">&#39;UNION&#39;</span>;
<a name="l01409"></a>01409         <span class="keywordflow">break</span>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411       <span class="keywordflow">case</span> <span class="stringliteral">&#39;ALL&#39;</span>:
<a name="l01412"></a>01412         $type = <span class="stringliteral">&#39;UNION ALL&#39;</span>;
<a name="l01413"></a>01413       <span class="keywordflow">default</span>:
<a name="l01414"></a>01414     }
<a name="l01415"></a>01415 
<a name="l01416"></a>01416     $this-&gt;<span class="keyword">union</span>[] = array(
<a name="l01417"></a>01417       <span class="stringliteral">&#39;type&#39;</span> =&gt; $type,
<a name="l01418"></a>01418       <span class="stringliteral">&#39;query&#39;</span> =&gt; $query,
<a name="l01419"></a>01419     );
<a name="l01420"></a>01420 
<a name="l01421"></a>01421     <span class="keywordflow">return</span> $this;
<a name="l01422"></a>01422   }
<a name="l01423"></a>01423 
<a name="l01424"></a><a class="code" href="classSelectQuery_aadcd66d052ac3e3f1fc2eb1490cdade7.html#aadcd66d052ac3e3f1fc2eb1490cdade7">01424</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_aadcd66d052ac3e3f1fc2eb1490cdade7.html#aadcd66d052ac3e3f1fc2eb1490cdade7" title="Groups the result set by the specified field.">groupBy</a>($field) {
<a name="l01425"></a>01425     $this-&gt;group[$field] = $field;
<a name="l01426"></a>01426     <span class="keywordflow">return</span> $this;
<a name="l01427"></a>01427   }
<a name="l01428"></a>01428 
<a name="l01429"></a><a class="code" href="classSelectQuery_a7d2e665bede18c709f677033e04db55e.html#a7d2e665bede18c709f677033e04db55e">01429</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a7d2e665bede18c709f677033e04db55e.html#a7d2e665bede18c709f677033e04db55e" title="Get the equivalent COUNT query of this query as a new query object.">countQuery</a>() {
<a name="l01430"></a>01430     <span class="comment">// Create our new query object that we will mutate into a count query.</span>
<a name="l01431"></a>01431     $count = clone($this);
<a name="l01432"></a>01432 
<a name="l01433"></a>01433     $group_by = $count-&gt;getGroupBy();
<a name="l01434"></a>01434     <a class="code" href="classSelectQuery_afbc6814498bc1a7de2837f904ccf1685.html#afbc6814498bc1a7de2837f904ccf1685">$having</a> = $count-&gt;havingConditions();
<a name="l01435"></a>01435 
<a name="l01436"></a>01436     <span class="keywordflow">if</span> (!$count-&gt;distinct &amp;&amp; !isset(<a class="code" href="classSelectQuery_afbc6814498bc1a7de2837f904ccf1685.html#afbc6814498bc1a7de2837f904ccf1685">$having</a>[0])) {
<a name="l01437"></a>01437       <span class="comment">// When not executing a distinct query, we can zero-out existing fields</span>
<a name="l01438"></a>01438       <span class="comment">// and expressions that are not used by a GROUP BY or HAVING. Fields</span>
<a name="l01439"></a>01439       <span class="comment">// listed in a GROUP BY or HAVING clause need to be present in the</span>
<a name="l01440"></a>01440       <span class="comment">// query.</span>
<a name="l01441"></a>01441       <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> =&amp; $count-&gt;getFields();
<a name="l01442"></a>01442       <span class="keywordflow">foreach</span> (array_keys(<a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>) as $field) {
<a name="l01443"></a>01443         <span class="keywordflow">if</span> (empty($group_by[$field])) {
<a name="l01444"></a>01444           unset(<a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>[$field]);
<a name="l01445"></a>01445         }
<a name="l01446"></a>01446       }
<a name="l01447"></a>01447 
<a name="l01448"></a>01448       <a class="code" href="classSelectQuery_ab763e3db3e95a5d2fbea64544b630eac.html#ab763e3db3e95a5d2fbea64544b630eac">$expressions</a> =&amp; $count-&gt;getExpressions();
<a name="l01449"></a>01449       <span class="keywordflow">foreach</span> (array_keys(<a class="code" href="classSelectQuery_ab763e3db3e95a5d2fbea64544b630eac.html#ab763e3db3e95a5d2fbea64544b630eac">$expressions</a>) as $field) {
<a name="l01450"></a>01450         <span class="keywordflow">if</span> (empty($group_by[$field])) {
<a name="l01451"></a>01451           unset(<a class="code" href="classSelectQuery_ab763e3db3e95a5d2fbea64544b630eac.html#ab763e3db3e95a5d2fbea64544b630eac">$expressions</a>[$field]);
<a name="l01452"></a>01452         }
<a name="l01453"></a>01453       }
<a name="l01454"></a>01454 
<a name="l01455"></a>01455       <span class="comment">// Also remove &#39;all_fields&#39; statements, which are expanded into tablename.*</span>
<a name="l01456"></a>01456       <span class="comment">// when the query is executed.</span>
<a name="l01457"></a>01457       <span class="keywordflow">foreach</span> ($count-&gt;tables as $alias =&gt; &amp;$table) {
<a name="l01458"></a>01458         unset($table[<span class="stringliteral">&#39;all_fields&#39;</span>]);
<a name="l01459"></a>01459       }
<a name="l01460"></a>01460     }
<a name="l01461"></a>01461 
<a name="l01462"></a>01462     <span class="comment">// If we&#39;ve just removed all fields from the query, make sure there is at</span>
<a name="l01463"></a>01463     <span class="comment">// least one so that the query still runs.</span>
<a name="l01464"></a>01464     $count-&gt;addExpression(<span class="charliteral">&#39;1&#39;</span>);
<a name="l01465"></a>01465 
<a name="l01466"></a>01466     <span class="comment">// Ordering a count query is a waste of cycles, and breaks on some</span>
<a name="l01467"></a>01467     <span class="comment">// databases anyway.</span>
<a name="l01468"></a>01468     $orders = &amp;$count-&gt;getOrderBy();
<a name="l01469"></a>01469     $orders = array();
<a name="l01470"></a>01470 
<a name="l01471"></a>01471     <span class="keywordflow">if</span> ($count-&gt;distinct &amp;&amp; !empty($group_by)) {
<a name="l01472"></a>01472       <span class="comment">// If the query is distinct and contains a GROUP BY, we need to remove the</span>
<a name="l01473"></a>01473       <span class="comment">// distinct because SQL99 does not support counting on distinct multiple fields.</span>
<a name="l01474"></a>01474       $count-&gt;distinct = FALSE;
<a name="l01475"></a>01475     }
<a name="l01476"></a>01476 
<a name="l01477"></a>01477     $query = $this-&gt;connection-&gt;select($count);
<a name="l01478"></a>01478     $query-&gt;addExpression(<span class="stringliteral">&#39;COUNT(*)&#39;</span>);
<a name="l01479"></a>01479 
<a name="l01480"></a>01480     <span class="keywordflow">return</span> $query;
<a name="l01481"></a>01481   }
<a name="l01482"></a>01482 
<a name="l01483"></a><a class="code" href="classSelectQuery_ae5b1bbcecaf13957de15eb49584195b3.html#ae5b1bbcecaf13957de15eb49584195b3">01483</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_ae5b1bbcecaf13957de15eb49584195b3.html#ae5b1bbcecaf13957de15eb49584195b3" title="Implements PHP magic __toString method to convert the query to a string.">__toString</a>() {
<a name="l01484"></a>01484     <span class="comment">// For convenience, we compile the query ourselves if the caller forgot</span>
<a name="l01485"></a>01485     <span class="comment">// to do it. This allows constructs like &quot;(string) $query&quot; to work. When</span>
<a name="l01486"></a>01486     <span class="comment">// the query will be executed, it will be recompiled using the proper</span>
<a name="l01487"></a>01487     <span class="comment">// placeholder generator anyway.</span>
<a name="l01488"></a>01488     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classSelectQuery_adc1283f0d5b5f20ed7a69bf8bee7e935.html#adc1283f0d5b5f20ed7a69bf8bee7e935" title="Check whether a condition has been previously compiled.">compiled</a>()) {
<a name="l01489"></a>01489       $this-&gt;<a class="code" href="classSelectQuery_ad858d64a89ca6b8d60f135470d40319f.html#ad858d64a89ca6b8d60f135470d40319f" title="Compiles the saved conditions for later retrieval.">compile</a>($this-&gt;connection, $this);
<a name="l01490"></a>01490     }
<a name="l01491"></a>01491 
<a name="l01492"></a>01492     <span class="comment">// Create a sanitized comment string to prepend to the query.</span>
<a name="l01493"></a>01493     <a class="code" href="classQuery_ab545c0037b0e730712d965cd95f51d2e.html#ab545c0037b0e730712d965cd95f51d2e">$comments</a> = $this-&gt;connection-&gt;makeComment($this-&gt;comments);
<a name="l01494"></a>01494 
<a name="l01495"></a>01495     <span class="comment">// SELECT</span>
<a name="l01496"></a>01496     $query = <a class="code" href="classQuery_ab545c0037b0e730712d965cd95f51d2e.html#ab545c0037b0e730712d965cd95f51d2e">$comments</a> . <span class="stringliteral">&#39;SELECT &#39;</span>;
<a name="l01497"></a>01497     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classSelectQuery_a9d76d503d9769768f5d20cf1793c670b.html#a9d76d503d9769768f5d20cf1793c670b" title="Sets this query to be DISTINCT.">distinct</a>) {
<a name="l01498"></a>01498       $query .= <span class="stringliteral">&#39;DISTINCT &#39;</span>;
<a name="l01499"></a>01499     }
<a name="l01500"></a>01500 
<a name="l01501"></a>01501     <span class="comment">// FIELDS and EXPRESSIONS</span>
<a name="l01502"></a>01502     <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> = array();
<a name="l01503"></a>01503     <span class="keywordflow">foreach</span> ($this-&gt;tables as $alias =&gt; $table) {
<a name="l01504"></a>01504       <span class="keywordflow">if</span> (!empty($table[<span class="stringliteral">&#39;all_fields&#39;</span>])) {
<a name="l01505"></a>01505         <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>[] = $this-&gt;connection-&gt;escapeTable($alias) . <span class="stringliteral">&#39;.*&#39;</span>;
<a name="l01506"></a>01506       }
<a name="l01507"></a>01507     }
<a name="l01508"></a>01508     <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classSelectQuery_ab240a4ee46566adaff68b364c7c60699.html#ab240a4ee46566adaff68b364c7c60699" title="Add multiple fields from the same table to be SELECTed.">fields</a> as $alias =&gt; $field) {
<a name="l01509"></a>01509       <span class="comment">// Always use the AS keyword for field aliases, as some</span>
<a name="l01510"></a>01510       <span class="comment">// databases require it (e.g., PostgreSQL).</span>
<a name="l01511"></a>01511       <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>[] = (isset($field[<span class="stringliteral">&#39;table&#39;</span>]) ? $this-&gt;connection-&gt;escapeTable($field[<span class="stringliteral">&#39;table&#39;</span>]) . <span class="charliteral">&#39;.&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . $this-&gt;connection-&gt;escapeField($field[<span class="stringliteral">&#39;field&#39;</span>]) . <span class="stringliteral">&#39; AS &#39;</span> . $this-&gt;connection-&gt;escapeAlias($field[<span class="stringliteral">&#39;alias&#39;</span>]);
<a name="l01512"></a>01512     }
<a name="l01513"></a>01513     <span class="keywordflow">foreach</span> ($this-&gt;expressions as $alias =&gt; $expression) {
<a name="l01514"></a>01514       <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>[] = $expression[<span class="stringliteral">&#39;expression&#39;</span>] . <span class="stringliteral">&#39; AS &#39;</span> . $this-&gt;connection-&gt;escapeAlias($expression[<span class="stringliteral">&#39;alias&#39;</span>]);
<a name="l01515"></a>01515     }
<a name="l01516"></a>01516     $query .= implode(<span class="stringliteral">&#39;, &#39;</span>, <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>);
<a name="l01517"></a>01517 
<a name="l01518"></a>01518 
<a name="l01519"></a>01519     <span class="comment">// FROM - We presume all queries have a FROM, as any query that doesn&#39;t won&#39;t need the query builder anyway.</span>
<a name="l01520"></a>01520     $query .= <span class="stringliteral">&quot;\nFROM &quot;</span>;
<a name="l01521"></a>01521     <span class="keywordflow">foreach</span> ($this-&gt;tables as $alias =&gt; $table) {
<a name="l01522"></a>01522       $query .= <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01523"></a>01523       <span class="keywordflow">if</span> (isset($table[<span class="stringliteral">&#39;join type&#39;</span>])) {
<a name="l01524"></a>01524         $query .= $table[<span class="stringliteral">&#39;join type&#39;</span>] . <span class="stringliteral">&#39; JOIN &#39;</span>;
<a name="l01525"></a>01525       }
<a name="l01526"></a>01526 
<a name="l01527"></a>01527       <span class="comment">// If the table is a subquery, compile it and integrate it into this query.</span>
<a name="l01528"></a>01528       <span class="keywordflow">if</span> ($table[<span class="stringliteral">&#39;table&#39;</span>] instanceof <a class="code" href="interfaceSelectQueryInterface.html" title="Interface definition for a Select Query object.">SelectQueryInterface</a>) {
<a name="l01529"></a>01529         <span class="comment">// Run preparation steps on this sub-query before converting to string.</span>
<a name="l01530"></a>01530         $subquery = $table[<span class="stringliteral">&#39;table&#39;</span>];
<a name="l01531"></a>01531         $subquery-&gt;preExecute();
<a name="l01532"></a>01532         $table_string = <span class="charliteral">&#39;(&#39;</span> . (string) $subquery . <span class="charliteral">&#39;)&#39;</span>;
<a name="l01533"></a>01533       }
<a name="l01534"></a>01534       <span class="keywordflow">else</span> {
<a name="l01535"></a>01535         $table_string = <span class="charliteral">&#39;{&#39;</span> . $this-&gt;connection-&gt;escapeTable($table[<span class="stringliteral">&#39;table&#39;</span>]) . <span class="charliteral">&#39;}&#39;</span>;
<a name="l01536"></a>01536       }
<a name="l01537"></a>01537 
<a name="l01538"></a>01538       <span class="comment">// Don&#39;t use the AS keyword for table aliases, as some</span>
<a name="l01539"></a>01539       <span class="comment">// databases don&#39;t support it (e.g., Oracle).</span>
<a name="l01540"></a>01540       $query .=  $table_string . <span class="charliteral">&#39; &#39;</span> . $this-&gt;connection-&gt;escapeTable($table[<span class="stringliteral">&#39;alias&#39;</span>]);
<a name="l01541"></a>01541 
<a name="l01542"></a>01542       <span class="keywordflow">if</span> (!empty($table[<span class="stringliteral">&#39;condition&#39;</span>])) {
<a name="l01543"></a>01543         $query .= <span class="stringliteral">&#39; ON &#39;</span> . $table[<span class="stringliteral">&#39;condition&#39;</span>];
<a name="l01544"></a>01544       }
<a name="l01545"></a>01545     }
<a name="l01546"></a>01546 
<a name="l01547"></a>01547     <span class="comment">// WHERE</span>
<a name="l01548"></a>01548     <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>)) {
<a name="l01549"></a>01549       <span class="comment">// There is an implicit string cast on $this-&gt;condition.</span>
<a name="l01550"></a>01550       $query .= <span class="stringliteral">&quot;\nWHERE &quot;</span> . $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>;
<a name="l01551"></a>01551     }
<a name="l01552"></a>01552 
<a name="l01553"></a>01553     <span class="comment">// GROUP BY</span>
<a name="l01554"></a>01554     <span class="keywordflow">if</span> ($this-&gt;group) {
<a name="l01555"></a>01555       $query .= <span class="stringliteral">&quot;\nGROUP BY &quot;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, $this-&gt;group);
<a name="l01556"></a>01556     }
<a name="l01557"></a>01557 
<a name="l01558"></a>01558     <span class="comment">// HAVING</span>
<a name="l01559"></a>01559     <span class="keywordflow">if</span> (count($this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>)) {
<a name="l01560"></a>01560       <span class="comment">// There is an implicit string cast on $this-&gt;having.</span>
<a name="l01561"></a>01561       $query .= <span class="stringliteral">&quot;\nHAVING &quot;</span> . $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>;
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="comment">// ORDER BY</span>
<a name="l01565"></a>01565     <span class="keywordflow">if</span> ($this-&gt;order) {
<a name="l01566"></a>01566       $query .= <span class="stringliteral">&quot;\nORDER BY &quot;</span>;
<a name="l01567"></a>01567       <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a> = array();
<a name="l01568"></a>01568       <span class="keywordflow">foreach</span> ($this-&gt;order as $field =&gt; $direction) {
<a name="l01569"></a>01569         <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>[] = $field . <span class="charliteral">&#39; &#39;</span> . $direction;
<a name="l01570"></a>01570       }
<a name="l01571"></a>01571       $query .= implode(<span class="stringliteral">&#39;, &#39;</span>, <a class="code" href="classSelectQuery_acf123c393af607a777168473e9f4cbcc.html#acf123c393af607a777168473e9f4cbcc">$fields</a>);
<a name="l01572"></a>01572     }
<a name="l01573"></a>01573 
<a name="l01574"></a>01574     <span class="comment">// RANGE</span>
<a name="l01575"></a>01575     <span class="comment">// There is no universal SQL standard for handling range or limit clauses.</span>
<a name="l01576"></a>01576     <span class="comment">// Fortunately, all core-supported databases use the same range syntax.</span>
<a name="l01577"></a>01577     <span class="comment">// Databases that need a different syntax can override this method and</span>
<a name="l01578"></a>01578     <span class="comment">// do whatever alternate logic they need to.</span>
<a name="l01579"></a>01579     <span class="keywordflow">if</span> (!empty($this-&gt;<a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236" title="Restricts a query to a given range in the result set.">range</a>)) {
<a name="l01580"></a>01580       $query .= <span class="stringliteral">&quot;\nLIMIT &quot;</span> . (int) $this-&gt;<a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236" title="Restricts a query to a given range in the result set.">range</a>[<span class="stringliteral">&#39;length&#39;</span>] . <span class="stringliteral">&quot; OFFSET &quot;</span> . (<span class="keywordtype">int</span>) $this-&gt;<a class="code" href="classSelectQuery_a11a242cc59d1e2dee26848d5ab8de236.html#a11a242cc59d1e2dee26848d5ab8de236" title="Restricts a query to a given range in the result set.">range</a>[<span class="stringliteral">&#39;start&#39;</span>];
<a name="l01581"></a>01581     }
<a name="l01582"></a>01582 
<a name="l01583"></a>01583     <span class="comment">// UNION is a little odd, as the select queries to combine are passed into</span>
<a name="l01584"></a>01584     <span class="comment">// this query, but syntactically they all end up on the same level.</span>
<a name="l01585"></a>01585     <span class="keywordflow">if</span> ($this-&gt;<span class="keyword">union</span>) {
<a name="l01586"></a>01586       <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as <a class="code" href="classSelectQuery_a9375257c9b83ca0c166abc9ba2920b9d.html#a9375257c9b83ca0c166abc9ba2920b9d">$union</a>) {
<a name="l01587"></a>01587         $query .= <span class="charliteral">&#39; &#39;</span> . $union[<span class="stringliteral">&#39;type&#39;</span>] . <span class="charliteral">&#39; &#39;</span> . (string) $union[<span class="stringliteral">&#39;query&#39;</span>];
<a name="l01588"></a>01588       }
<a name="l01589"></a>01589     }
<a name="l01590"></a>01590 
<a name="l01591"></a>01591     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classSelectQuery_a44a1776379e738445712e196957e02b4.html#a44a1776379e738445712e196957e02b4" title="Add FOR UPDATE to the query.">forUpdate</a>) {
<a name="l01592"></a>01592       $query .= <span class="stringliteral">&#39; FOR UPDATE&#39;</span>;
<a name="l01593"></a>01593     }
<a name="l01594"></a>01594 
<a name="l01595"></a>01595     <span class="keywordflow">return</span> $query;
<a name="l01596"></a>01596   }
<a name="l01597"></a>01597 
<a name="l01598"></a><a class="code" href="classSelectQuery_a4a73a8d52451d193b53192e478a88161.html#a4a73a8d52451d193b53192e478a88161">01598</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classSelectQuery_a4a73a8d52451d193b53192e478a88161.html#a4a73a8d52451d193b53192e478a88161" title="Implements the magic __clone function.">__clone</a>() {
<a name="l01599"></a>01599     <span class="comment">// On cloning, also clone the dependent objects. However, we do not</span>
<a name="l01600"></a>01600     <span class="comment">// want to clone the database connection object as that would duplicate the</span>
<a name="l01601"></a>01601     <span class="comment">// connection itself.</span>
<a name="l01602"></a>01602 
<a name="l01603"></a>01603     $this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a> = clone($this-&gt;<a class="code" href="classSelectQuery_a9cd4e4c627c922318203fb1193784d18.html#a9cd4e4c627c922318203fb1193784d18" title="Adds an arbitrary WHERE clause to the query.">where</a>);
<a name="l01604"></a>01604     $this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a> = clone($this-&gt;<a class="code" href="classSelectQuery_ad23bf64681da19c93af98e2610d06ccc.html#ad23bf64681da19c93af98e2610d06ccc">having</a>);
<a name="l01605"></a>01605     <span class="keywordflow">foreach</span> ($this-&gt;<span class="keyword">union</span> as $key =&gt; $aggregate) {
<a name="l01606"></a>01606       $this-&gt;<span class="keyword">union</span>[$key][<span class="stringliteral">&#39;query&#39;</span>] = clone($aggregate[<span class="stringliteral">&#39;query&#39;</span>]);
<a name="l01607"></a>01607     }
<a name="l01608"></a>01608   }
<a name="l01609"></a>01609 }
<a name="l01610"></a>01610 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 22 2012 16:46:14 for Shopcart by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
