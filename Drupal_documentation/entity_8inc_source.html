<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Shopcart: includes/entity.inc Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Shopcart
   &#160;<span id="projectnumber">version2.0</span>
   </div>
   <div id="projectbrief">Shoppingcart</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_5b89693129504707d608c5412e7b88d4.html">includes</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">entity.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="entity_8inc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00014"></a><a class="code" href="interfaceDrupalEntityControllerInterface.html">00014</a> <span class="keyword">interface </span><a class="code" href="interfaceDrupalEntityControllerInterface.html" title="Interface for entity controller classes.">DrupalEntityControllerInterface</a> {
<a name="l00015"></a>00015 
<a name="l00022"></a>00022   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceDrupalEntityControllerInterface_a5ad3c228b1cc09796f4e53029a5bc498.html#a5ad3c228b1cc09796f4e53029a5bc498" title="Constructor.">__construct</a>($entityType);
<a name="l00023"></a>00023 
<a name="l00031"></a>00031   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceDrupalEntityControllerInterface_ae735484b175ff431b7b104732b7a497b.html#ae735484b175ff431b7b104732b7a497b" title="Resets the internal, static entity cache.">resetCache</a>(array $ids = NULL);
<a name="l00032"></a>00032 
<a name="l00045"></a>00045   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="interfaceDrupalEntityControllerInterface_acc6ec97b35f4d32680c0d2ba090f7389.html#acc6ec97b35f4d32680c0d2ba090f7389" title="Loads one or more entities.">load</a>($ids = array(), $conditions = array());
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00054"></a><a class="code" href="classDrupalDefaultEntityController.html">00054</a> <span class="keyword">class </span><a class="code" href="classDrupalDefaultEntityController.html" title="Default implementation of DrupalEntityControllerInterface.">DrupalDefaultEntityController</a> <span class="keyword">implements</span> <a class="code" href="interfaceDrupalEntityControllerInterface.html" title="Interface for entity controller classes.">DrupalEntityControllerInterface</a> {
<a name="l00055"></a>00055 
<a name="l00061"></a><a class="code" href="classDrupalDefaultEntityController_acbb2e6a6999ded7c291e1cf86e254176.html#acbb2e6a6999ded7c291e1cf86e254176">00061</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_acbb2e6a6999ded7c291e1cf86e254176.html#acbb2e6a6999ded7c291e1cf86e254176">$entityCache</a>;
<a name="l00062"></a>00062 
<a name="l00068"></a><a class="code" href="classDrupalDefaultEntityController_a952f2440f72af738dddba02ee28e9b13.html#a952f2440f72af738dddba02ee28e9b13">00068</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a952f2440f72af738dddba02ee28e9b13.html#a952f2440f72af738dddba02ee28e9b13">$entityType</a>;
<a name="l00069"></a>00069 
<a name="l00077"></a><a class="code" href="classDrupalDefaultEntityController_a6cd0f67d5c1da3b239fa0649becf4e91.html#a6cd0f67d5c1da3b239fa0649becf4e91">00077</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a6cd0f67d5c1da3b239fa0649becf4e91.html#a6cd0f67d5c1da3b239fa0649becf4e91">$entityInfo</a>;
<a name="l00078"></a>00078 
<a name="l00086"></a><a class="code" href="classDrupalDefaultEntityController_a60f93fd1bc54bd165da93470cad902cb.html#a60f93fd1bc54bd165da93470cad902cb">00086</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a60f93fd1bc54bd165da93470cad902cb.html#a60f93fd1bc54bd165da93470cad902cb">$hookLoadArguments</a>;
<a name="l00087"></a>00087 
<a name="l00093"></a><a class="code" href="classDrupalDefaultEntityController_a8cd76449f510d31ea480b79c05b04354.html#a8cd76449f510d31ea480b79c05b04354">00093</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a8cd76449f510d31ea480b79c05b04354.html#a8cd76449f510d31ea480b79c05b04354">$idKey</a>;
<a name="l00094"></a>00094 
<a name="l00102"></a><a class="code" href="classDrupalDefaultEntityController_a9fa43bc75fc4ac8e8ac6d0f428421771.html#a9fa43bc75fc4ac8e8ac6d0f428421771">00102</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a9fa43bc75fc4ac8e8ac6d0f428421771.html#a9fa43bc75fc4ac8e8ac6d0f428421771">$revisionKey</a>;
<a name="l00103"></a>00103 
<a name="l00109"></a><a class="code" href="classDrupalDefaultEntityController_a9ce8e5dc9e34a09f18878d2176321ede.html#a9ce8e5dc9e34a09f18878d2176321ede">00109</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_a9ce8e5dc9e34a09f18878d2176321ede.html#a9ce8e5dc9e34a09f18878d2176321ede">$revisionTable</a>;
<a name="l00110"></a>00110 
<a name="l00118"></a><a class="code" href="classDrupalDefaultEntityController_ac385e4a3ae0cc75de84fa3bfd56ae732.html#ac385e4a3ae0cc75de84fa3bfd56ae732">00118</a>   <span class="keyword">protected</span> <a class="code" href="classDrupalDefaultEntityController_ac385e4a3ae0cc75de84fa3bfd56ae732.html#ac385e4a3ae0cc75de84fa3bfd56ae732">$cache</a>;
<a name="l00119"></a>00119 
<a name="l00123"></a><a class="code" href="classDrupalDefaultEntityController_ae25e238e38c76dc784040ae8ad9cfc9c.html#ae25e238e38c76dc784040ae8ad9cfc9c">00123</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_ae25e238e38c76dc784040ae8ad9cfc9c.html#ae25e238e38c76dc784040ae8ad9cfc9c" title="Constructor: sets basic variables.">__construct</a>(<a class="code" href="classDrupalDefaultEntityController_a952f2440f72af738dddba02ee28e9b13.html#a952f2440f72af738dddba02ee28e9b13">$entityType</a>) {
<a name="l00124"></a>00124     $this-&gt;entityType = <a class="code" href="classDrupalDefaultEntityController_a952f2440f72af738dddba02ee28e9b13.html#a952f2440f72af738dddba02ee28e9b13">$entityType</a>;
<a name="l00125"></a>00125     $this-&gt;entityInfo = <a class="code" href="common_8inc_a202e2a1b69e813ef9c48464efeca8ed3.html#a202e2a1b69e813ef9c48464efeca8ed3" title="Get the entity info array of an entity type.">entity_get_info</a>(<a class="code" href="classDrupalDefaultEntityController_a952f2440f72af738dddba02ee28e9b13.html#a952f2440f72af738dddba02ee28e9b13">$entityType</a>);
<a name="l00126"></a>00126     $this-&gt;entityCache = array();
<a name="l00127"></a>00127     $this-&gt;hookLoadArguments = array();
<a name="l00128"></a>00128     $this-&gt;idKey = $this-&gt;entityInfo[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>];
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     <span class="comment">// Check if the entity type supports revisions.</span>
<a name="l00131"></a>00131     <span class="keywordflow">if</span> (!empty($this-&gt;entityInfo[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;revision&#39;</span>])) {
<a name="l00132"></a>00132       $this-&gt;revisionKey = $this-&gt;entityInfo[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;revision&#39;</span>];
<a name="l00133"></a>00133       $this-&gt;revisionTable = $this-&gt;entityInfo[<span class="stringliteral">&#39;revision table&#39;</span>];
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135     <span class="keywordflow">else</span> {
<a name="l00136"></a>00136       $this-&gt;revisionKey = FALSE;
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="comment">// Check if the entity type supports static caching of loaded entities.</span>
<a name="l00140"></a>00140     $this-&gt;cache = !empty($this-&gt;entityInfo[<span class="stringliteral">&#39;static cache&#39;</span>]);
<a name="l00141"></a>00141   }
<a name="l00142"></a>00142 
<a name="l00146"></a><a class="code" href="classDrupalDefaultEntityController_a4d64a900a78ece5d4acc569000b69270.html#a4d64a900a78ece5d4acc569000b69270">00146</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_a4d64a900a78ece5d4acc569000b69270.html#a4d64a900a78ece5d4acc569000b69270" title="Implements DrupalEntityControllerInterface::resetCache().">resetCache</a>(array $ids = NULL) {
<a name="l00147"></a>00147     <span class="keywordflow">if</span> (isset($ids)) {
<a name="l00148"></a>00148       <span class="keywordflow">foreach</span> ($ids as $id) {
<a name="l00149"></a>00149         unset($this-&gt;entityCache[$id]);
<a name="l00150"></a>00150       }
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152     <span class="keywordflow">else</span> {
<a name="l00153"></a>00153       $this-&gt;entityCache = array();
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 
<a name="l00160"></a><a class="code" href="classDrupalDefaultEntityController_a523544ab73cba6994201afa89b0fb0c7.html#a523544ab73cba6994201afa89b0fb0c7">00160</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_a523544ab73cba6994201afa89b0fb0c7.html#a523544ab73cba6994201afa89b0fb0c7" title="Implements DrupalEntityControllerInterface::load().">load</a>($ids = array(), $conditions = array()) {
<a name="l00161"></a>00161     $entities = array();
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="comment">// Revisions are not statically cached, and require a different query to</span>
<a name="l00164"></a>00164     <span class="comment">// other conditions, so separate the revision id into its own variable.</span>
<a name="l00165"></a>00165     <span class="keywordflow">if</span> ($this-&gt;revisionKey &amp;&amp; isset($conditions[$this-&gt;revisionKey])) {
<a name="l00166"></a>00166       $revision_id = $conditions[$this-&gt;revisionKey];
<a name="l00167"></a>00167       unset($conditions[$this-&gt;revisionKey]);
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169     <span class="keywordflow">else</span> {
<a name="l00170"></a>00170       $revision_id = FALSE;
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="comment">// Create a new variable which is either a prepared version of the $ids</span>
<a name="l00174"></a>00174     <span class="comment">// array for later comparison with the entity cache, or FALSE if no $ids</span>
<a name="l00175"></a>00175     <span class="comment">// were passed. The $ids array is reduced as items are loaded from cache,</span>
<a name="l00176"></a>00176     <span class="comment">// and we need to know if it&#39;s empty for this reason to avoid querying the</span>
<a name="l00177"></a>00177     <span class="comment">// database when all requested entities are loaded from cache.</span>
<a name="l00178"></a>00178     $passed_ids = !empty($ids) ? array_flip($ids) : FALSE;
<a name="l00179"></a>00179     <span class="comment">// Try to load entities from the static cache, if the entity type supports</span>
<a name="l00180"></a>00180     <span class="comment">// static caching.</span>
<a name="l00181"></a>00181     <span class="keywordflow">if</span> ($this-&gt;cache &amp;&amp; !$revision_id) {
<a name="l00182"></a>00182       $entities += $this-&gt;<a class="code" href="classDrupalDefaultEntityController_ae791ed21b33704e3b315d106354959c9.html#ae791ed21b33704e3b315d106354959c9" title="Gets entities from the static cache.">cacheGet</a>($ids, $conditions);
<a name="l00183"></a>00183       <span class="comment">// If any entities were loaded, remove them from the ids still to load.</span>
<a name="l00184"></a>00184       <span class="keywordflow">if</span> ($passed_ids) {
<a name="l00185"></a>00185         $ids = array_keys(array_diff_key($passed_ids, $entities));
<a name="l00186"></a>00186       }
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="comment">// Load any remaining entities from the database. This is the case if $ids</span>
<a name="l00190"></a>00190     <span class="comment">// is set to FALSE (so we load all entities), if there are any ids left to</span>
<a name="l00191"></a>00191     <span class="comment">// load, if loading a revision, or if $conditions was passed without $ids.</span>
<a name="l00192"></a>00192     <span class="keywordflow">if</span> ($ids === FALSE || $ids || $revision_id || ($conditions &amp;&amp; !$passed_ids)) {
<a name="l00193"></a>00193       <span class="comment">// Build the query.</span>
<a name="l00194"></a>00194       $query = $this-&gt;<a class="code" href="classDrupalDefaultEntityController_aaa882d053aa4e04e2816b0093b79b0f8.html#aaa882d053aa4e04e2816b0093b79b0f8" title="Builds the query to load the entity.">buildQuery</a>($ids, $conditions, $revision_id);
<a name="l00195"></a>00195       $queried_entities = $query
<a name="l00196"></a>00196         -&gt;execute()
<a name="l00197"></a>00197         -&gt;fetchAllAssoc($this-&gt;idKey);
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">// Pass all entities loaded from the database through $this-&gt;attachLoad(),</span>
<a name="l00201"></a>00201     <span class="comment">// which attaches fields (if supported by the entity type) and calls the</span>
<a name="l00202"></a>00202     <span class="comment">// entity type specific load callback, for example hook_node_load().</span>
<a name="l00203"></a>00203     <span class="keywordflow">if</span> (!empty($queried_entities)) {
<a name="l00204"></a>00204       $this-&gt;<a class="code" href="classDrupalDefaultEntityController_a68735c41d2ba655a073c64983754edf7.html#a68735c41d2ba655a073c64983754edf7" title="Attaches data to entities upon loading.">attachLoad</a>($queried_entities, $revision_id);
<a name="l00205"></a>00205       $entities += $queried_entities;
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <span class="keywordflow">if</span> ($this-&gt;cache) {
<a name="l00209"></a>00209       <span class="comment">// Add entities to the cache if we are not loading a revision.</span>
<a name="l00210"></a>00210       <span class="keywordflow">if</span> (!empty($queried_entities) &amp;&amp; !$revision_id) {
<a name="l00211"></a>00211         $this-&gt;<a class="code" href="classDrupalDefaultEntityController_a5a63fa946fe3fd17b99f865553d0c74d.html#a5a63fa946fe3fd17b99f865553d0c74d" title="Stores entities in the static entity cache.">cacheSet</a>($queried_entities);
<a name="l00212"></a>00212       }
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">// Ensure that the returned array is ordered the same as the original</span>
<a name="l00216"></a>00216     <span class="comment">// $ids array if this was passed in and remove any invalid ids.</span>
<a name="l00217"></a>00217     <span class="keywordflow">if</span> ($passed_ids) {
<a name="l00218"></a>00218       <span class="comment">// Remove any invalid ids from the array.</span>
<a name="l00219"></a>00219       $passed_ids = array_intersect_key($passed_ids, $entities);
<a name="l00220"></a>00220       <span class="keywordflow">foreach</span> ($entities as $entity) {
<a name="l00221"></a>00221         $passed_ids[$entity-&gt;{$this-&gt;idKey}] = $entity;
<a name="l00222"></a>00222       }
<a name="l00223"></a>00223       $entities = $passed_ids;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="keywordflow">return</span> $entities;
<a name="l00227"></a>00227   }
<a name="l00228"></a>00228 
<a name="l00252"></a><a class="code" href="classDrupalDefaultEntityController_aaa882d053aa4e04e2816b0093b79b0f8.html#aaa882d053aa4e04e2816b0093b79b0f8">00252</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_aaa882d053aa4e04e2816b0093b79b0f8.html#aaa882d053aa4e04e2816b0093b79b0f8" title="Builds the query to load the entity.">buildQuery</a>($ids, $conditions = array(), $revision_id = FALSE) {
<a name="l00253"></a>00253     $query = <a class="code" href="group__database_ga9e030cee657d64e3d8e524c65814cc9f.html#ga9e030cee657d64e3d8e524c65814cc9f" title="Returns a new SelectQuery object for the active database.">db_select</a>($this-&gt;entityInfo[<span class="stringliteral">&#39;base table&#39;</span>], <span class="stringliteral">&#39;base&#39;</span>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     $query-&gt;addTag($this-&gt;entityType . <span class="stringliteral">&#39;_load_multiple&#39;</span>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="keywordflow">if</span> ($revision_id) {
<a name="l00258"></a>00258       $query-&gt;join($this-&gt;revisionTable, <span class="stringliteral">&#39;revision&#39;</span>, <span class="stringliteral">&quot;revision.{$this-&gt;idKey} = base.{$this-&gt;idKey} AND revision.{$this-&gt;revisionKey} = :revisionId&quot;</span>, array(<span class="stringliteral">&#39;:revisionId&#39;</span> =&gt; $revision_id));
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260     elseif ($this-&gt;revisionKey) {
<a name="l00261"></a>00261       $query-&gt;join($this-&gt;revisionTable, <span class="stringliteral">&#39;revision&#39;</span>, <span class="stringliteral">&quot;revision.{$this-&gt;revisionKey} = base.{$this-&gt;revisionKey}&quot;</span>);
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="comment">// Add fields from the {entity} table.</span>
<a name="l00265"></a>00265     $entity_fields = $this-&gt;entityInfo[<span class="stringliteral">&#39;schema_fields_sql&#39;</span>][<span class="stringliteral">&#39;base table&#39;</span>];
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="keywordflow">if</span> ($this-&gt;revisionKey) {
<a name="l00268"></a>00268       <span class="comment">// Add all fields from the {entity_revision} table.</span>
<a name="l00269"></a>00269       $entity_revision_fields = <a class="code" href="common_8inc_a72b55fe42aa726cc506660138abd3307.html#a72b55fe42aa726cc506660138abd3307" title="Forms an associative array from a linear array.">drupal_map_assoc</a>($this-&gt;entityInfo[<span class="stringliteral">&#39;schema_fields_sql&#39;</span>][<span class="stringliteral">&#39;revision table&#39;</span>]);
<a name="l00270"></a>00270       <span class="comment">// The id field is provided by entity, so remove it.</span>
<a name="l00271"></a>00271       unset($entity_revision_fields[$this-&gt;idKey]);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273       <span class="comment">// Remove all fields from the base table that are also fields by the same</span>
<a name="l00274"></a>00274       <span class="comment">// name in the revision table.</span>
<a name="l00275"></a>00275       $entity_field_keys = array_flip($entity_fields);
<a name="l00276"></a>00276       <span class="keywordflow">foreach</span> ($entity_revision_fields as $key =&gt; $name) {
<a name="l00277"></a>00277         <span class="keywordflow">if</span> (isset($entity_field_keys[$name])) {
<a name="l00278"></a>00278           unset($entity_fields[$entity_field_keys[$name]]);
<a name="l00279"></a>00279         }
<a name="l00280"></a>00280       }
<a name="l00281"></a>00281       $query-&gt;fields(<span class="stringliteral">&#39;revision&#39;</span>, $entity_revision_fields);
<a name="l00282"></a>00282     }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     $query-&gt;fields(<span class="stringliteral">&#39;base&#39;</span>, $entity_fields);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <span class="keywordflow">if</span> ($ids) {
<a name="l00287"></a>00287       $query-&gt;condition(<span class="stringliteral">&quot;base.{$this-&gt;idKey}&quot;</span>, $ids, <span class="stringliteral">&#39;IN&#39;</span>);
<a name="l00288"></a>00288     }
<a name="l00289"></a>00289     <span class="keywordflow">if</span> ($conditions) {
<a name="l00290"></a>00290       <span class="keywordflow">foreach</span> ($conditions as $field =&gt; $value) {
<a name="l00291"></a>00291         $query-&gt;condition(<span class="stringliteral">&#39;base.&#39;</span> . $field, $value);
<a name="l00292"></a>00292       }
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294     <span class="keywordflow">return</span> $query;
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296 
<a name="l00313"></a><a class="code" href="classDrupalDefaultEntityController_a68735c41d2ba655a073c64983754edf7.html#a68735c41d2ba655a073c64983754edf7">00313</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_a68735c41d2ba655a073c64983754edf7.html#a68735c41d2ba655a073c64983754edf7" title="Attaches data to entities upon loading.">attachLoad</a>(&amp;$queried_entities, $revision_id = FALSE) {
<a name="l00314"></a>00314     <span class="comment">// Attach fields.</span>
<a name="l00315"></a>00315     <span class="keywordflow">if</span> ($this-&gt;entityInfo[<span class="stringliteral">&#39;fieldable&#39;</span>]) {
<a name="l00316"></a>00316       <span class="keywordflow">if</span> ($revision_id) {
<a name="l00317"></a>00317         field_attach_load_revision($this-&gt;entityType, $queried_entities);
<a name="l00318"></a>00318       }
<a name="l00319"></a>00319       <span class="keywordflow">else</span> {
<a name="l00320"></a>00320         field_attach_load($this-&gt;entityType, $queried_entities);
<a name="l00321"></a>00321       }
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="comment">// Call hook_entity_load().</span>
<a name="l00325"></a>00325     <span class="keywordflow">foreach</span> (<a class="code" href="group__hooks_ga9191200072f2a641829e9d3c2759561f.html#ga9191200072f2a641829e9d3c2759561f" title="Determine which modules are implementing a hook.">module_implements</a>(<span class="stringliteral">&#39;entity_load&#39;</span>) as $module) {
<a name="l00326"></a>00326       $function = $module . <span class="stringliteral">&#39;_entity_load&#39;</span>;
<a name="l00327"></a>00327       $function($queried_entities, $this-&gt;entityType);
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329     <span class="comment">// Call hook_TYPE_load(). The first argument for hook_TYPE_load() are</span>
<a name="l00330"></a>00330     <span class="comment">// always the queried entities, followed by additional arguments set in</span>
<a name="l00331"></a>00331     <span class="comment">// $this-&gt;hookLoadArguments.</span>
<a name="l00332"></a>00332     $args = array_merge(array($queried_entities), $this-&gt;hookLoadArguments);
<a name="l00333"></a>00333     <span class="keywordflow">foreach</span> (<a class="code" href="group__hooks_ga9191200072f2a641829e9d3c2759561f.html#ga9191200072f2a641829e9d3c2759561f" title="Determine which modules are implementing a hook.">module_implements</a>($this-&gt;entityInfo[<span class="stringliteral">&#39;load hook&#39;</span>]) as $module) {
<a name="l00334"></a>00334       call_user_func_array($module . <span class="charliteral">&#39;_&#39;</span> . $this-&gt;entityInfo[<span class="stringliteral">&#39;load hook&#39;</span>], $args);
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00349"></a><a class="code" href="classDrupalDefaultEntityController_ae791ed21b33704e3b315d106354959c9.html#ae791ed21b33704e3b315d106354959c9">00349</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_ae791ed21b33704e3b315d106354959c9.html#ae791ed21b33704e3b315d106354959c9" title="Gets entities from the static cache.">cacheGet</a>($ids, $conditions = array()) {
<a name="l00350"></a>00350     $entities = array();
<a name="l00351"></a>00351     <span class="comment">// Load any available entities from the internal cache.</span>
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (!empty($this-&gt;entityCache)) {
<a name="l00353"></a>00353       <span class="keywordflow">if</span> ($ids) {
<a name="l00354"></a>00354         $entities += array_intersect_key($this-&gt;entityCache, array_flip($ids));
<a name="l00355"></a>00355       }
<a name="l00356"></a>00356       <span class="comment">// If loading entities only by conditions, fetch all available entities</span>
<a name="l00357"></a>00357       <span class="comment">// from the cache. Entities which don&#39;t match are removed later.</span>
<a name="l00358"></a>00358       elseif ($conditions) {
<a name="l00359"></a>00359         $entities = $this-&gt;entityCache;
<a name="l00360"></a>00360       }
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     <span class="comment">// Exclude any entities loaded from cache if they don&#39;t match $conditions.</span>
<a name="l00364"></a>00364     <span class="comment">// This ensures the same behavior whether loading from memory or database.</span>
<a name="l00365"></a>00365     <span class="keywordflow">if</span> ($conditions) {
<a name="l00366"></a>00366       <span class="keywordflow">foreach</span> ($entities as $entity) {
<a name="l00367"></a>00367         $entity_values = (array) $entity;
<a name="l00368"></a>00368         <span class="keywordflow">if</span> (array_diff_assoc($conditions, $entity_values)) {
<a name="l00369"></a>00369           unset($entities[$entity-&gt;{$this-&gt;idKey}]);
<a name="l00370"></a>00370         }
<a name="l00371"></a>00371       }
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373     <span class="keywordflow">return</span> $entities;
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375 
<a name="l00382"></a><a class="code" href="classDrupalDefaultEntityController_a5a63fa946fe3fd17b99f865553d0c74d.html#a5a63fa946fe3fd17b99f865553d0c74d">00382</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDrupalDefaultEntityController_a5a63fa946fe3fd17b99f865553d0c74d.html#a5a63fa946fe3fd17b99f865553d0c74d" title="Stores entities in the static entity cache.">cacheSet</a>($entities) {
<a name="l00383"></a>00383     $this-&gt;entityCache += $entities;
<a name="l00384"></a>00384   }
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 
<a name="l00394"></a><a class="code" href="classEntityFieldQueryException.html">00394</a> <span class="keyword">class </span><a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a> <span class="keyword">extends</span> <a class="code" href="classException.html" title="to throw error if a module update fails.">Exception</a> {}
<a name="l00395"></a>00395 
<a name="l00424"></a><a class="code" href="classEntityFieldQuery.html">00424</a> <span class="keyword">class </span><a class="code" href="classEntityFieldQuery.html" title="Retrieves entities matching a given set of conditions.">EntityFieldQuery</a> {
<a name="l00430"></a><a class="code" href="classEntityFieldQuery_a1d63c58e6b1d99e6034d96875305fe0d.html#a1d63c58e6b1d99e6034d96875305fe0d">00430</a>   <span class="keyword">const</span> <a class="code" href="classEntityFieldQuery_a1d63c58e6b1d99e6034d96875305fe0d.html#a1d63c58e6b1d99e6034d96875305fe0d" title="Indicates that both deleted and non-deleted fields should be returned.">RETURN_ALL</a> = NULL;
<a name="l00431"></a>00431 
<a name="l00440"></a><a class="code" href="classEntityFieldQuery_aa66daa06e91cd337c4045ac8e4dd4b7a.html#aa66daa06e91cd337c4045ac8e4dd4b7a">00440</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_aa66daa06e91cd337c4045ac8e4dd4b7a.html#aa66daa06e91cd337c4045ac8e4dd4b7a">$altered</a> = FALSE;
<a name="l00441"></a>00441 
<a name="l00449"></a><a class="code" href="classEntityFieldQuery_a6a1f5e64764ac49535250c873ddc169e.html#a6a1f5e64764ac49535250c873ddc169e">00449</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a6a1f5e64764ac49535250c873ddc169e.html#a6a1f5e64764ac49535250c873ddc169e">$entityConditions</a> = array();
<a name="l00450"></a>00450 
<a name="l00458"></a><a class="code" href="classEntityFieldQuery_a62513023c5cfe1a0ea78adc49722f0d2.html#a62513023c5cfe1a0ea78adc49722f0d2">00458</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a62513023c5cfe1a0ea78adc49722f0d2.html#a62513023c5cfe1a0ea78adc49722f0d2">$fieldConditions</a> = array();
<a name="l00459"></a>00459 
<a name="l00473"></a><a class="code" href="classEntityFieldQuery_ac8e3cc1b46a9041245ec6ec77d18f9de.html#ac8e3cc1b46a9041245ec6ec77d18f9de">00473</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_ac8e3cc1b46a9041245ec6ec77d18f9de.html#ac8e3cc1b46a9041245ec6ec77d18f9de">$fieldMetaConditions</a> = array();
<a name="l00474"></a>00474 
<a name="l00482"></a><a class="code" href="classEntityFieldQuery_a007295a12afa8adf152f9548ad248165.html#a007295a12afa8adf152f9548ad248165">00482</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a007295a12afa8adf152f9548ad248165.html#a007295a12afa8adf152f9548ad248165">$propertyConditions</a> = array();
<a name="l00483"></a>00483 
<a name="l00489"></a><a class="code" href="classEntityFieldQuery_ae94b590f6a8408cc7eb501b865feca3b.html#ae94b590f6a8408cc7eb501b865feca3b">00489</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_ae94b590f6a8408cc7eb501b865feca3b.html#ae94b590f6a8408cc7eb501b865feca3b">$order</a> = array();
<a name="l00490"></a>00490 
<a name="l00498"></a><a class="code" href="classEntityFieldQuery_ad37cea9d2eeb464519444b9b8df9e102.html#ad37cea9d2eeb464519444b9b8df9e102">00498</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_ad37cea9d2eeb464519444b9b8df9e102.html#ad37cea9d2eeb464519444b9b8df9e102">$range</a> = array();
<a name="l00499"></a>00499 
<a name="l00507"></a><a class="code" href="classEntityFieldQuery_a996e85b1aee86eae7e72664f363b1bc6.html#a996e85b1aee86eae7e72664f363b1bc6">00507</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a996e85b1aee86eae7e72664f363b1bc6.html#a996e85b1aee86eae7e72664f363b1bc6">$pager</a> = array();
<a name="l00508"></a>00508 
<a name="l00517"></a><a class="code" href="classEntityFieldQuery_a87e043391f89270b6d1902acf9184e14.html#a87e043391f89270b6d1902acf9184e14">00517</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a87e043391f89270b6d1902acf9184e14.html#a87e043391f89270b6d1902acf9184e14" title="Query behavior for deleted data.">$deleted</a> = FALSE;
<a name="l00518"></a>00518 
<a name="l00529"></a><a class="code" href="classEntityFieldQuery_af5058d540ed2184e8efcdcc037680342.html#af5058d540ed2184e8efcdcc037680342">00529</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_af5058d540ed2184e8efcdcc037680342.html#af5058d540ed2184e8efcdcc037680342">$fields</a> = array();
<a name="l00530"></a>00530 
<a name="l00536"></a><a class="code" href="classEntityFieldQuery_ae08dbba5615ea921ec5a72e42e0824ce.html#ae08dbba5615ea921ec5a72e42e0824ce">00536</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_ae08dbba5615ea921ec5a72e42e0824ce.html#ae08dbba5615ea921ec5a72e42e0824ce">$count</a> = FALSE;
<a name="l00537"></a>00537 
<a name="l00545"></a><a class="code" href="classEntityFieldQuery_aa437a76efdf79e46fe7ac3a4760a1d73.html#aa437a76efdf79e46fe7ac3a4760a1d73">00545</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_aa437a76efdf79e46fe7ac3a4760a1d73.html#aa437a76efdf79e46fe7ac3a4760a1d73">$age</a> = FIELD_LOAD_CURRENT;
<a name="l00546"></a>00546 
<a name="l00554"></a><a class="code" href="classEntityFieldQuery_a1aa12ecd2effd5dad6ba77803c46c81d.html#a1aa12ecd2effd5dad6ba77803c46c81d">00554</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a1aa12ecd2effd5dad6ba77803c46c81d.html#a1aa12ecd2effd5dad6ba77803c46c81d">$tags</a> = array();
<a name="l00555"></a>00555 
<a name="l00563"></a><a class="code" href="classEntityFieldQuery_a7b2b0567133edfa3afbb37c7ba2b463a.html#a7b2b0567133edfa3afbb37c7ba2b463a">00563</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a7b2b0567133edfa3afbb37c7ba2b463a.html#a7b2b0567133edfa3afbb37c7ba2b463a">$metaData</a> = array();
<a name="l00564"></a>00564 
<a name="l00572"></a><a class="code" href="classEntityFieldQuery_ac6e597534a9aa8b18895e6a26b8e82d0.html#ac6e597534a9aa8b18895e6a26b8e82d0">00572</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_ac6e597534a9aa8b18895e6a26b8e82d0.html#ac6e597534a9aa8b18895e6a26b8e82d0">$orderedResults</a> = array();
<a name="l00573"></a>00573 
<a name="l00581"></a><a class="code" href="classEntityFieldQuery_a0a811479c18a4bb1ec5697cd4a1a321b.html#a0a811479c18a4bb1ec5697cd4a1a321b">00581</a>   <span class="keyword">public</span> <a class="code" href="classEntityFieldQuery_a0a811479c18a4bb1ec5697cd4a1a321b.html#a0a811479c18a4bb1ec5697cd4a1a321b">$executeCallback</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00582"></a>00582 
<a name="l00622"></a><a class="code" href="classEntityFieldQuery_a08559bd2f164f707a7ad18eff6622017.html#a08559bd2f164f707a7ad18eff6622017">00622</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a08559bd2f164f707a7ad18eff6622017.html#a08559bd2f164f707a7ad18eff6622017" title="Adds a condition on entity-generic metadata.">entityCondition</a>($name, $value, $operator = NULL) {
<a name="l00623"></a>00623     <span class="comment">// The &#39;!=&#39; operator is deprecated in favour of the &#39;&lt;&gt;&#39; operator since the</span>
<a name="l00624"></a>00624     <span class="comment">// latter is ANSI SQL compatible.</span>
<a name="l00625"></a>00625     <span class="keywordflow">if</span> ($operator == <span class="stringliteral">&#39;!=&#39;</span>) {
<a name="l00626"></a>00626       $operator = <span class="stringliteral">&#39;&lt;&gt;&#39;</span>;
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628     $this-&gt;entityConditions[$name] = array(
<a name="l00629"></a>00629       <span class="stringliteral">&#39;value&#39;</span> =&gt; $value,
<a name="l00630"></a>00630       <span class="stringliteral">&#39;operator&#39;</span> =&gt; $operator,
<a name="l00631"></a>00631     );
<a name="l00632"></a>00632     <span class="keywordflow">return</span> $this;
<a name="l00633"></a>00633   }
<a name="l00634"></a>00634 
<a name="l00662"></a><a class="code" href="classEntityFieldQuery_aa8f9660691c0ff6aca2e535c3df78e92.html#aa8f9660691c0ff6aca2e535c3df78e92">00662</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_aa8f9660691c0ff6aca2e535c3df78e92.html#aa8f9660691c0ff6aca2e535c3df78e92" title="Adds a condition on field values.">fieldCondition</a>($field, $column = NULL, $value = NULL, $operator = NULL, $delta_group = NULL, $language_group = NULL) {
<a name="l00663"></a>00663     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classEntityFieldQuery_addc28605e17a54c0198f3cd6e2753489.html#addc28605e17a54c0198f3cd6e2753489" title="Adds the given condition to the proper condition array.">addFieldCondition</a>($this-&gt;fieldConditions, $field, $column, $value, $operator, $delta_group, $language_group);
<a name="l00664"></a>00664   }
<a name="l00665"></a>00665 
<a name="l00688"></a><a class="code" href="classEntityFieldQuery_a4c09c59b7bea2f57e8c8b50ef641fbf4.html#a4c09c59b7bea2f57e8c8b50ef641fbf4">00688</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a4c09c59b7bea2f57e8c8b50ef641fbf4.html#a4c09c59b7bea2f57e8c8b50ef641fbf4" title="Adds a condition on the field language column.">fieldLanguageCondition</a>($field, $value = NULL, $operator = NULL, $delta_group = NULL, $language_group = NULL) {
<a name="l00689"></a>00689     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classEntityFieldQuery_addc28605e17a54c0198f3cd6e2753489.html#addc28605e17a54c0198f3cd6e2753489" title="Adds the given condition to the proper condition array.">addFieldCondition</a>($this-&gt;fieldMetaConditions, $field, <span class="stringliteral">&#39;language&#39;</span>, $value, $operator, $delta_group, $language_group);
<a name="l00690"></a>00690   }
<a name="l00691"></a>00691 
<a name="l00714"></a><a class="code" href="classEntityFieldQuery_a2008e72f472747354332f0b42971032f.html#a2008e72f472747354332f0b42971032f">00714</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a2008e72f472747354332f0b42971032f.html#a2008e72f472747354332f0b42971032f" title="Adds a condition on the field delta column.">fieldDeltaCondition</a>($field, $value = NULL, $operator = NULL, $delta_group = NULL, $language_group = NULL) {
<a name="l00715"></a>00715     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classEntityFieldQuery_addc28605e17a54c0198f3cd6e2753489.html#addc28605e17a54c0198f3cd6e2753489" title="Adds the given condition to the proper condition array.">addFieldCondition</a>($this-&gt;fieldMetaConditions, $field, <span class="stringliteral">&#39;delta&#39;</span>, $value, $operator, $delta_group, $language_group);
<a name="l00716"></a>00716   }
<a name="l00717"></a>00717 
<a name="l00761"></a><a class="code" href="classEntityFieldQuery_addc28605e17a54c0198f3cd6e2753489.html#addc28605e17a54c0198f3cd6e2753489">00761</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_addc28605e17a54c0198f3cd6e2753489.html#addc28605e17a54c0198f3cd6e2753489" title="Adds the given condition to the proper condition array.">addFieldCondition</a>(&amp;$conditions, $field, $column = NULL, $value = NULL, $operator = NULL, $delta_group = NULL, $language_group = NULL) {
<a name="l00762"></a>00762     <span class="comment">// The &#39;!=&#39; operator is deprecated in favour of the &#39;&lt;&gt;&#39; operator since the</span>
<a name="l00763"></a>00763     <span class="comment">// latter is ANSI SQL compatible.</span>
<a name="l00764"></a>00764     <span class="keywordflow">if</span> ($operator == <span class="stringliteral">&#39;!=&#39;</span>) {
<a name="l00765"></a>00765       $operator = <span class="stringliteral">&#39;&lt;&gt;&#39;</span>;
<a name="l00766"></a>00766     }
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (is_scalar($field)) {
<a name="l00768"></a>00768       $field_definition = field_info_field($field);
<a name="l00769"></a>00769       <span class="keywordflow">if</span> (empty($field_definition)) {
<a name="l00770"></a>00770         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Unknown field: @field_name&#39;</span>, array(<span class="stringliteral">&#39;@field_name&#39;</span> =&gt; $field)));
<a name="l00771"></a>00771       }
<a name="l00772"></a>00772       $field = $field_definition;
<a name="l00773"></a>00773     }
<a name="l00774"></a>00774     <span class="comment">// Ensure the same index is used for field conditions as for fields.</span>
<a name="l00775"></a>00775     $index = <a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a>($this-&gt;fields);
<a name="l00776"></a>00776     $this-&gt;fields[$index] = $field;
<a name="l00777"></a>00777     <span class="keywordflow">if</span> (isset($column)) {
<a name="l00778"></a>00778       $conditions[$index] = array(
<a name="l00779"></a>00779         <span class="stringliteral">&#39;field&#39;</span> =&gt; $field,
<a name="l00780"></a>00780         <span class="stringliteral">&#39;column&#39;</span> =&gt; $column,
<a name="l00781"></a>00781         <span class="stringliteral">&#39;value&#39;</span> =&gt; $value,
<a name="l00782"></a>00782         <span class="stringliteral">&#39;operator&#39;</span> =&gt; $operator,
<a name="l00783"></a>00783         <span class="stringliteral">&#39;delta_group&#39;</span> =&gt; $delta_group,
<a name="l00784"></a>00784         <span class="stringliteral">&#39;language_group&#39;</span> =&gt; $language_group,
<a name="l00785"></a>00785       );
<a name="l00786"></a>00786     }
<a name="l00787"></a>00787     <span class="keywordflow">return</span> $this;
<a name="l00788"></a>00788   }
<a name="l00789"></a>00789 
<a name="l00820"></a><a class="code" href="classEntityFieldQuery_a732e6068c9fdba15a8142cc03328973e.html#a732e6068c9fdba15a8142cc03328973e">00820</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a732e6068c9fdba15a8142cc03328973e.html#a732e6068c9fdba15a8142cc03328973e" title="Adds a condition on an entity-specific property.">propertyCondition</a>($column, $value, $operator = NULL) {
<a name="l00821"></a>00821     <span class="comment">// The &#39;!=&#39; operator is deprecated in favour of the &#39;&lt;&gt;&#39; operator since the</span>
<a name="l00822"></a>00822     <span class="comment">// latter is ANSI SQL compatible.</span>
<a name="l00823"></a>00823     <span class="keywordflow">if</span> ($operator == <span class="stringliteral">&#39;!=&#39;</span>) {
<a name="l00824"></a>00824       $operator = <span class="stringliteral">&#39;&lt;&gt;&#39;</span>;
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826     $this-&gt;propertyConditions[] = array(
<a name="l00827"></a>00827       <span class="stringliteral">&#39;column&#39;</span> =&gt; $column,
<a name="l00828"></a>00828       <span class="stringliteral">&#39;value&#39;</span> =&gt; $value,
<a name="l00829"></a>00829       <span class="stringliteral">&#39;operator&#39;</span> =&gt; $operator,
<a name="l00830"></a>00830     );
<a name="l00831"></a>00831     <span class="keywordflow">return</span> $this;
<a name="l00832"></a>00832   }
<a name="l00833"></a>00833 
<a name="l00851"></a><a class="code" href="classEntityFieldQuery_aaec910a18a4d4d168dcb1f6a004a604e.html#aaec910a18a4d4d168dcb1f6a004a604e">00851</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_aaec910a18a4d4d168dcb1f6a004a604e.html#aaec910a18a4d4d168dcb1f6a004a604e" title="Orders the result set by entity-generic metadata.">entityOrderBy</a>($name, $direction = <span class="stringliteral">&#39;ASC&#39;</span>) {
<a name="l00852"></a>00852     $this-&gt;order[] = array(
<a name="l00853"></a>00853       <span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;entity&#39;</span>,
<a name="l00854"></a>00854       <span class="stringliteral">&#39;specifier&#39;</span> =&gt; $name,
<a name="l00855"></a>00855       <span class="stringliteral">&#39;direction&#39;</span> =&gt; $direction,
<a name="l00856"></a>00856     );
<a name="l00857"></a>00857     <span class="keywordflow">return</span> $this;
<a name="l00858"></a>00858   }
<a name="l00859"></a>00859 
<a name="l00879"></a><a class="code" href="classEntityFieldQuery_ad2256f83946cc87c91a960f7a81ce833.html#ad2256f83946cc87c91a960f7a81ce833">00879</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_ad2256f83946cc87c91a960f7a81ce833.html#ad2256f83946cc87c91a960f7a81ce833" title="Orders the result set by a given field column.">fieldOrderBy</a>($field, $column, $direction = <span class="stringliteral">&#39;ASC&#39;</span>) {
<a name="l00880"></a>00880     <span class="keywordflow">if</span> (is_scalar($field)) {
<a name="l00881"></a>00881       $field_definition = field_info_field($field);
<a name="l00882"></a>00882       <span class="keywordflow">if</span> (empty($field_definition)) {
<a name="l00883"></a>00883         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Unknown field: @field_name&#39;</span>, array(<span class="stringliteral">&#39;@field_name&#39;</span> =&gt; $field)));
<a name="l00884"></a>00884       }
<a name="l00885"></a>00885       $field = $field_definition;
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887     <span class="comment">// Save the index used for the new field, for later use in field storage.</span>
<a name="l00888"></a>00888     $index = <a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a>($this-&gt;fields);
<a name="l00889"></a>00889     $this-&gt;fields[$index] = $field;
<a name="l00890"></a>00890     $this-&gt;order[] = array(
<a name="l00891"></a>00891       <span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;field&#39;</span>,
<a name="l00892"></a>00892       <span class="stringliteral">&#39;specifier&#39;</span> =&gt; array(
<a name="l00893"></a>00893         <span class="stringliteral">&#39;field&#39;</span> =&gt; $field,
<a name="l00894"></a>00894         <span class="stringliteral">&#39;index&#39;</span> =&gt; $index,
<a name="l00895"></a>00895         <span class="stringliteral">&#39;column&#39;</span> =&gt; $column,
<a name="l00896"></a>00896       ),
<a name="l00897"></a>00897       <span class="stringliteral">&#39;direction&#39;</span> =&gt; $direction,
<a name="l00898"></a>00898     );
<a name="l00899"></a>00899     <span class="keywordflow">return</span> $this;
<a name="l00900"></a>00900   }
<a name="l00901"></a>00901 
<a name="l00920"></a><a class="code" href="classEntityFieldQuery_af53f3f1b5da41238638389da6e153dbe.html#af53f3f1b5da41238638389da6e153dbe">00920</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_af53f3f1b5da41238638389da6e153dbe.html#af53f3f1b5da41238638389da6e153dbe" title="Orders the result set by an entity-specific property.">propertyOrderBy</a>($column, $direction = <span class="stringliteral">&#39;ASC&#39;</span>) {
<a name="l00921"></a>00921     $this-&gt;order[] = array(
<a name="l00922"></a>00922       <span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;property&#39;</span>,
<a name="l00923"></a>00923       <span class="stringliteral">&#39;specifier&#39;</span> =&gt; $column,
<a name="l00924"></a>00924       <span class="stringliteral">&#39;direction&#39;</span> =&gt; $direction,
<a name="l00925"></a>00925     );
<a name="l00926"></a>00926     <span class="keywordflow">return</span> $this;
<a name="l00927"></a>00927   }
<a name="l00928"></a>00928 
<a name="l00935"></a><a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4">00935</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a>() {
<a name="l00936"></a>00936     $this-&gt;<a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a> = TRUE;
<a name="l00937"></a>00937     <span class="keywordflow">return</span> $this;
<a name="l00938"></a>00938   }
<a name="l00939"></a>00939 
<a name="l00952"></a><a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7">00952</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a>($start = NULL, $length = NULL) {
<a name="l00953"></a>00953     $this-&gt;<a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a> = array(
<a name="l00954"></a>00954       <span class="stringliteral">&#39;start&#39;</span> =&gt; $start,
<a name="l00955"></a>00955       <span class="stringliteral">&#39;length&#39;</span> =&gt; $length,
<a name="l00956"></a>00956     );
<a name="l00957"></a>00957     <span class="keywordflow">return</span> $this;
<a name="l00958"></a>00958   }
<a name="l00959"></a>00959 
<a name="l00973"></a><a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7">00973</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>($limit = 10, $element = NULL) {
<a name="l00974"></a>00974     <span class="keywordflow">if</span> (!isset($element)) {
<a name="l00975"></a>00975       $element = <a class="code" href="classPagerDefault_a98773ffb92c70067ba49df6fdca0eb21.html#a98773ffb92c70067ba49df6fdca0eb21">PagerDefault::$maxElement</a>++;
<a name="l00976"></a>00976     }
<a name="l00977"></a>00977     elseif ($element &gt;= <a class="code" href="classPagerDefault_a98773ffb92c70067ba49df6fdca0eb21.html#a98773ffb92c70067ba49df6fdca0eb21">PagerDefault::$maxElement</a>) {
<a name="l00978"></a>00978       <a class="code" href="classPagerDefault_a98773ffb92c70067ba49df6fdca0eb21.html#a98773ffb92c70067ba49df6fdca0eb21">PagerDefault::$maxElement</a> = $element + 1;
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980 
<a name="l00981"></a>00981     $this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a> = array(
<a name="l00982"></a>00982       <span class="stringliteral">&#39;limit&#39;</span> =&gt; $limit,
<a name="l00983"></a>00983       <span class="stringliteral">&#39;element&#39;</span> =&gt; $element,
<a name="l00984"></a>00984     );
<a name="l00985"></a>00985     <span class="keywordflow">return</span> $this;
<a name="l00986"></a>00986   }
<a name="l00987"></a>00987 
<a name="l00997"></a><a class="code" href="classEntityFieldQuery_a582ffe2a0a08dc4def3076af2bc6563a.html#a582ffe2a0a08dc4def3076af2bc6563a">00997</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a582ffe2a0a08dc4def3076af2bc6563a.html#a582ffe2a0a08dc4def3076af2bc6563a" title="Enable sortable tables for this query.">tableSort</a>(&amp;$headers) {
<a name="l00998"></a>00998     <span class="comment">// If &#39;field&#39; is not initialized, the header columns aren&#39;t clickable</span>
<a name="l00999"></a>00999     <span class="keywordflow">foreach</span> ($headers as $key =&gt;$header) {
<a name="l01000"></a>01000       <span class="keywordflow">if</span> (is_array($header) &amp;&amp; isset($header[<span class="stringliteral">&#39;specifier&#39;</span>])) {
<a name="l01001"></a>01001         $headers[$key][<span class="stringliteral">&#39;field&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01002"></a>01002       }
<a name="l01003"></a>01003     }
<a name="l01004"></a>01004 
<a name="l01005"></a>01005     <a class="code" href="classEntityFieldQuery_ae94b590f6a8408cc7eb501b865feca3b.html#ae94b590f6a8408cc7eb501b865feca3b">$order</a> = <a class="code" href="tablesort_8inc_a185527ebc6d0d3f4b8681b60debddf21.html#a185527ebc6d0d3f4b8681b60debddf21" title="Determine the current sort criterion.">tablesort_get_order</a>($headers);
<a name="l01006"></a>01006     $direction = <a class="code" href="tablesort_8inc_ae0824a39d518b2e6dc8e603093be2146.html#ae0824a39d518b2e6dc8e603093be2146" title="Determine the current sort direction.">tablesort_get_sort</a>($headers);
<a name="l01007"></a>01007     <span class="keywordflow">foreach</span> ($headers as $header) {
<a name="l01008"></a>01008       <span class="keywordflow">if</span> (is_array($header) &amp;&amp; ($header[<span class="stringliteral">&#39;data&#39;</span>] == <a class="code" href="classEntityFieldQuery_ae94b590f6a8408cc7eb501b865feca3b.html#ae94b590f6a8408cc7eb501b865feca3b">$order</a>[<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l01009"></a>01009         <span class="keywordflow">if</span> ($header[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;field&#39;</span>) {
<a name="l01010"></a>01010           $this-&gt;<a class="code" href="classEntityFieldQuery_ad2256f83946cc87c91a960f7a81ce833.html#ad2256f83946cc87c91a960f7a81ce833" title="Orders the result set by a given field column.">fieldOrderBy</a>($header[<span class="stringliteral">&#39;specifier&#39;</span>][<span class="stringliteral">&#39;field&#39;</span>], $header[<span class="stringliteral">&#39;specifier&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>], $direction);
<a name="l01011"></a>01011         }
<a name="l01012"></a>01012         <span class="keywordflow">else</span> {
<a name="l01013"></a>01013           $header[<span class="stringliteral">&#39;direction&#39;</span>] = $direction;
<a name="l01014"></a>01014           $this-&gt;order[] = $header;
<a name="l01015"></a>01015         }
<a name="l01016"></a>01016       }
<a name="l01017"></a>01017     }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019     <span class="keywordflow">return</span> $this;
<a name="l01020"></a>01020   }
<a name="l01021"></a>01021 
<a name="l01032"></a><a class="code" href="classEntityFieldQuery_a49543cc7ea0841ba46d4ebe310695ce3.html#a49543cc7ea0841ba46d4ebe310695ce3">01032</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a49543cc7ea0841ba46d4ebe310695ce3.html#a49543cc7ea0841ba46d4ebe310695ce3" title="Filters on the data being deleted.">deleted</a>(<a class="code" href="classEntityFieldQuery_a87e043391f89270b6d1902acf9184e14.html#a87e043391f89270b6d1902acf9184e14" title="Query behavior for deleted data.">$deleted</a> = TRUE) {
<a name="l01033"></a>01033     $this-&gt;<a class="code" href="classEntityFieldQuery_a49543cc7ea0841ba46d4ebe310695ce3.html#a49543cc7ea0841ba46d4ebe310695ce3" title="Filters on the data being deleted.">deleted</a> = <a class="code" href="classEntityFieldQuery_a87e043391f89270b6d1902acf9184e14.html#a87e043391f89270b6d1902acf9184e14" title="Query behavior for deleted data.">$deleted</a>;
<a name="l01034"></a>01034     <span class="keywordflow">return</span> $this;
<a name="l01035"></a>01035   }
<a name="l01036"></a>01036 
<a name="l01053"></a><a class="code" href="classEntityFieldQuery_af6fbd7296e3c833f8a31769e0c1c866a.html#af6fbd7296e3c833f8a31769e0c1c866a">01053</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_af6fbd7296e3c833f8a31769e0c1c866a.html#af6fbd7296e3c833f8a31769e0c1c866a" title="Queries the current or every revision.">age</a>(<a class="code" href="classEntityFieldQuery_aa437a76efdf79e46fe7ac3a4760a1d73.html#aa437a76efdf79e46fe7ac3a4760a1d73">$age</a>) {
<a name="l01054"></a>01054     $this-&gt;<a class="code" href="classEntityFieldQuery_af6fbd7296e3c833f8a31769e0c1c866a.html#af6fbd7296e3c833f8a31769e0c1c866a" title="Queries the current or every revision.">age</a> = <a class="code" href="classEntityFieldQuery_aa437a76efdf79e46fe7ac3a4760a1d73.html#aa437a76efdf79e46fe7ac3a4760a1d73">$age</a>;
<a name="l01055"></a>01055     <span class="keywordflow">return</span> $this;
<a name="l01056"></a>01056   }
<a name="l01057"></a>01057 
<a name="l01078"></a><a class="code" href="classEntityFieldQuery_a7cfe2a721e0aee895516cd46a59c872e.html#a7cfe2a721e0aee895516cd46a59c872e">01078</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a7cfe2a721e0aee895516cd46a59c872e.html#a7cfe2a721e0aee895516cd46a59c872e" title="Adds a tag to the query.">addTag</a>($tag) {
<a name="l01079"></a>01079     $this-&gt;tags[$tag] = $tag;
<a name="l01080"></a>01080     <span class="keywordflow">return</span> $this;
<a name="l01081"></a>01081   }
<a name="l01082"></a>01082 
<a name="l01099"></a><a class="code" href="classEntityFieldQuery_a143d69ef04486e7b78e0f7536b89ee53.html#a143d69ef04486e7b78e0f7536b89ee53">01099</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a143d69ef04486e7b78e0f7536b89ee53.html#a143d69ef04486e7b78e0f7536b89ee53" title="Adds additional metadata to the query.">addMetaData</a>($key, $object) {
<a name="l01100"></a>01100     $this-&gt;metaData[$key] = $object;
<a name="l01101"></a>01101     <span class="keywordflow">return</span> $this;
<a name="l01102"></a>01102   }
<a name="l01103"></a>01103 
<a name="l01135"></a><a class="code" href="classEntityFieldQuery_ac90614418d7fb3a0c81134889fe1bcbd.html#ac90614418d7fb3a0c81134889fe1bcbd">01135</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_ac90614418d7fb3a0c81134889fe1bcbd.html#ac90614418d7fb3a0c81134889fe1bcbd" title="Executes the query.">execute</a>() {
<a name="l01136"></a>01136     <span class="comment">// Give a chance to other modules to alter the query.</span>
<a name="l01137"></a>01137     <a class="code" href="module_8inc_a9badfa1d68b90764aa160aee0e58b4ef.html#a9badfa1d68b90764aa160aee0e58b4ef" title="Hands off alterable variables to type-specific *_alter implementations.">drupal_alter</a>(<span class="stringliteral">&#39;entity_query&#39;</span>, $this);
<a name="l01138"></a>01138     $this-&gt;altered = TRUE;
<a name="l01139"></a>01139 
<a name="l01140"></a>01140     <span class="comment">// Initialize the pager.</span>
<a name="l01141"></a>01141     $this-&gt;<a class="code" href="classEntityFieldQuery_a53c95c5a7f8a4a419aa85fa5d6529524.html#a53c95c5a7f8a4a419aa85fa5d6529524" title="Get the total number of results and initialize a pager for the query.">initializePager</a>();
<a name="l01142"></a>01142 
<a name="l01143"></a>01143     <span class="comment">// Execute the query using the correct callback.</span>
<a name="l01144"></a>01144     $result = call_user_func($this-&gt;<a class="code" href="classEntityFieldQuery_a79642d38a928c05d6741ec0948e08ddb.html#a79642d38a928c05d6741ec0948e08ddb" title="Determines the query callback to use for this entity query.">queryCallback</a>(), $this);
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     <span class="keywordflow">return</span> $result;
<a name="l01147"></a>01147   }
<a name="l01148"></a>01148 
<a name="l01155"></a><a class="code" href="classEntityFieldQuery_a79642d38a928c05d6741ec0948e08ddb.html#a79642d38a928c05d6741ec0948e08ddb">01155</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a79642d38a928c05d6741ec0948e08ddb.html#a79642d38a928c05d6741ec0948e08ddb" title="Determines the query callback to use for this entity query.">queryCallback</a>() {
<a name="l01156"></a>01156     <span class="comment">// Use the override from $this-&gt;executeCallback. It can be set either</span>
<a name="l01157"></a>01157     <span class="comment">// while building the query, or using hook_entity_query_alter().</span>
<a name="l01158"></a>01158     <span class="keywordflow">if</span> (function_exists($this-&gt;executeCallback)) {
<a name="l01159"></a>01159       <span class="keywordflow">return</span> $this-&gt;executeCallback;
<a name="l01160"></a>01160     }
<a name="l01161"></a>01161     <span class="comment">// If there are no field conditions and sorts, and no execute callback</span>
<a name="l01162"></a>01162     <span class="comment">// then we default to querying entity tables in SQL.</span>
<a name="l01163"></a>01163     <span class="keywordflow">if</span> (empty($this-&gt;fields)) {
<a name="l01164"></a>01164       <span class="keywordflow">return</span> array($this, <span class="stringliteral">&#39;propertyQuery&#39;</span>);
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166     <span class="comment">// If no override, find the storage engine to be used.</span>
<a name="l01167"></a>01167     <span class="keywordflow">foreach</span> ($this-&gt;fields as $field) {
<a name="l01168"></a>01168       <span class="keywordflow">if</span> (!isset($storage)) {
<a name="l01169"></a>01169         $storage = $field[<span class="stringliteral">&#39;storage&#39;</span>][<span class="stringliteral">&#39;module&#39;</span>];
<a name="l01170"></a>01170       }
<a name="l01171"></a>01171       elseif ($storage != $field[<span class="stringliteral">&#39;storage&#39;</span>][<span class="stringliteral">&#39;module&#39;</span>]) {
<a name="l01172"></a>01172         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&quot;Can&#39;t handle more than one field storage engine&quot;</span>));
<a name="l01173"></a>01173       }
<a name="l01174"></a>01174     }
<a name="l01175"></a>01175     <span class="keywordflow">if</span> ($storage) {
<a name="l01176"></a>01176       <span class="comment">// Use hook_field_storage_query() from the field storage.</span>
<a name="l01177"></a>01177       <span class="keywordflow">return</span> $storage . <span class="stringliteral">&#39;_field_storage_query&#39;</span>;
<a name="l01178"></a>01178     }
<a name="l01179"></a>01179     <span class="keywordflow">else</span> {
<a name="l01180"></a>01180       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&quot;Field storage engine not found.&quot;</span>));
<a name="l01181"></a>01181     }
<a name="l01182"></a>01182   }
<a name="l01183"></a>01183 
<a name="l01192"></a><a class="code" href="classEntityFieldQuery_ab3bb269b65934d2aaa0fb2fb3bd884e4.html#ab3bb269b65934d2aaa0fb2fb3bd884e4">01192</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_ab3bb269b65934d2aaa0fb2fb3bd884e4.html#ab3bb269b65934d2aaa0fb2fb3bd884e4" title="Queries entity tables in SQL for property conditions and sorts.">propertyQuery</a>() {
<a name="l01193"></a>01193     <span class="keywordflow">if</span> (empty($this-&gt;entityConditions[<span class="stringliteral">&#39;entity_type&#39;</span>])) {
<a name="l01194"></a>01194       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;For this query an entity type must be specified.&#39;</span>));
<a name="l01195"></a>01195     }
<a name="l01196"></a>01196     $entity_type = $this-&gt;entityConditions[<span class="stringliteral">&#39;entity_type&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>];
<a name="l01197"></a>01197     $entity_info = <a class="code" href="common_8inc_a202e2a1b69e813ef9c48464efeca8ed3.html#a202e2a1b69e813ef9c48464efeca8ed3" title="Get the entity info array of an entity type.">entity_get_info</a>($entity_type);
<a name="l01198"></a>01198     <span class="keywordflow">if</span> (empty($entity_info[<span class="stringliteral">&#39;base table&#39;</span>])) {
<a name="l01199"></a>01199       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Entity %entity has no base table.&#39;</span>, array(<span class="stringliteral">&#39;%entity&#39;</span> =&gt; $entity_type)));
<a name="l01200"></a>01200     }
<a name="l01201"></a>01201     $base_table = $entity_info[<span class="stringliteral">&#39;base table&#39;</span>];
<a name="l01202"></a>01202     $base_table_schema = <a class="code" href="group__schemaapi_ga979670bd6bd2e34337ffc5f0810f2d71.html#ga979670bd6bd2e34337ffc5f0810f2d71" title="Gets the schema definition of a table, or the whole database schema.">drupal_get_schema</a>($base_table);
<a name="l01203"></a>01203     $select_query = <a class="code" href="group__database_ga9e030cee657d64e3d8e524c65814cc9f.html#ga9e030cee657d64e3d8e524c65814cc9f" title="Returns a new SelectQuery object for the active database.">db_select</a>($base_table);
<a name="l01204"></a>01204     $select_query-&gt;addExpression(<span class="stringliteral">&#39;:entity_type&#39;</span>, <span class="stringliteral">&#39;entity_type&#39;</span>, array(<span class="stringliteral">&#39;:entity_type&#39;</span> =&gt; $entity_type));
<a name="l01205"></a>01205     <span class="comment">// Process the property conditions.</span>
<a name="l01206"></a>01206     <span class="keywordflow">foreach</span> ($this-&gt;propertyConditions as $property_condition) {
<a name="l01207"></a>01207       $this-&gt;<a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336" title="Adds a condition to an already built SelectQuery (internal function).">addCondition</a>($select_query, $base_table . <span class="charliteral">&#39;.&#39;</span> . $property_condition[<span class="stringliteral">&#39;column&#39;</span>], $property_condition);
<a name="l01208"></a>01208     }
<a name="l01209"></a>01209     <span class="comment">// Process the four possible entity condition.</span>
<a name="l01210"></a>01210     <span class="comment">// The id field is always present in entity keys.</span>
<a name="l01211"></a>01211     $sql_field = $entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>];
<a name="l01212"></a>01212     $id_map[<span class="stringliteral">&#39;entity_id&#39;</span>] = $sql_field;
<a name="l01213"></a>01213     $select_query-&gt;addField($base_table, $sql_field, <span class="stringliteral">&#39;entity_id&#39;</span>);
<a name="l01214"></a>01214     <span class="keywordflow">if</span> (isset($this-&gt;entityConditions[<span class="stringliteral">&#39;entity_id&#39;</span>])) {
<a name="l01215"></a>01215       $this-&gt;<a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336" title="Adds a condition to an already built SelectQuery (internal function).">addCondition</a>($select_query, $base_table . <span class="charliteral">&#39;.&#39;</span> . $sql_field, $this-&gt;entityConditions[<span class="stringliteral">&#39;entity_id&#39;</span>]);
<a name="l01216"></a>01216     }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218     <span class="comment">// If there is a revision key defined, use it.</span>
<a name="l01219"></a>01219     <span class="keywordflow">if</span> (!empty($entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;revision&#39;</span>])) {
<a name="l01220"></a>01220       $sql_field = $entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;revision&#39;</span>];
<a name="l01221"></a>01221       $select_query-&gt;addField($base_table, $sql_field, <span class="stringliteral">&#39;revision_id&#39;</span>);
<a name="l01222"></a>01222       <span class="keywordflow">if</span> (isset($this-&gt;entityConditions[<span class="stringliteral">&#39;revision_id&#39;</span>])) {
<a name="l01223"></a>01223         $this-&gt;<a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336" title="Adds a condition to an already built SelectQuery (internal function).">addCondition</a>($select_query, $base_table . <span class="charliteral">&#39;.&#39;</span> . $sql_field, $this-&gt;entityConditions[<span class="stringliteral">&#39;revision_id&#39;</span>]);
<a name="l01224"></a>01224       }
<a name="l01225"></a>01225     }
<a name="l01226"></a>01226     <span class="keywordflow">else</span> {
<a name="l01227"></a>01227       $sql_field = <span class="stringliteral">&#39;revision_id&#39;</span>;
<a name="l01228"></a>01228       $select_query-&gt;addExpression(<span class="stringliteral">&#39;NULL&#39;</span>, <span class="stringliteral">&#39;revision_id&#39;</span>);
<a name="l01229"></a>01229     }
<a name="l01230"></a>01230     $id_map[<span class="stringliteral">&#39;revision_id&#39;</span>] = $sql_field;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232     <span class="comment">// Handle bundles.</span>
<a name="l01233"></a>01233     <span class="keywordflow">if</span> (!empty($entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;bundle&#39;</span>])) {
<a name="l01234"></a>01234       $sql_field = $entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;bundle&#39;</span>];
<a name="l01235"></a>01235       $having = FALSE;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237       <span class="keywordflow">if</span> (!empty($base_table_schema[<span class="stringliteral">&#39;fields&#39;</span>][$sql_field])) {
<a name="l01238"></a>01238         $select_query-&gt;addField($base_table, $sql_field, <span class="stringliteral">&#39;bundle&#39;</span>);
<a name="l01239"></a>01239       }
<a name="l01240"></a>01240     }
<a name="l01241"></a>01241     <span class="keywordflow">else</span> {
<a name="l01242"></a>01242       $sql_field = <span class="stringliteral">&#39;bundle&#39;</span>;
<a name="l01243"></a>01243       $select_query-&gt;addExpression(<span class="stringliteral">&#39;:bundle&#39;</span>, <span class="stringliteral">&#39;bundle&#39;</span>, array(<span class="stringliteral">&#39;:bundle&#39;</span> =&gt; $entity_type));
<a name="l01244"></a>01244       $having = TRUE;
<a name="l01245"></a>01245     }
<a name="l01246"></a>01246     $id_map[<span class="stringliteral">&#39;bundle&#39;</span>] = $sql_field;
<a name="l01247"></a>01247     <span class="keywordflow">if</span> (isset($this-&gt;entityConditions[<span class="stringliteral">&#39;bundle&#39;</span>])) {
<a name="l01248"></a>01248       <span class="keywordflow">if</span> (!empty($entity_info[<span class="stringliteral">&#39;entity keys&#39;</span>][<span class="stringliteral">&#39;bundle&#39;</span>])) {
<a name="l01249"></a>01249         $this-&gt;<a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336" title="Adds a condition to an already built SelectQuery (internal function).">addCondition</a>($select_query, $base_table . <span class="charliteral">&#39;.&#39;</span> . $sql_field, $this-&gt;entityConditions[<span class="stringliteral">&#39;bundle&#39;</span>], $having);
<a name="l01250"></a>01250       }
<a name="l01251"></a>01251       <span class="keywordflow">else</span> {
<a name="l01252"></a>01252         <span class="comment">// This entity has no bundle, so invalidate the query.</span>
<a name="l01253"></a>01253         $select_query-&gt;where(<span class="stringliteral">&#39;1 = 0&#39;</span>);
<a name="l01254"></a>01254       }
<a name="l01255"></a>01255     }
<a name="l01256"></a>01256 
<a name="l01257"></a>01257     <span class="comment">// Order the query.</span>
<a name="l01258"></a>01258     <span class="keywordflow">foreach</span> ($this-&gt;order as <a class="code" href="classEntityFieldQuery_ae94b590f6a8408cc7eb501b865feca3b.html#ae94b590f6a8408cc7eb501b865feca3b">$order</a>) {
<a name="l01259"></a>01259       <span class="keywordflow">if</span> ($order[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;entity&#39;</span>) {
<a name="l01260"></a>01260         $key = $order[<span class="stringliteral">&#39;specifier&#39;</span>];
<a name="l01261"></a>01261         <span class="keywordflow">if</span> (!isset($id_map[$key])) {
<a name="l01262"></a>01262           <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classEntityFieldQueryException.html" title="Exception thrown by EntityFieldQuery() on unsupported query syntax.">EntityFieldQueryException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Do not know how to order on @key for @entity_type&#39;</span>, array(<span class="stringliteral">&#39;@key&#39;</span> =&gt; $key, <span class="stringliteral">&#39;@entity_type&#39;</span> =&gt; $entity_type)));
<a name="l01263"></a>01263         }
<a name="l01264"></a>01264         $select_query-&gt;orderBy($id_map[$key], $order[<span class="stringliteral">&#39;direction&#39;</span>]);
<a name="l01265"></a>01265       }
<a name="l01266"></a>01266       elseif ($order[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;property&#39;</span>) {
<a name="l01267"></a>01267         $select_query-&gt;orderBy($base_table . <span class="charliteral">&#39;.&#39;</span> . $order[<span class="stringliteral">&#39;specifier&#39;</span>], $order[<span class="stringliteral">&#39;direction&#39;</span>]);
<a name="l01268"></a>01268       }
<a name="l01269"></a>01269     }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classEntityFieldQuery_a764b73a57d7b7186d219d859cbf87ddd.html#a764b73a57d7b7186d219d859cbf87ddd" title="Finishes the query.">finishQuery</a>($select_query);
<a name="l01272"></a>01272   }
<a name="l01273"></a>01273 
<a name="l01280"></a><a class="code" href="classEntityFieldQuery_a53c95c5a7f8a4a419aa85fa5d6529524.html#a53c95c5a7f8a4a419aa85fa5d6529524">01280</a>   <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a53c95c5a7f8a4a419aa85fa5d6529524.html#a53c95c5a7f8a4a419aa85fa5d6529524" title="Get the total number of results and initialize a pager for the query.">initializePager</a>() {
<a name="l01281"></a>01281     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a> &amp;&amp; !empty($this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>[<span class="stringliteral">&#39;limit&#39;</span>]) &amp;&amp; !$this-&gt;<a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a>) {
<a name="l01282"></a>01282       $page = <a class="code" href="pager_8inc_a7c4b7f1b30cc884b4823937ac86c71d5.html#a7c4b7f1b30cc884b4823937ac86c71d5" title="Returns the current page being requested for display within a pager.">pager_find_page</a>($this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>[<span class="stringliteral">&#39;element&#39;</span>]);
<a name="l01283"></a>01283       $count_query = clone $this;
<a name="l01284"></a>01284       $this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>[<span class="stringliteral">&#39;total&#39;</span>] = $count_query-&gt;count()-&gt;execute();
<a name="l01285"></a>01285       $this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>[<span class="stringliteral">&#39;start&#39;</span>] = $page * $this-&gt;<a class="code" href="classEntityFieldQuery_a31f0215e7fc7a6469e97bfd850430fb7.html#a31f0215e7fc7a6469e97bfd850430fb7" title="Enable a pager for the query.">pager</a>[<span class="stringliteral">&#39;limit&#39;</span>];
<a name="l01286"></a>01286       <a class="code" href="pager_8inc_a8e8fe141a61ed070df4145bee4ec5571.html#a8e8fe141a61ed070df4145bee4ec5571" title="Initializes a pager for theme(&#39;pager&#39;).">pager_default_initialize</a>($this-&gt;pager[<span class="stringliteral">&#39;total&#39;</span>], $this-&gt;pager[<span class="stringliteral">&#39;limit&#39;</span>], $this-&gt;pager[<span class="stringliteral">&#39;element&#39;</span>]);
<a name="l01287"></a>01287       $this-&gt;<a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a>($this-&gt;pager[<span class="stringliteral">&#39;start&#39;</span>], $this-&gt;pager[<span class="stringliteral">&#39;limit&#39;</span>]);
<a name="l01288"></a>01288     }
<a name="l01289"></a>01289   }
<a name="l01290"></a>01290 
<a name="l01305"></a><a class="code" href="classEntityFieldQuery_a764b73a57d7b7186d219d859cbf87ddd.html#a764b73a57d7b7186d219d859cbf87ddd">01305</a>   <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_a764b73a57d7b7186d219d859cbf87ddd.html#a764b73a57d7b7186d219d859cbf87ddd" title="Finishes the query.">finishQuery</a>($select_query, $id_key = <span class="stringliteral">&#39;entity_id&#39;</span>) {
<a name="l01306"></a>01306     <span class="keywordflow">foreach</span> ($this-&gt;tags as $tag) {
<a name="l01307"></a>01307       $select_query-&gt;addTag($tag);
<a name="l01308"></a>01308     }
<a name="l01309"></a>01309     <span class="keywordflow">foreach</span> ($this-&gt;metaData as $key =&gt; $object) {
<a name="l01310"></a>01310       $select_query-&gt;addMetaData($key, $object);
<a name="l01311"></a>01311     }
<a name="l01312"></a>01312     $select_query-&gt;addMetaData(<span class="stringliteral">&#39;entity_field_query&#39;</span>, $this);
<a name="l01313"></a>01313     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a>) {
<a name="l01314"></a>01314       $select_query-&gt;range($this-&gt;<a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a>[<span class="stringliteral">&#39;start&#39;</span>], $this-&gt;<a class="code" href="classEntityFieldQuery_abcea9c7dece049640ef9034f703bd9d7.html#abcea9c7dece049640ef9034f703bd9d7" title="Restricts a query to a given range in the result set.">range</a>[<span class="stringliteral">&#39;length&#39;</span>]);
<a name="l01315"></a>01315     }
<a name="l01316"></a>01316     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classEntityFieldQuery_afa3972b551da6115ad5749646df151d4.html#afa3972b551da6115ad5749646df151d4" title="Sets the query to be a count query only.">count</a>) {
<a name="l01317"></a>01317       <span class="keywordflow">return</span> $select_query-&gt;countQuery()-&gt;execute()-&gt;fetchField();
<a name="l01318"></a>01318     }
<a name="l01319"></a>01319     $return = array();
<a name="l01320"></a>01320     <span class="keywordflow">foreach</span> ($select_query-&gt;execute() as $partial_entity) {
<a name="l01321"></a>01321       $bundle = isset($partial_entity-&gt;bundle) ? $partial_entity-&gt;bundle : NULL;
<a name="l01322"></a>01322       $entity = <a class="code" href="common_8inc_af0b338fb292ad46545a3d35178a0155b.html#af0b338fb292ad46545a3d35178a0155b" title="Helper function to assemble an object structure with initial ids.">entity_create_stub_entity</a>($partial_entity-&gt;entity_type, array($partial_entity-&gt;entity_id, $partial_entity-&gt;revision_id, $bundle));
<a name="l01323"></a>01323       $return[$partial_entity-&gt;entity_type][$partial_entity-&gt;$id_key] = $entity;
<a name="l01324"></a>01324       $this-&gt;ordered_results[] = $partial_entity;
<a name="l01325"></a>01325     }
<a name="l01326"></a>01326     <span class="keywordflow">return</span> $return;
<a name="l01327"></a>01327   }
<a name="l01328"></a>01328 
<a name="l01345"></a><a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336">01345</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classEntityFieldQuery_ace9480802a8dbdf23f1d7091aaf7d336.html#ace9480802a8dbdf23f1d7091aaf7d336" title="Adds a condition to an already built SelectQuery (internal function).">addCondition</a>(<a class="code" href="classSelectQuery.html" title="Query builder for SELECT statements.">SelectQuery</a> $select_query, $sql_field, $condition, $having = FALSE) {
<a name="l01346"></a>01346     $method = $having ? <span class="stringliteral">&#39;havingCondition&#39;</span> : <span class="stringliteral">&#39;condition&#39;</span>;
<a name="l01347"></a>01347     $like_prefix = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01348"></a>01348     <span class="keywordflow">switch</span> ($condition[<span class="stringliteral">&#39;operator&#39;</span>]) {
<a name="l01349"></a>01349       <span class="keywordflow">case</span> <span class="stringliteral">&#39;CONTAINS&#39;</span>:
<a name="l01350"></a>01350         $like_prefix = <span class="charliteral">&#39;%&#39;</span>;
<a name="l01351"></a>01351       <span class="keywordflow">case</span> <span class="stringliteral">&#39;STARTS_WITH&#39;</span>:
<a name="l01352"></a>01352         $select_query-&gt;$method($sql_field, $like_prefix . <a class="code" href="group__database_ga4e86622a079f0992dbb987e66320be7a.html#ga4e86622a079f0992dbb987e66320be7a" title="Escapes characters that work as wildcard characters in a LIKE pattern.">db_like</a>($condition[<span class="stringliteral">&#39;value&#39;</span>]) . <span class="charliteral">&#39;%&#39;</span>, <span class="stringliteral">&#39;LIKE&#39;</span>);
<a name="l01353"></a>01353         <span class="keywordflow">break</span>;
<a name="l01354"></a>01354       <span class="keywordflow">default</span>:
<a name="l01355"></a>01355         $select_query-&gt;$method($sql_field, $condition[<span class="stringliteral">&#39;value&#39;</span>], $condition[<span class="stringliteral">&#39;operator&#39;</span>]);
<a name="l01356"></a>01356     }
<a name="l01357"></a>01357   }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359 }
<a name="l01360"></a>01360 
<a name="l01364"></a><a class="code" href="classEntityMalformedException.html">01364</a> <span class="keyword">class </span><a class="code" href="classEntityMalformedException.html" title="Exception thrown when a malformed entity is passed.">EntityMalformedException</a> <span class="keyword">extends</span> <a class="code" href="classException.html" title="to throw error if a module update fails.">Exception</a> { }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 22 2012 16:46:14 for Shopcart by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
