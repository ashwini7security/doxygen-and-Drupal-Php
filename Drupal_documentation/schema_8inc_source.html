<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Shopcart: includes/database/schema.inc Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Shopcart
   &#160;<span id="projectnumber">version2.0</span>
   </div>
   <div id="projectbrief">Shoppingcart</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_5b89693129504707d608c5412e7b88d4.html">includes</a>      </li>
      <li class="navelem"><a class="el" href="dir_ef0f8d4c5d0deb89b62e2aae86c9d2d2.html">database</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">schema.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="schema_8inc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00008"></a>00008 require_once dirname(__FILE__) . <span class="stringliteral">&#39;/query.inc&#39;</span>;
<a name="l00009"></a>00009 
<a name="l00164"></a><a class="code" href="classDatabaseSchema.html">00164</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="classDatabaseSchema.html">DatabaseSchema</a> <span class="keyword">implements</span> <a class="code" href="interfaceQueryPlaceholderInterface.html" title="Interface for a query that accepts placeholders.">QueryPlaceholderInterface</a> {
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="classDatabaseSchema_acd465dd5d817360083d0ff87971f692b.html#acd465dd5d817360083d0ff87971f692b">00166</a>   <span class="keyword">protected</span> <a class="code" href="classDatabaseSchema_acd465dd5d817360083d0ff87971f692b.html#acd465dd5d817360083d0ff87971f692b">$connection</a>;
<a name="l00167"></a>00167 
<a name="l00171"></a><a class="code" href="classDatabaseSchema_a113f21a5dcec8719b09a09d422a9dfc9.html#a113f21a5dcec8719b09a09d422a9dfc9">00171</a>   <span class="keyword">protected</span> <a class="code" href="classDatabaseSchema_a113f21a5dcec8719b09a09d422a9dfc9.html#a113f21a5dcec8719b09a09d422a9dfc9" title="The placeholder counter.">$placeholder</a> = 0;
<a name="l00172"></a>00172 
<a name="l00182"></a><a class="code" href="classDatabaseSchema_ad1b406aa6605327a3f5c910e0fd37816.html#ad1b406aa6605327a3f5c910e0fd37816">00182</a>   <span class="keyword">protected</span> <a class="code" href="classDatabaseSchema_ad1b406aa6605327a3f5c910e0fd37816.html#ad1b406aa6605327a3f5c910e0fd37816" title="Definition of prefixInfo array structure.">$defaultSchema</a> = <span class="stringliteral">&#39;public&#39;</span>;
<a name="l00183"></a>00183 
<a name="l00187"></a><a class="code" href="classDatabaseSchema_ab8e3b674c237c9f4590c38d6ebf8a3d1.html#ab8e3b674c237c9f4590c38d6ebf8a3d1">00187</a>   <span class="keyword">protected</span> <a class="code" href="classDatabaseSchema_ab8e3b674c237c9f4590c38d6ebf8a3d1.html#ab8e3b674c237c9f4590c38d6ebf8a3d1" title="A unique identifier for this query object.">$uniqueIdentifier</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="classDatabaseSchema_a8dbadc4c37f3232abea2d64667329223.html#a8dbadc4c37f3232abea2d64667329223">00189</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a8dbadc4c37f3232abea2d64667329223.html#a8dbadc4c37f3232abea2d64667329223">__construct</a>(<a class="code" href="classDatabaseSchema_acd465dd5d817360083d0ff87971f692b.html#acd465dd5d817360083d0ff87971f692b">$connection</a>) {
<a name="l00190"></a>00190     $this-&gt;<a class="code" href="classDatabaseSchema_a50324931213b40d68037c184a0061cf0.html#a50324931213b40d68037c184a0061cf0" title="Implements QueryPlaceHolderInterface::uniqueIdentifier().">uniqueIdentifier</a> = uniqid(<span class="stringliteral">&#39;&#39;</span>, TRUE);
<a name="l00191"></a>00191     $this-&gt;connection = <a class="code" href="classDatabaseSchema_acd465dd5d817360083d0ff87971f692b.html#acd465dd5d817360083d0ff87971f692b">$connection</a>;
<a name="l00192"></a>00192   }
<a name="l00193"></a>00193 
<a name="l00197"></a><a class="code" href="classDatabaseSchema_a31371e9f44ef54d75fce3746b83a5d76.html#a31371e9f44ef54d75fce3746b83a5d76">00197</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a31371e9f44ef54d75fce3746b83a5d76.html#a31371e9f44ef54d75fce3746b83a5d76" title="Implements the magic __clone function.">__clone</a>() {
<a name="l00198"></a>00198     $this-&gt;<a class="code" href="classDatabaseSchema_a50324931213b40d68037c184a0061cf0.html#a50324931213b40d68037c184a0061cf0" title="Implements QueryPlaceHolderInterface::uniqueIdentifier().">uniqueIdentifier</a> = uniqid(<span class="stringliteral">&#39;&#39;</span>, TRUE);
<a name="l00199"></a>00199   }
<a name="l00200"></a>00200 
<a name="l00204"></a><a class="code" href="classDatabaseSchema_a50324931213b40d68037c184a0061cf0.html#a50324931213b40d68037c184a0061cf0">00204</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a50324931213b40d68037c184a0061cf0.html#a50324931213b40d68037c184a0061cf0" title="Implements QueryPlaceHolderInterface::uniqueIdentifier().">uniqueIdentifier</a>() {
<a name="l00205"></a>00205     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classDatabaseSchema_a50324931213b40d68037c184a0061cf0.html#a50324931213b40d68037c184a0061cf0" title="Implements QueryPlaceHolderInterface::uniqueIdentifier().">uniqueIdentifier</a>;
<a name="l00206"></a>00206   }
<a name="l00207"></a>00207 
<a name="l00211"></a><a class="code" href="classDatabaseSchema_a25bdbd4eb743fcd4db4809451ad5e8c9.html#a25bdbd4eb743fcd4db4809451ad5e8c9">00211</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a25bdbd4eb743fcd4db4809451ad5e8c9.html#a25bdbd4eb743fcd4db4809451ad5e8c9" title="Implements QueryPlaceHolderInterface::nextPlaceholder().">nextPlaceholder</a>() {
<a name="l00212"></a>00212     <span class="keywordflow">return</span> $this-&gt;placeholder++;
<a name="l00213"></a>00213   }
<a name="l00214"></a>00214 
<a name="l00227"></a><a class="code" href="classDatabaseSchema_a8acae6a4bd3e5ba89aaddc8133927ee2.html#a8acae6a4bd3e5ba89aaddc8133927ee2">00227</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a8acae6a4bd3e5ba89aaddc8133927ee2.html#a8acae6a4bd3e5ba89aaddc8133927ee2" title="Get information about the table name and schema from the prefix.">getPrefixInfo</a>($table = <span class="stringliteral">&#39;default&#39;</span>, $add_prefix = TRUE) {
<a name="l00228"></a>00228     $info = array(
<a name="l00229"></a>00229       <span class="stringliteral">&#39;schema&#39;</span> =&gt; $this-&gt;defaultSchema,
<a name="l00230"></a>00230       <span class="stringliteral">&#39;prefix&#39;</span> =&gt; $this-&gt;connection-&gt;tablePrefix($table),
<a name="l00231"></a>00231     );
<a name="l00232"></a>00232     <span class="keywordflow">if</span> ($add_prefix) {
<a name="l00233"></a>00233       $table = $info[<span class="stringliteral">&#39;prefix&#39;</span>] . $table;
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235     <span class="comment">// If the prefix contains a period in it, then that means the prefix also</span>
<a name="l00236"></a>00236     <span class="comment">// contains a schema reference in which case we will change the schema key</span>
<a name="l00237"></a>00237     <span class="comment">// to the value before the period in the prefix. Everything after the dot</span>
<a name="l00238"></a>00238     <span class="comment">// will be prefixed onto the front of the table.</span>
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (($pos = strpos($table, <span class="charliteral">&#39;.&#39;</span>)) !== FALSE) {
<a name="l00240"></a>00240       <span class="comment">// Grab everything before the period.</span>
<a name="l00241"></a>00241       $info[<span class="stringliteral">&#39;schema&#39;</span>] = substr($table, 0, $pos);
<a name="l00242"></a>00242       <span class="comment">// Grab everything after the dot.</span>
<a name="l00243"></a>00243       $info[<span class="stringliteral">&#39;table&#39;</span>] = substr($table, ++$pos);
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245     <span class="keywordflow">else</span> {
<a name="l00246"></a>00246       $info[<span class="stringliteral">&#39;table&#39;</span>] = $table;
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248     <span class="keywordflow">return</span> $info;
<a name="l00249"></a>00249   }
<a name="l00250"></a>00250 
<a name="l00256"></a><a class="code" href="classDatabaseSchema_a6ed5776d1fdc2790123dd5e03571ba77.html#a6ed5776d1fdc2790123dd5e03571ba77">00256</a>   <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a6ed5776d1fdc2790123dd5e03571ba77.html#a6ed5776d1fdc2790123dd5e03571ba77" title="Create names for indexes, primary keys and constraints.">prefixNonTable</a>($table) {
<a name="l00257"></a>00257     $args = func_get_args();
<a name="l00258"></a>00258     $info = $this-&gt;<a class="code" href="classDatabaseSchema_a8acae6a4bd3e5ba89aaddc8133927ee2.html#a8acae6a4bd3e5ba89aaddc8133927ee2" title="Get information about the table name and schema from the prefix.">getPrefixInfo</a>($table);
<a name="l00259"></a>00259     $args[0] = $info[<span class="stringliteral">&#39;table&#39;</span>];
<a name="l00260"></a>00260     <span class="keywordflow">return</span> implode(<span class="charliteral">&#39;_&#39;</span>, $args);
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262 
<a name="l00288"></a><a class="code" href="classDatabaseSchema_a4a2510c6b95598b613355d1a9b9a706f.html#a4a2510c6b95598b613355d1a9b9a706f">00288</a>   <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a4a2510c6b95598b613355d1a9b9a706f.html#a4a2510c6b95598b613355d1a9b9a706f" title="Build a condition to match a table name against a standard information_schema.">buildTableNameCondition</a>($table_name, $operator = <span class="charliteral">&#39;=&#39;</span>, $add_prefix = TRUE) {
<a name="l00289"></a>00289     $info = $this-&gt;connection-&gt;getConnectionOptions();
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <span class="comment">// Retrive the table name and schema</span>
<a name="l00292"></a>00292     $table_info = $this-&gt;<a class="code" href="classDatabaseSchema_a8acae6a4bd3e5ba89aaddc8133927ee2.html#a8acae6a4bd3e5ba89aaddc8133927ee2" title="Get information about the table name and schema from the prefix.">getPrefixInfo</a>($table_name, $add_prefix);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     $condition = <span class="keyword">new</span> <a class="code" href="classDatabaseCondition.html" title="Generic class for a series of conditions in a query.">DatabaseCondition</a>(<span class="stringliteral">&#39;AND&#39;</span>);
<a name="l00295"></a>00295     $condition-&gt;condition(<span class="stringliteral">&#39;table_catalog&#39;</span>, $info[<span class="stringliteral">&#39;database&#39;</span>]);
<a name="l00296"></a>00296     $condition-&gt;condition(<span class="stringliteral">&#39;table_schema&#39;</span>, $table_info[<span class="stringliteral">&#39;schema&#39;</span>]);
<a name="l00297"></a>00297     $condition-&gt;condition(<span class="stringliteral">&#39;table_name&#39;</span>, $table_info[<span class="stringliteral">&#39;table&#39;</span>], $operator);
<a name="l00298"></a>00298     <span class="keywordflow">return</span> $condition;
<a name="l00299"></a>00299   }
<a name="l00300"></a>00300 
<a name="l00310"></a><a class="code" href="classDatabaseSchema_acf4650f58bed6fc76d94d49a72e5d706.html#acf4650f58bed6fc76d94d49a72e5d706">00310</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_acf4650f58bed6fc76d94d49a72e5d706.html#acf4650f58bed6fc76d94d49a72e5d706" title="Check if a table exists.">tableExists</a>($table) {
<a name="l00311"></a>00311     $condition = $this-&gt;<a class="code" href="classDatabaseSchema_a4a2510c6b95598b613355d1a9b9a706f.html#a4a2510c6b95598b613355d1a9b9a706f" title="Build a condition to match a table name against a standard information_schema.">buildTableNameCondition</a>($table);
<a name="l00312"></a>00312     $condition-&gt;compile($this-&gt;connection, $this);
<a name="l00313"></a>00313     <span class="comment">// Normally, we would heartily discourage the use of string</span>
<a name="l00314"></a>00314     <span class="comment">// concatenation for conditionals like this however, we</span>
<a name="l00315"></a>00315     <span class="comment">// couldn&#39;t use db_select() here because it would prefix</span>
<a name="l00316"></a>00316     <span class="comment">// information_schema.tables and the query would fail.</span>
<a name="l00317"></a>00317     <span class="comment">// Don&#39;t use {} around information_schema.tables table.</span>
<a name="l00318"></a>00318     <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>) $this-&gt;connection-&gt;query(<span class="stringliteral">&quot;SELECT 1 FROM information_schema.tables WHERE &quot;</span> . (<span class="keywordtype">string</span>) $condition, $condition-&gt;arguments())-&gt;fetchField();
<a name="l00319"></a>00319   }
<a name="l00320"></a>00320 
<a name="l00331"></a><a class="code" href="classDatabaseSchema_aecbf376fb9d85811278ee6448e99feca.html#aecbf376fb9d85811278ee6448e99feca">00331</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_aecbf376fb9d85811278ee6448e99feca.html#aecbf376fb9d85811278ee6448e99feca" title="Find all tables that are like the specified base table name.">findTables</a>($table_expression) {
<a name="l00332"></a>00332     $condition = $this-&gt;<a class="code" href="classDatabaseSchema_a4a2510c6b95598b613355d1a9b9a706f.html#a4a2510c6b95598b613355d1a9b9a706f" title="Build a condition to match a table name against a standard information_schema.">buildTableNameCondition</a>($table_expression, <span class="stringliteral">&#39;LIKE&#39;</span>, FALSE);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     $condition-&gt;compile($this-&gt;connection, $this);
<a name="l00335"></a>00335     <span class="comment">// Normally, we would heartily discourage the use of string</span>
<a name="l00336"></a>00336     <span class="comment">// concatenation for conditionals like this however, we</span>
<a name="l00337"></a>00337     <span class="comment">// couldn&#39;t use db_select() here because it would prefix</span>
<a name="l00338"></a>00338     <span class="comment">// information_schema.tables and the query would fail.</span>
<a name="l00339"></a>00339     <span class="comment">// Don&#39;t use {} around information_schema.tables table.</span>
<a name="l00340"></a>00340     <span class="keywordflow">return</span> $this-&gt;connection-&gt;query(<span class="stringliteral">&quot;SELECT table_name FROM information_schema.tables WHERE &quot;</span> . (<span class="keywordtype">string</span>) $condition, $condition-&gt;arguments())-&gt;fetchAllKeyed(0, 0);
<a name="l00341"></a>00341   }
<a name="l00342"></a>00342 
<a name="l00354"></a><a class="code" href="classDatabaseSchema_a1f657a73ea94b4fa0de1d1954350b4e7.html#a1f657a73ea94b4fa0de1d1954350b4e7">00354</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a1f657a73ea94b4fa0de1d1954350b4e7.html#a1f657a73ea94b4fa0de1d1954350b4e7" title="Check if a column exists in the given table.">fieldExists</a>($table, $column) {
<a name="l00355"></a>00355     $condition = $this-&gt;<a class="code" href="classDatabaseSchema_a4a2510c6b95598b613355d1a9b9a706f.html#a4a2510c6b95598b613355d1a9b9a706f" title="Build a condition to match a table name against a standard information_schema.">buildTableNameCondition</a>($table);
<a name="l00356"></a>00356     $condition-&gt;condition(<span class="stringliteral">&#39;column_name&#39;</span>, $column);
<a name="l00357"></a>00357     $condition-&gt;compile($this-&gt;connection, $this);
<a name="l00358"></a>00358     <span class="comment">// Normally, we would heartily discourage the use of string</span>
<a name="l00359"></a>00359     <span class="comment">// concatenation for conditionals like this however, we</span>
<a name="l00360"></a>00360     <span class="comment">// couldn&#39;t use db_select() here because it would prefix</span>
<a name="l00361"></a>00361     <span class="comment">// information_schema.tables and the query would fail.</span>
<a name="l00362"></a>00362     <span class="comment">// Don&#39;t use {} around information_schema.columns table.</span>
<a name="l00363"></a>00363     <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>) $this-&gt;connection-&gt;query(<span class="stringliteral">&quot;SELECT 1 FROM information_schema.columns WHERE &quot;</span> . (<span class="keywordtype">string</span>) $condition, $condition-&gt;arguments())-&gt;fetchField();
<a name="l00364"></a>00364   }
<a name="l00365"></a>00365 
<a name="l00376"></a>00376   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a82022c76c3131c4d745736d08321b788.html#a82022c76c3131c4d745736d08321b788" title="Returns a mapping of Drupal schema field names to DB-native field types.">getFieldTypeMap</a>();
<a name="l00377"></a>00377 
<a name="l00391"></a>00391   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_aaa0b6f32797505bdfc9ed953e10a486e.html#aaa0b6f32797505bdfc9ed953e10a486e" title="Rename a table.">renameTable</a>($table, $new_name);
<a name="l00392"></a>00392 
<a name="l00403"></a>00403   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a61a37e713374b88d28161e0ade1a5c78.html#a61a37e713374b88d28161e0ade1a5c78" title="Drop a table.">dropTable</a>($table);
<a name="l00404"></a>00404 
<a name="l00431"></a>00431   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a54800af6c4094cea196e1c66b5106c99.html#a54800af6c4094cea196e1c66b5106c99" title="Add a new field to a table.">addField</a>($table, $field, $spec, $keys_new = array());
<a name="l00432"></a>00432 
<a name="l00445"></a>00445   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a9eee3ae81e40bba206015a83450e1d56.html#a9eee3ae81e40bba206015a83450e1d56" title="Drop a field.">dropField</a>($table, $field);
<a name="l00446"></a>00446 
<a name="l00460"></a>00460   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a0e7b9c13344b59584bf6e1ddea009592.html#a0e7b9c13344b59584bf6e1ddea009592" title="Set the default value for a field.">fieldSetDefault</a>($table, $field, $default);
<a name="l00461"></a>00461 
<a name="l00473"></a>00473   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_ae4de35c98eed09a4c38d82e3f17ed8a6.html#ae4de35c98eed09a4c38d82e3f17ed8a6" title="Set a field to have no default value.">fieldSetNoDefault</a>($table, $field);
<a name="l00474"></a>00474 
<a name="l00486"></a>00486   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_ae343d2fd453d51d9df43d439af0a22e2.html#ae343d2fd453d51d9df43d439af0a22e2" title="Checks if an index exists in the given table.">indexExists</a>($table, $name);
<a name="l00487"></a>00487 
<a name="l00501"></a>00501   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_abe9490392e8408eb3847256aeb15bba0.html#abe9490392e8408eb3847256aeb15bba0" title="Add a primary key.">addPrimaryKey</a>($table, $fields);
<a name="l00502"></a>00502 
<a name="l00513"></a>00513   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a08057609758a32c13c4d1863da54b63e.html#a08057609758a32c13c4d1863da54b63e" title="Drop the primary key.">dropPrimaryKey</a>($table);
<a name="l00514"></a>00514 
<a name="l00530"></a>00530   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_ac2e6358da1c2d38fe6a1a1d003dac8ca.html#ac2e6358da1c2d38fe6a1a1d003dac8ca" title="Add a unique key.">addUniqueKey</a>($table, $name, $fields);
<a name="l00531"></a>00531 
<a name="l00544"></a>00544   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a40519a35f27d1bfe0f2eb0e759df1afd.html#a40519a35f27d1bfe0f2eb0e759df1afd" title="Drop a unique key.">dropUniqueKey</a>($table, $name);
<a name="l00545"></a>00545 
<a name="l00561"></a>00561   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a12f4b519abe55aaef3e4d736dbb27ab7.html#a12f4b519abe55aaef3e4d736dbb27ab7" title="Add an index.">addIndex</a>($table, $name, $fields);
<a name="l00562"></a>00562 
<a name="l00575"></a>00575   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_adf5467aa59e462857527d8f1a5988a81.html#adf5467aa59e462857527d8f1a5988a81" title="Drop an index.">dropIndex</a>($table, $name);
<a name="l00576"></a>00576 
<a name="l00642"></a>00642   <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_ab2470d34145fdbb413dd952baf7067be.html#ab2470d34145fdbb413dd952baf7067be" title="Change a field definition.">changeField</a>($table, $field, $field_new, $spec, $keys_new = array());
<a name="l00643"></a>00643 
<a name="l00655"></a><a class="code" href="classDatabaseSchema_a0117d8198d2da93013fe5bf823649fd6.html#a0117d8198d2da93013fe5bf823649fd6">00655</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a0117d8198d2da93013fe5bf823649fd6.html#a0117d8198d2da93013fe5bf823649fd6" title="Create a new table from a Drupal table definition.">createTable</a>($name, $table) {
<a name="l00656"></a>00656     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classDatabaseSchema_acf4650f58bed6fc76d94d49a72e5d706.html#acf4650f58bed6fc76d94d49a72e5d706" title="Check if a table exists.">tableExists</a>($name)) {
<a name="l00657"></a>00657       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classDatabaseSchemaObjectExistsException.html" title="Exception thrown if an object being created already exists.">DatabaseSchemaObjectExistsException</a>(<a class="code" href="bootstrap_8inc_a1be9937b04ff350b23d01fddef1e031a.html#a1be9937b04ff350b23d01fddef1e031a" title="Replaces placeholders with sanitized values in a string.">t</a>(<span class="stringliteral">&#39;Table %name already exists.&#39;</span>, array(<span class="stringliteral">&#39;%name&#39;</span> =&gt; $name)));
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659     $statements = $this-&gt;createTableSql($name, $table);
<a name="l00660"></a>00660     <span class="keywordflow">foreach</span> ($statements as $statement) {
<a name="l00661"></a>00661       $this-&gt;connection-&gt;query($statement);
<a name="l00662"></a>00662     }
<a name="l00663"></a>00663   }
<a name="l00664"></a>00664 
<a name="l00677"></a><a class="code" href="classDatabaseSchema_a7255734df8d5b7a1475f8cd0d8320e06.html#a7255734df8d5b7a1475f8cd0d8320e06">00677</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a7255734df8d5b7a1475f8cd0d8320e06.html#a7255734df8d5b7a1475f8cd0d8320e06" title="Return an array of field names from an array of key/index column specifiers.">fieldNames</a>($fields) {
<a name="l00678"></a>00678     $return = array();
<a name="l00679"></a>00679     <span class="keywordflow">foreach</span> ($fields as $field) {
<a name="l00680"></a>00680       <span class="keywordflow">if</span> (is_array($field)) {
<a name="l00681"></a>00681         $return[] = $field[0];
<a name="l00682"></a>00682       }
<a name="l00683"></a>00683       <span class="keywordflow">else</span> {
<a name="l00684"></a>00684         $return[] = $field;
<a name="l00685"></a>00685       }
<a name="l00686"></a>00686     }
<a name="l00687"></a>00687     <span class="keywordflow">return</span> $return;
<a name="l00688"></a>00688   }
<a name="l00689"></a>00689 
<a name="l00701"></a><a class="code" href="classDatabaseSchema_a45f043158682052792524ab48a188dc5.html#a45f043158682052792524ab48a188dc5">00701</a>   <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classDatabaseSchema_a45f043158682052792524ab48a188dc5.html#a45f043158682052792524ab48a188dc5" title="Prepare a table or column comment for database query.">prepareComment</a>($comment, $length = NULL) {
<a name="l00702"></a>00702     <span class="keywordflow">return</span> $this-&gt;connection-&gt;quote($comment);
<a name="l00703"></a>00703   }
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00713"></a><a class="code" href="classDatabaseSchemaObjectExistsException.html">00713</a> <span class="keyword">class </span><a class="code" href="classDatabaseSchemaObjectExistsException.html" title="Exception thrown if an object being created already exists.">DatabaseSchemaObjectExistsException</a> <span class="keyword">extends</span> <a class="code" href="classException.html" title="to throw error if a module update fails.">Exception</a> {}
<a name="l00714"></a>00714 
<a name="l00722"></a><a class="code" href="classDatabaseSchemaObjectDoesNotExistException.html">00722</a> <span class="keyword">class </span><a class="code" href="classDatabaseSchemaObjectDoesNotExistException.html" title="Exception thrown if an object being modified doesn&#39;t exist yet.">DatabaseSchemaObjectDoesNotExistException</a> <span class="keyword">extends</span> <a class="code" href="classException.html" title="to throw error if a module update fails.">Exception</a> {}
<a name="l00723"></a>00723 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 22 2012 16:46:14 for Shopcart by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
